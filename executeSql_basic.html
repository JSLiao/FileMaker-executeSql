<!DOCTYPE html><html lang='en'>  <head>    <meta charset='UTF-8' />    <meta aceVersion='v1.4.14' frameVersion='v1' />    <meta http-equiv='X-UA-Compatible' content='IE=edge' />    <meta name='viewport' content='width=device-width, initial-scale=1.0' />    <title>executeSql basic</title>    <style>:root {  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  font-size: 16px;  background-color: #111;  margin: 0;  padding: 0;  color: #eee;  hyphens: auto;--background_th: #333;}#main-subject {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  /* display:inline-block; */  position: fixed;  left: 6px;  top: 6px;  padding: 6px 3px;  align-content: flex-start;  text-decoration: none;  width: 97%;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 3px;}/* btn toEdit, tsToTc */#btn-toEdit, #btn-tsToTc {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 16px;  cursor:pointer;  align-content: flex-start;}/* btn toEdit */#btn-toEdit {  right: 6px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 32px;  position: fixed;}/* btn tsToTc */#btn-tsToTc {  right: 44px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 64px;  position: fixed;}#main-subject:hover,#btn-toEdit:hover,#btn-tsToTc:hover {  background-color: rgba(45, 45, 45, 0.9);  color: #c0edfe;}#main-subject:active,#btn-toEdit:active,#btn-tsToTc:active {  background-color: rgb(255, 145, 45);  color: #c0edfe;}.subNote {  right:20px;  text-align: right;  font-size: 0.9rem;  color: lightGray;}content {  color: lightgray;}p {  color: #ddd;  font-size: 1rem;  height: auto;  padding: 0rem;  margin-block-start: 0.5rem;  margin-block-end: 0.5rem;}hr {  color: #666;  height: 0.5px;}a {  border: none;  color: #ff5;  height: 100%;  text-decoration: none;}a:hover {  color: #fa3;}a:hover:after {  left: auto;  right: 0;  width: 100%;}a:active {  top: 2px;}/* table 样式 */table {  border-top: 1px solid #ccc;  border-left: 1px solid #ccc;}table td,table th {  border-bottom: 1px solid #ccc;  border-right: 1px solid #ccc;  padding: 3px 5px;}table th { background-color: var(--background_th) !important;  border-bottom: 2px solid #ccc;  text-align: center;}/* blockquote 样式 */blockquote {  display: block;  border-left: 5px solid #d0e5f2;  padding: 3px 5px;  margin: 6px 0;  line-height: 1.4;  font-size: 100%;  background-color: #f1f1f1;}/* code 样式 */code {  display: inline-block;  *display: inline;  *zoom: 1;  color: lightgray;  background-color: #fff3;  border-radius: 1px;  padding: 1px 3px;  margin: 0 1px;  font-size: 0.9rem;  font-family: monaco 'robot mono' mono !important;}pre code {  display: block;}/* ul ol 样式 */ul,ol {  margin-left: 8px;  padding-left:4px;  padding-right: 0;}li{  margin-left:0;  padding-left:0px;}ul li{  list-style-type: disc;}ol lit{  list-style-type: decimal;}.sectionTitle {  font-size: 1.2rem;}.preCodecontianer {  background-color: #fff1;}.cssDefault {  font-size: 0.9rem;  color: gray;  margin-left: 1rem;}footer {  text-align: right;  padding: 1px 12px;  margin:1px;  background-color: #8882;  color: lightgray;  bottom:8px;  right:24px;  position:fixed;  z-index: 1;}h1{  font-size:24px;}h2{  font-size:22px;}h3{  font-size:20px;}h4{  font-size:18px;}h5{  font-size:16px;}font[size='1']{  font-size:12px;  padding: 0.1em;  margin: 0.1em;}font[size='2']{  font-size:14px;  padding: 0.1em;  margin: 0.1em;}font[size='3']{  font-size:16px;  padding: 0.1em;  margin: 0.1em;}font[size='4']{  font-size:18px;  padding: 0.1em;  margin: 0.1em;}font[size='5']{  font-size:20px;  padding: 0.1em;  margin: 0.1em;}font[size='6']{  font-size:22px;  padding: 0.1em;  margin: 0.1em;}font[size='7']{  font-size:24px;  padding: 0.2em;}blockquote, blockquote p{  background:#0003 !important;}blockquote, blockquote p{  background:transparent !important;}/* width */::-webkit-scrollbar {width: 12px;}/* Track */::-webkit-scrollbar-track {background: #333;}/* Handle */::-webkit-scrollbar-thumb {background: #345;}/* Handle on hover */::-webkit-scrollbar-thumb:hover {background: #357;}</style>    <style>:root {  margin: 0;  padding: 0;  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  --background: #111;  --color: #ddd;  --font-size: 16px;  --background_th: #555;  --color-a: #ff5;  --color-a-hover: #fa3;  --background-blockquote: #00e9;  --font-size-code: 14px;  --background-code: #fff3;  background-color: var(--background);  color: var(--color);  font-size: var(--font-size);}.notesView{  background-color: #0308;  margin:0;  padding:8px 2px 8px 16px;}.codeView{  background-color: #0038;  margin:0;  padding:8px 2px 8px 16px;}.resultView{  background-color: #3008;  margin:0;  padding:8px 2px 8px 16px;}.code, .result{  font-family: monaco, monospace;  font-size:13px;  color:var(--color);}</style>  </head>  <body>    <!--完整檢視才顯示, begin-->    <div class='notesView'>      <p id='main-subject'>executeSql basic</p>      <br><br><div class='content'><p><span style="color: var(--color); background-color: var(--background);">SELECT 敘述可以包含多個子句</span><br/></p><p><font color="#46acc8">SELECT [ DISTINCT ] { * | column_expression [[AS] column_alias],...} <br/>FROM table_name [ table_alias ], …<br/>[ JOIN clause]<br/>[ WHERE expr1 rel_operator expr2 ]<br/>[ GROUP BY { column_expression, ...} ]<br/>[ HAVING expr1 rel_operator expr2 ]<br/>[ UNION [ ALL ] ( SELECT...) ]<br/>[ ORDER BY { sort_expression [ DESC | ASC ] }, ... ]<br/>[ OFFSET n { ROWS | ROW} ]<br/>[ FETCH FIRST [ n [ PERCENT ] ] { ROWS | ROW } { ONLY | WITH TIES } ]<br/>[ FOR UPDATE [ OF {column_expression, ...}] ]<br/>方括號內的敘述可以選擇性輸入</font></p><p>sql 查詢語句必要的兩部分構成，第一部分是要 "拿什麼" 資料 (若有多項用逗號隔開)；第二部分則為 "從哪拿"。</p><pre><code>SELECT table_column1, table_column2, table_column3...
FROM table_name;
</code></pre><p><font color="#4d80bf">sqlQuery: sql 查詢語句, 只支援 select 查詢</font></p><ul><li>避免表名稱和欄位名稱和 sql 保留字衝突, 衝突發生雖可處理, 但應避免</li><li>欄位別名(使用 As 指定)用來語義化欄位或者用較短名稱來標示欄位<br/></li><li>executeSql 查詢是獨立於上下文(context), 可以查詢非目前表或關聯表的資料<br/></li><li>返回的數據是純文字, 可以透過文字相關函數進行處理</li><li>語句的內容不區分大小寫</li><li>值區分大小寫</li><li>查詢語句可以用多個子句組合</li><li>white space 為分隔符號, 連續的 &nbsp;white space 效果如一個 white space</li><li>table name 必須是在 table 的 relation graph 中有出現的 base table name</li><li>field name&nbsp;必須是純欄位名稱(不包含 table name)或者 tableName.fieldName</li><li>任何錯誤的 field name, table name 或語法錯誤, 會返回 "?"</li><li>可以一次查詢多個欄位, 欄位間以 "," 隔開</li><li>字串常數如果放在語句中, 用單引號括起來</li><li>可以查詢引入的外部資料庫的表</li><li>要獲得數據可能有好幾種計算式寫法, 從幾種計算式測試哪一個表較合適</li><li><span style="color: var(--color); background-color: var(--background);">雖然&nbsp;executeSql可以在語句內使用備註, 建議備註使用在語句外</span></li><li>通常越複雜的計算式表示計算越耗時, 精簡的計算式, 通常是有利的寫法</li><li>取得的數據越大表示越長的計算時間, 選擇只取得的必要數據, 是有利的寫法</li><li><span style="color: var(--color); background-color: var(--background);">在寫 executeSql 計算式要注意: 拼字, 標點符號, 語句的順序</span></li></ul><p><font color="#4d80bf">fieldSeparator: 欄位分隔符號或稱為 column separator&nbsp;</font><br/></p><ul><li>可以是任何文字</li><li>如果輸入"" 則使用內定值 ","</li></ul><p><font color="#4d80bf">rowSeparator: 記錄分隔符號, 區隔獲取的資料的不同紀錄</font><br/></p><ul><li>可以是任何文字</li><li>如果輸入"" 則使用內定值 "¶" 即 return, char(13)</li></ul><p><font color="#4d80bf">arguments: 引數</font></p><ul><li>用於 where 子句的鍵值</li><li>argument 的內含區分大小寫</li><li>如果有多個條件, argument 用 "," 分開</li><li>sqlQuery 的 where 子句中的 "?” 依序對應於 arguments</li><li>where 子句依序取用 arguments, 多餘的 argument 被忽略</li></ul><hr/><p><span style="color: var(--color); background-color: var(--background);">executeSql 的應用</span><br/></p><ul><li>獨立於上下文關係的運算, 非關係資料表的取值</li><li>減少關聯資料表</li><li>減少欄位數</li><li>產生格式化的計算結果</li><li>配合 script 可以輸出成客製化的文字檔案</li><li>配合在 one record table 的欄位, 可以達成在 script 就完成 value List</li><li>取得非檔案內的資料表的資料( 需要安裝必要的 Plugin )</li></ul><hr/><p><span style="color: var(--color); background-color: var(--background);">executeSql 的應用時機</span><br/></p><p>executeSql 的計算不是即時的, 是需要被觸發的</p><ul><li>不要應用到定義計算欄位的計算式, 除非 Store Options 設定為 "Do not store calculated results - -recalculate when needed"</li><li>不要應用到欄位定義的 Auto Enter 的 calculated Value,&nbsp;定義, 除非&nbsp;設定為 "Do not replace existing value of field ( if any)”<br/></li><li>不要應用到佈局的 conditional formatting 和 hide object when<br/></li><li>在 script&nbsp;&nbsp;中的計算式</li><li>或者 script trigger 中的計算式</li><li>產生常數儲存到 global field 或 global variable</li></ul><hr/><p><span style="color: var(--color); background-color: var(--background);">executeSql 的技巧</span><br/></p><ul><li>如果計算式太長, 可按照語句分開</li><li><span style="color: var(--color); background-color: var(--background); font-size: var(--font-size);">利用 let 函數, 產生模組化, 彈性的計算式內容</span></li><li>備註( 寫在 executeSql 計算式外面, 雖然語句內也可以寫備註)&nbsp;</li><li>使用程式碼編輯器, 如 visual studio code, TextMate, BBEdit, Sublime Text,…</li><li>修改計算式前, 先備份</li><li>substitute ( getFieldName( field ) ; “::” ; “.” ) 轉成 tableName.fieldName&nbsp;</li></ul><hr/><p><span style="color: rgb(194, 79, 74); background-color: var(--background);">參考資料</span><br/></p><p>FileMaker executeSql 不完全支援 sql, 可參考相關資料, 及測試是否可用於 FileMaker<font color="#c24f4a"><br/></font></p><p><a target="_blank" href="https://help.claris.com/en/sql-reference.pdf">ClarisFileMaker,&nbsp;SQL Reference</a><br/></p><p><a target="_blank" href="https://help.claris.com/en/sql-reference.pdf"></a><a target="_blank" href="https://help.claris.com/zh/sql-reference.pdf">ClarisFileMaker,&nbsp;SQL&nbsp;参考</a></p><p><a target="_blank" href="https://www.1keydata.com/tw/sql/sql.html">SQL語法教學</a></p><p><a target="_blank" href="https://www.fooish.com/sql/">Foolish sql 語法</a></p><br/></div>    </div>    <div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>executeSql ( "SELECT SQRT(3.14)FROM OneRecord /* 使用備註 */" ; "" ; "" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>1.772004514666935</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>// argument 的內含區分大小寫// 以下的查詢結果不包含 nameEng ="peter" 或 "pEter"...// where 子句依序取用 arguments, 多餘的 argument 被忽略executeSql ( "SELECT name, nameEng FROM contact Where nameEng = 'Peter' Fetch First 10 Rows Only" ; "" ; ""; "Peter")/* 這個寫法和上面的寫法是相同的executeSql ( "SELECT name, nameEng FROM contact Where nameEng = ?" ; "" ; ""; "Peter" )*//* 你可能預期以下寫法也可以獲得結果, 實際上他會發生錯誤executeSql ( "SELECT name, nameEng FROM contact Where nameEng = \"Peter\"" ; "" ; "" )*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>杜利,Peter宋倫嵇,Peter呂祜慮,Peter范冠訓,Peter施簡次,Peter袁西,Peter張務誡,Peter曹虢逼,Peter郭足發,Peter康索,Peter</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>// 語句的內容不區分大小寫// fieldSeparator 如果輸入"" 則使用內定值 ","// rowSeparator 如果輸入"" 則使用內定值 “¶” 即 return, char(13)// sqlQuery 的 where 子句中的 "?” 依序對應於 argumentsexecuteSql ( "SELECT name, addrCity, addrstr FROM company Where addrCity = ? And name Like ?" ; "" ; ""; "新北市" ; "__國際%" )/*字串常數如果直截放在敘述中要用單引號括起來executeSql ( "SELECT name, addrCity, addrstr FROM company Where addrCity = ? And name Like '__國際%'" ; "" ; ""; "新北市" ; "" )*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>嘯飛國際實業股份有限公司,新北市,石門區嘉祿街80號2樓抽莊國際實業股份有限公司台灣分公司,新北市,三峽區佳福路223號10樓正顛國際股份有限公司,新北市,瑞芳區大埔路有勝新村218號5樓友子國際股份有限公司,新北市,新莊區福前街131號1樓真石國際興業有限公司,新北市,石碇區磨石坑100號3樓佐祀國際興業股份有限公司,新北市,土城區三民路138號5樓詳火國際企業股份有限公司,新北市,三重區新興路147號3樓寶機國際興業股份有限公司,新北市,永和區保順路206號11樓城箱國際實業股份有限公司台灣分公司,新北市,坪林區粗石斛158號11樓移凌國際實業股份有限公司台灣分公司,新北市,新店區大榮路121號10樓弁罔國際實業股份有限公司,新北市,新莊區壽山路93號3樓外吉國際股份有限公司,新北市,平溪區三坑120號8樓雁洛國際實業股份有限公司,新北市,三峽區有木191號11樓</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/* 查詢可以拆成數個文字段落,加以模組化, 再組合成一個完整的敘述段落間前後都加上 white space, 是一個安全的分隔, 連續的 white space 會被省略當資料中有 "," 或 ¶ 會和預設的區隔符號混淆, 可以罕見的字元當作區隔符號, 以分辨 field (column) 和 record (row)*/let (  [    // 參數, begin    ~fields = "name, nameEng" ;    ~table = "contact" ;    ~arg = "David" ;    ~key = "nameEng" ;    ~cs = char(41444) ;    ~rs = char(41445) & ¶ ;    //  參數, end    ~query = "Select " & ~fields & " From " & ~table & " Where " & ~key & " =? Fetch First 10 Rows Only"  ];  executeSql ( ~query ; "" ; "" ; ~arg ))</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>方足策,David古洛去,David巫業摩,David邵陛惠,David卓誅,David紀家,David范姜束絲,David姚驚轉,David范冬,David孫彼,David</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>// rec500 是引入的外部資料庫executeSql("SELECT * FROM rec500 FETCH First 10 rows only" ; "" ; "" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>James,Butt,Benton, John B Jr,6649 N Blue Gum St,New Orleans,Orleans,LA,70116,504-621-8927,504-845-1427,jbutt@gmail.com,http://www.bentonjohnbjr.com,,,637183551876981344874984019813646441736169450293826183808314430135732317,,,2,1Josephine,Darakjy,Chanay, Jeffrey A Esq,4 B Blue Ridge Blvd,Brighton,Livingston,MI,48116,810-292-9388,810-374-9840,josephine_darakjy@darakjy.org,http://www.chanayjeffreyaesq.com,,,637183551876981118603626866387159146785175380318705463193363025467774097,,,3,2Art,Venere,Chemel, James L Cpa,8 W Cerritos Ave #54,Bridgeport,Gloucester,NJ,08014,856-636-8749,856-264-4130,art@venere.org,http://www.chemeljameslcpa.com,,,637183551876981595163639320613547133054517606883484727541047534945501485,,,4,3Lenna,Paprocki,Feltz Printing Service,639 Main St,Anchorage,Anchorage,AK,99501,907-385-4412,907-921-2010,lpaprocki@hotmail.com,http://www.feltzprintingservice.com,,,637183551876981432778627412875800494135445430013995019506094685166527794,,,5,4Donette,Foller,Printing Dimensions,34 Center St,Hamilton,Butler,OH,45011,513-570-1893,513-549-4561,donette.foller@cox.net,http://www.printingdimensions.com,,,637183551876991428129968061498948094285568734785312710171844950614594519,,,6,5Simona,Morasca,Chapman, Ross E Esq,3 Mcauley Dr,Ashland,Ashland,OH,44805,419-503-2484,419-800-6759,simona@morasca.com,http://www.chapmanrosseesq.com,,,637183551876991471176183939213975712051297231497628642105278039434647832,,,7,6Mitsue,Tollner,Morlong Associates,7 Eads St,Chicago,Cook,IL,60632,773-573-6914,773-924-8565,mitsue_tollner@yahoo.com,http://www.morlongassociates.com,,,637183551876991142586223603343809600673521521236626333741981888974987796,,,8,7Leota,Dilliard,Commercial Press,7 W Jackson Blvd,San Jose,Santa Clara,CA,95111,408-752-3500,408-813-1105,leota@hotmail.com,http://www.commercialpress.com,,,637183551876991056674859648126308661795904725088047475183532123176518998,,,9,8Sage,Wieser,Truhlar And Truhlar Attys,5 Boston Ave #88,Sioux Falls,Minnehaha,SD,57105,605-414-2147,605-794-4895,sage_wieser@cox.net,http://www.truhlarandtruhlarattys.com,,,637183551876991480063442612643441346527163351830339044624235739876728138,,,10,9Kris,Marrier,King, Christopher A Esq,228 Runamuck Pl #2808,Baltimore,Baltimore City,MD,21224,410-655-8723,410-804-4694,kris@gmail.com,http://www.kingchristopheraesq.com,,,637183551876991445434466818804264216274676291997422883512544993910341527,,,11,10</pre></div>    <footer><p>update: 2022/06/03 17:17:57 by: Jeff</p><a class='repo' href='https://github.com/JSLiao/FileMaker-executeSql' target='_blank'>repository</a></footer>    <script></script>  </body></html>