<!DOCTYPE html><html lang='en'>  <head>    <meta charset='UTF-8' />    <meta aceVersion='v1.4.14' frameVersion='v1' />    <meta http-equiv='X-UA-Compatible' content='IE=edge' />    <meta name='viewport' content='width=device-width, initial-scale=1.0' />    <title>Offset 和 Fetch First</title>    <style>:root {  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  font-size: 16px;  background-color: #111;  margin: 0;  padding: 0;  color: #eee;  hyphens: auto;--background_th: #333;}#main-subject {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  /* display:inline-block; */  position: fixed;  left: 6px;  top: 6px;  padding: 6px 3px;  align-content: flex-start;  text-decoration: none;  width: 97%;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 3px;}/* btn toEdit, tsToTc */#btn-toEdit, #btn-tsToTc {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 16px;  cursor:pointer;  align-content: flex-start;}/* btn toEdit */#btn-toEdit {  right: 6px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 32px;  position: fixed;}/* btn tsToTc */#btn-tsToTc {  right: 44px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 64px;  position: fixed;}#main-subject:hover,#btn-toEdit:hover,#btn-tsToTc:hover {  background-color: rgba(45, 45, 45, 0.9);  color: #c0edfe;}#main-subject:active,#btn-toEdit:active,#btn-tsToTc:active {  background-color: rgb(255, 145, 45);  color: #c0edfe;}.subNote {  right:20px;  text-align: right;  font-size: 0.9rem;  color: lightGray;}content {  color: lightgray;}p {  color: #ddd;  font-size: 1rem;  height: auto;  padding: 0rem;  margin-block-start: 0.5rem;  margin-block-end: 0.5rem;}hr {  color: #666;  height: 0.5px;}a {  border: none;  color: #ff5;  height: 100%;  text-decoration: none;}a:hover {  color: #fa3;}a:hover:after {  left: auto;  right: 0;  width: 100%;}a:active {  top: 2px;}/* table 样式 */table {  border-top: 1px solid #ccc;  border-left: 1px solid #ccc;}table td,table th {  border-bottom: 1px solid #ccc;  border-right: 1px solid #ccc;  padding: 3px 5px;}table th { background-color: var(--background_th) !important;  border-bottom: 2px solid #ccc;  text-align: center;}/* blockquote 样式 */blockquote {  display: block;  border-left: 5px solid #d0e5f2;  padding: 3px 5px;  margin: 6px 0;  line-height: 1.4;  font-size: 100%;  background-color: #f1f1f1;}/* code 样式 */code {  display: inline-block;  *display: inline;  *zoom: 1;  color: lightgray;  background-color: #fff3;  border-radius: 1px;  padding: 1px 3px;  margin: 0 1px;  font-size: 0.9rem;  font-family: monaco 'robot mono' mono !important;}pre code {  display: block;}/* ul ol 样式 */ul,ol {  margin-left: 8px;  padding-left:4px;  padding-right: 0;}li{  margin-left:0;  padding-left:0px;}ul li{  list-style-type: disc;}ol lit{  list-style-type: decimal;}.sectionTitle {  font-size: 1.2rem;}.preCodecontianer {  background-color: #fff1;}.cssDefault {  font-size: 0.9rem;  color: gray;  margin-left: 1rem;}footer {  text-align: right;  padding: 1px 12px;  margin:1px;  background-color: #8882;  color: lightgray;  bottom:8px;  right:24px;  position:fixed;  z-index: 1;}h1{  font-size:24px;}h2{  font-size:22px;}h3{  font-size:20px;}h4{  font-size:18px;}h5{  font-size:16px;}font[size='1']{  font-size:12px;  padding: 0.1em;  margin: 0.1em;}font[size='2']{  font-size:14px;  padding: 0.1em;  margin: 0.1em;}font[size='3']{  font-size:16px;  padding: 0.1em;  margin: 0.1em;}font[size='4']{  font-size:18px;  padding: 0.1em;  margin: 0.1em;}font[size='5']{  font-size:20px;  padding: 0.1em;  margin: 0.1em;}font[size='6']{  font-size:22px;  padding: 0.1em;  margin: 0.1em;}font[size='7']{  font-size:24px;  padding: 0.2em;}blockquote, blockquote p{  background:#0003 !important;}blockquote, blockquote p{  background:transparent !important;}/* width */::-webkit-scrollbar {width: 12px;}/* Track */::-webkit-scrollbar-track {background: #333;}/* Handle */::-webkit-scrollbar-thumb {background: #345;}/* Handle on hover */::-webkit-scrollbar-thumb:hover {background: #357;}</style>    <style>:root {  margin: 0;  padding: 0;  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  --background: #111;  --color: #ddd;  --font-size: 16px;  --background_th: #555;  --color-a: #ff5;  --color-a-hover: #fa3;  --background-blockquote: #00e9;  --font-size-code: 14px;  --background-code: #fff3;  background-color: var(--background);  color: var(--color);  font-size: var(--font-size);}.notesView{  background-color: #0308;  margin:0;  padding:8px 2px 8px 16px;}.codeView{  background-color: #0038;  margin:0;  padding:8px 2px 8px 16px;}.resultView{  background-color: #3008;  margin:0;  padding:8px 2px 8px 16px;}.code, .result{  font-family: monaco, monospace;  font-size:13px;  color:var(--color);}</style>  </head>  <body>    <!--完整檢視才顯示, begin-->    <div class='notesView'>      <p id='main-subject'>Offset 和 Fetch First</p>      <br><br><div class='content'><p><font color="#4d80bf">Offset&nbsp;</font></p><p><span style="color: var(--color); background-color: var(--background);"><code>Offset n { Rows | Row }</code></span></p><p><span style="color: var(--color); background-color: var(--background);">用來指定要跳過的紀錄筆數</span><br/></p><p>Fetch First 和 Offset 可以搭配使用</p><p>如果同時使用 Offset 和 Fetch First, Offset 子句必須在前面</p><p><font color="#4d80bf">Fetch First&nbsp;</font></p><p>用來取得指定筆數的紀錄</p><p>可以用數字表示紀錄筆數或者用百分比表示<span style="color: var(--color); background-color: var(--background); font-size: var(--font-size);">。</span><span style="color: var(--color); background-color: var(--background); font-size: var(--font-size);">&nbsp;</span></p><p><span style="color: var(--color); background-color: var(--background);">含小數的值會無條件進位到下一個整數值。</span></p><p><code>Fetch n { Rows | Row } { Only | With Ties }</code></p><p>或</p><p><code>Fetch n Percent { Rows | Row } { Only | With Ties }</code><br/></p><p>With Ties</p><p>必須搭配&nbsp;<strong>Order By</strong>&nbsp;子句</p><p>可以這樣了解 With Ties</p><ol><li>傳回指定筆數</li><li>檢查指定筆數最後一筆符合 Order By 的條件</li><li>再加上, 符合 2 狀況的列</li></ol><p>With Ties可的傳回值的列數相等或大於指定的列數&nbsp;</p></div>    </div>    <div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*取最前面 10 筆記錄*/executeSql("SELECT name,nameEng,addrCity,birthday FROM contact WHERE addrCity = ? FETCH FIRST 10 ROWS ONLY"; "" ; "" ; "新竹市")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>張恥密,Lynn,新竹市,1988-12-30李邈忘,Elijah,新竹市,1987-03-13石夕曠,Edwiin,新竹市,1993-11-30施翳糧,Ronald,新竹市,1995-03-15杜位讀,Sebastiane,新竹市,1996-03-07劉納高,Salome,新竹市,1999-05-08張捕雲,Sheila,新竹市,1990-06-23呂更稿,Sebastian,新竹市,1988-01-31蕭閒宅,York,新竹市,1992-11-16阮善因,Mandy,新竹市,1986-01-08</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*取最前面 1 % 筆記錄*/executeSql("SELECT name,nameEng,addrCity,birthday FROM contact WHERE addrCity = ? FETCH FIRST 1 Percent Rows ONLY"; "" ; "" ; "新竹市")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>張恥密,Lynn,新竹市,1988-12-30李邈忘,Elijah,新竹市,1987-03-13石夕曠,Edwiin,新竹市,1993-11-30施翳糧,Ronald,新竹市,1995-03-15杜位讀,Sebastiane,新竹市,1996-03-07劉納高,Salome,新竹市,1999-05-08張捕雲,Sheila,新竹市,1990-06-23呂更稿,Sebastian,新竹市,1988-01-31蕭閒宅,York,新竹市,1992-11-16阮善因,Mandy,新竹市,1986-01-08歐陽投垣,Pandora,新竹市,1986-03-12呂廟省,Roderick,新竹市,1985-09-26蘇乎母,Oswald,新竹市,1986-04-02胡家伊,Hale,新竹市,1993-11-12</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*取得指定條件的紀錄筆數*/executeSql ( "Select Count(rowId) From contact Where addrCity = ? "; "" ; "" ; "新竹市") & ¶ &/*跳過取最前面 1370 筆記錄, 取隨後的 10 筆記錄*/executeSql("Select name,nameEng,addrCity,birthday From contact Where addrCity = ? Offset 1370 Rows Fetch First 10 Rows Only"; "" ; "" ; "新竹市")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>1375龔思,Kitty,新竹市,1985-11-01龔飄暑,Violet,新竹市,1997-05-29龔毛,Olivia,新竹市,1985-07-05龔地水,Kama,新竹市,1990-05-31龔節,Veromca,新竹市,1999-06-19</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*取得指定條件的紀錄筆數*/executeSql ( "Select Count(rowId) From contact Where addrCity = ? "; "" ; "" ; "新竹市") & ¶ &/*跳過取最前面 1300 筆記錄, 取隨後的 1% 筆記錄( 14 筆記錄)*/executeSql("Select name,nameEng,addrCity,birthday From contact Where addrCity = ? Offset 1300 Rows Fetch First 1 Percent Rows Only"; "" ; "" ; "新竹市")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>1375顏恭,Gordon,新竹市,1989-03-02魏歸引,Ellen,新竹市,1985-10-16魏晝巨,Jack,新竹市,1989-06-21藍慮熱,Mona,新竹市,1989-03-01魏二陰,Osmond,新竹市,1997-12-12藍習岫,Violet,新竹市,1995-07-31羅南,Wythe,新竹市,1999-02-07羅執辰,Frances,新竹市,1996-09-01羅絜夕,Len,新竹市,1993-06-04羅敢,Barbara,新竹市,1999-03-31羅俗,Don,新竹市,1986-10-29羅戚垂,Leila,新竹市,1986-07-09羅譽惟,Paul,新竹市,1998-10-22羅縣方,Gavin,新竹市,1996-09-07</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>let (  [    ~offset = executeSql ("Select Count(rowId) From company" ; "" ; "") - 10 ;    ~fetchFirst = 10  ];  executeSql ( "    Select Upper ( webAddr )     From company     Order By webAddr    Offset " & ~offset & "Rows    Fetch First " & ~fetchFirst & "Rows Only    "; ""; ""))/*Fetch First 和 Offset 指定的 Row 數不可以用函數指定不可以用 arrgument 指定, 如果需要用計算的 row 數字, 要放到字串裡面這個計算式會發生錯誤let (  [    ~offset = executeSql ("Select Count(rowId) From company" ; "" ; "") - 10 ;    ~fetchFirst = 10  ];  executeSql ( "    Select Upper ( webAddr )     From company     Order By webAddr    Offset ? Rows    Fetch First ? Rows Only    "; ""; ""; ~offset; ~fetchFirst))*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>HTTP://WWW.ZVYLO.COM.TW/HTTP://WWW.ZWDE.COM/HTTP://WWW.ZWPTPL.COM/HTTP://WWW.ZWTP.COM.TW/HTTP://WWW.ZXJQI.COM.TW/HTTP://WWW.ZXXUS.COM.TW/HTTP://WWW.ZYBH.COM.TW/HTTP://WWW.ZYIL.COM.TW/HTTP://WWW.ZYNVF.COM/HTTP://WWW.ZZCI.COM/</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*Fetch First 10 Rows With Ties因為加了 With Ties 使顯示的資料筆數超過 10 筆, 因為使用了 with Ties, 會因為 Order By 的欄位, 欄位的順序而取得不同的值只要符合 age &gt; 35, Order By 筆畫數, 和前 10 筆的最後一筆相同筆畫數的都會被列出這個範例中, 筆畫數 = 7, 都被列出*/executeSql("  Select name, nameEng, addrCity, age, stroke   From contact   Where addrCity = '新竹市' And age &gt; 35  Order By stroke   Offset 10 Rows  Fetch First 10 Rows With Ties";"" ;"" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>余身寓,Crystal,新竹市,36,7吳虧,Fitzgerald,新竹市,37,7吳縻,Sandra,新竹市,36,7呂紛母,Eli,新竹市,36,7何閒英,Ives,新竹市,36,7杜宴鈞,Tab,新竹市,36,7余餐體,Lena,新竹市,36,7呂觴拱,Grace,新竹市,36,7吳寸方,Clarence,新竹市,36,7余武城,Harold,新竹市,37,7杜莫慕,Vivien,新竹市,36,7阮琴大,Justin,新竹市,37,7余熱鞠,Marshall,新竹市,36,7吳鑒,Lena,新竹市,37,7余新,Hogan,新竹市,36,7巫建弊,Allen,新竹市,36,7杜贊機,Bertram,新竹市,36,7吳犢映,Faithe,新竹市,36,7</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*Fetch First 10 Rows With Ties因為加了 With Ties 使顯示的資料筆數超過 10 筆, 因為使用了 with Ties, 會因為 Order By 的欄位, 欄位的順序而取得不同的值只要符合 age &gt; 35, Order By 筆畫數, 和前 10 筆的最後一筆相同筆畫數的都會被列出這個範例中, 女, 筆畫數 = 9, 都被列出*/executeSql("  Select name, nameEng, addrCity, age, stroke,gender  From contact   Where addrCity = '新竹市' And age &gt; 35  Order By gender, stroke  Offset 10 Rows  Fetch First 10 Rows With Ties";"" ;"" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>范姜悲,Anna,新竹市,36,9,女施指聲,Molly,新竹市,36,9,女紀律昆,Trista,新竹市,37,9,女洪願,Selena,新竹市,36,9,女姜驅師,Verna,新竹市,37,9,女柯璇,Vivien,新竹市,36,9,女姜姜丙,Rosalind,新竹市,37,9,女施天,Salome,新竹市,36,9,女紀榮聞,Madeline,新竹市,36,9,女洪往策,Geraldine,新竹市,37,9,女</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*Fetch First 10 Rows With Ties因為加了 With Ties 使顯示的資料筆數超過 10 筆, 因為使用了 with Ties, 會因為 Order By 的欄位, 欄位的順序而取得不同的值只要符合 age &gt; 35, Order By 筆畫數, 和前 10 筆的最後一筆相同筆畫數的都會被列出這個範例中, 筆畫數 = 7, 男 都被列出*/executeSql("  Select name, nameEng, addrCity, age, stroke,gender  From contact   Where addrCity = '新竹市' And age &gt; 35  Order By stroke, gender  Offset 10 Rows  Fetch First 10 Rows With Ties";"" ;"" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>吳縻,Sandra,新竹市,36,7,女余餐體,Lena,新竹市,36,7,女呂觴拱,Grace,新竹市,36,7,女杜莫慕,Vivien,新竹市,36,7,女吳鑒,Lena,新竹市,37,7,女吳犢映,Faithe,新竹市,36,7,女呂廟省,Roderick,新竹市,37,7,男吳虧,Fitzgerald,新竹市,37,7,男呂紛母,Eli,新竹市,36,7,男何閒英,Ives,新竹市,36,7,男杜宴鈞,Tab,新竹市,36,7,男吳寸方,Clarence,新竹市,36,7,男余武城,Harold,新竹市,37,7,男阮琴大,Justin,新竹市,37,7,男余熱鞠,Marshall,新竹市,36,7,男余新,Hogan,新竹市,36,7,男巫建弊,Allen,新竹市,36,7,男杜贊機,Bertram,新竹市,36,7,男</pre></div>    <footer><p>update: 2022/06/07 20:06:10 by: Jeff</p><a class='repo' href='https://github.com/JSLiao/FileMaker-executeSql' target='_blank'>repository</a></footer>    <script></script>  </body></html>