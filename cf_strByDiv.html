<!DOCTYPE html><html lang='en'>  <head>    <meta charset='UTF-8' />    <meta aceVersion='v1.4.14' frameVersion='v1' />    <meta http-equiv='X-UA-Compatible' content='IE=edge' />    <meta name='viewport' content='width=device-width, initial-scale=1.0' />    <title>cf_strByDiv</title>    <style>:root {  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  font-size: 16px;  background-color: #111;  margin: 0;  padding: 0;  color: #eee;  hyphens: auto;--background_th: #333;}#main-subject {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  /* display:inline-block; */  position: fixed;  left: 6px;  top: 6px;  padding: 6px 3px;  align-content: flex-start;  text-decoration: none;  width: 97%;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 3px;}/* btn toEdit, tsToTc */#btn-toEdit, #btn-tsToTc {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 16px;  cursor:pointer;  align-content: flex-start;}/* btn toEdit */#btn-toEdit {  right: 6px;  top: 6px;  padding: 6px 3px;  text-align: center; /* æ–‡å­—å±…ä¸­ */  width: 32px;  position: fixed;}/* btn tsToTc */#btn-tsToTc {  right: 44px;  top: 6px;  padding: 6px 3px;  text-align: center; /* æ–‡å­—å±…ä¸­ */  width: 64px;  position: fixed;}#main-subject:hover,#btn-toEdit:hover,#btn-tsToTc:hover {  background-color: rgba(45, 45, 45, 0.9);  color: #c0edfe;}#main-subject:active,#btn-toEdit:active,#btn-tsToTc:active {  background-color: rgb(255, 145, 45);  color: #c0edfe;}.subNote {  right:20px;  text-align: right;  font-size: 0.9rem;  color: lightGray;}content {  color: lightgray;}p {  color: #ddd;  font-size: 1rem;  height: auto;  padding: 0rem;  margin-block-start: 0.5rem;  margin-block-end: 0.5rem;}hr {  color: #666;  height: 0.5px;}a {  border: none;  color: #ff5;  height: 100%;  text-decoration: none;}a:hover {  color: #fa3;}a:hover:after {  left: auto;  right: 0;  width: 100%;}a:active {  top: 2px;}/* table æ ·å¼ */table {  border-top: 1px solid #ccc;  border-left: 1px solid #ccc;}table td,table th {  border-bottom: 1px solid #ccc;  border-right: 1px solid #ccc;  padding: 3px 5px;}table th { background-color: var(--background_th) !important;  border-bottom: 2px solid #ccc;  text-align: center;}/* blockquote æ ·å¼ */blockquote {  display: block;  border-left: 5px solid #d0e5f2;  padding: 3px 5px;  margin: 6px 0;  line-height: 1.4;  font-size: 100%;  background-color: #f1f1f1;}/* code æ ·å¼ */code {  display: inline-block;  *display: inline;  *zoom: 1;  color: lightgray;  background-color: #fff3;  border-radius: 1px;  padding: 1px 3px;  margin: 0 1px;  font-size: 0.9rem;  font-family: monaco 'robot mono' mono !important;}pre code {  display: block;}/* ul ol æ ·å¼ */ul,ol {  margin-left: 8px;  padding-left:4px;  padding-right: 0;}li{  margin-left:0;  padding-left:0px;}ul li{  list-style-type: disc;}ol lit{  list-style-type: decimal;}.sectionTitle {  font-size: 1.2rem;}.preCodecontianer {  background-color: #fff1;}.cssDefault {  font-size: 0.9rem;  color: gray;  margin-left: 1rem;}footer {  text-align: right;  padding: 1px 12px;  margin:1px;  background-color: #8882;  color: lightgray;  bottom:8px;  right:24px;  position:fixed;  z-index: 1;}h1{  font-size:24px;}h2{  font-size:22px;}h3{  font-size:20px;}h4{  font-size:18px;}h5{  font-size:16px;}font[size='1']{  font-size:12px;  padding: 0.1em;  margin: 0.1em;}font[size='2']{  font-size:14px;  padding: 0.1em;  margin: 0.1em;}font[size='3']{  font-size:16px;  padding: 0.1em;  margin: 0.1em;}font[size='4']{  font-size:18px;  padding: 0.1em;  margin: 0.1em;}font[size='5']{  font-size:20px;  padding: 0.1em;  margin: 0.1em;}font[size='6']{  font-size:22px;  padding: 0.1em;  margin: 0.1em;}font[size='7']{  font-size:24px;  padding: 0.2em;}blockquote, blockquote p{  background:#0003 !important;}blockquote, blockquote p{  background:transparent !important;}/* width */::-webkit-scrollbar {width: 12px;}/* Track */::-webkit-scrollbar-track {background: #333;}/* Handle */::-webkit-scrollbar-thumb {background: #345;}/* Handle on hover */::-webkit-scrollbar-thumb:hover {background: #357;}</style>    <style>:root {  margin: 0;  padding: 0;  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  --background: #111;  --color: #ddd;  --font-size: 16px;  --background_th: #555;  --color-a: #ff5;  --color-a-hover: #fa3;  --background-blockquote: #00e9;  --font-size-code: 14px;  --background-code: #fff3;  background-color: var(--background);  color: var(--color);  font-size: var(--font-size);}.notesView{  background-color: #0308;  margin:0;  padding:8px 2px 8px 16px;}.codeView{  background-color: #0038;  margin:0;  padding:8px 2px 8px 16px;}.resultView{  background-color: #3008;  margin:0;  padding:8px 2px 8px 16px;}.code, .result{  font-family: monaco, monospace;  font-size:13px;  color:var(--color);}</style>  </head>  <body>    <!--å®Œæ•´æª¢è¦–æ‰é¡¯ç¤º, begin-->    <div class='notesView'>      <p id='main-subject'>cf_strByDiv</p>      <br><br><div class='content'><p>executeSql ä¸æœƒå°ç‰¹æ®Šå­—å…ƒåš escape è™•ç†</p><p>ç•¶æ¬„ä½çš„å…§å®¹ä¸­åŒ…å« Â¶ æˆ– , å¦‚æœä½¿ç”¨å…§å®šçš„ column separator, row separator å‰‡æœƒé€ æˆå–å€¼éŒ¯èª¤</p><p>è™•ç†æ–¹å¼, ç”¨ç‰¹æ®Šå­—å…ƒåšç‚º<span style="color: var(--color); background-color: var(--background); font-size: var(--font-size);">&nbsp;column separator, row separator&nbsp;</span></p><p>cf_strByDiv ä¾æ“š&nbsp;column separator, row separator åšå–å€¼, å–å¾—æ­£ç¢ºçš„å€¼</p><p>cf_strByDiv ( _text; _div; _ifDivCase; _nth )</p><hr/><p>version 2 updated</p><p>format:</p><p>&nbsp; &nbsp; cf_strByDiv ( _text; _div; _ifDivCase; _nth; _ifNoDivReturn )</p><p>&nbsp; parameters:</p><p>&nbsp; &nbsp; _text: ç”¨ä¾†å–å€¼çš„æ–‡å­—</p><p>&nbsp; &nbsp; _div: åˆ†éš”å­—å…ƒæˆ–å­—ä¸²</p><p>&nbsp; &nbsp; _ifDivCase: _div æ˜¯å¦å€åˆ†å¤§å°å¯«</p><p>&nbsp; &nbsp; _nth: ç¬¬å¹¾å€‹</p><p>&nbsp; &nbsp; _ifNoDivReturn: true: å¦‚æœæœªç™¼ç¾ _div æ˜¯è¿”å›å®Œæ•´å­—ä¸²æˆ–, false: è¿”å›""</p></div>    </div>    <div class='codeView'><p class='codeViewTitle'>è¨ˆç®—å¼:</p><pre class='code'>/*  purpose:    å–è™•ä»¥ _div ä½œåˆ†éš”çš„ç¬¬ nth å€‹å­—ä¸²  format:    cf_strByDiv ( _text; _div; _ifDivCase; _nth )  parameters:    _text: ç”¨ä¾†å–å€¼çš„æ–‡å­—    _div: åˆ†éš”å­—å…ƒæˆ–å­—ä¸²    _ifDivCase: _div æ˜¯å¦å€åˆ†å¤§å°å¯«    _nth: ç¬¬å¹¾å€‹  dependencies:    no  returns:    æ–‡å­— æˆ–è€… ""    å¦‚æœæ²’æœ‰åˆ†éš”å­—å…ƒ, å‰‡ return empty  recursive:    no  notes:    å¾ cf_valueByDelimeter ä¿®è¨‚è€Œä¾†  version current: v1  by jeff liao  initial:    20220212  history:    */case (  _text = "" ; "" ;  _div = "" ; "" ;  filter ( _nth ; "0123456789") = _nth and not _nth &gt; 0 ; "" ;  let (    [      ~cS = "Â«" & char(41166) & "Â»" ;      ~ifC = if ( _ifDivCase = true ; 1 ; 0 );      ~txt = if ( ~ifC ; substitute ( _text ; _div ; ~cS ); _text );      ~div = if ( ~ifC ; ~cs ; _div );      ~lenDiv = length ( ~div );      ~ifLeadDiv = if ( left ( ~txt ; ~lenDiv ) = ~div ; 1 ; 0 );      ~ifTailDiv = if ( right ( ~txt ; ~lenDiv ) = ~div ; 1 ; 0 );      ~max = patternCount ( ~txt ; ~div ) + 1 ;      ~max = if ( ~ifLeadDiv ; ~max - 1 ; ~max );      ~max = if ( ~ifTailDiv ; ~max - 1 ; ~max )    ];    case (       patternCount ( ~txt ; ~div ) = 0 ; "" ;       _nth &gt; ~max ; "" ;      let (         [          ~txt = if ( ~ifLeadDiv ; ~txt ; ~div & ~txt );          ~txt = if ( ~ifTailDiv ; ~txt ; ~txt & ~div );          ~startPos = position ( ~txt ; ~div ; 1 ; _nth ) + ~lenDiv ;          ~endPos = position ( ~txt ; ~div ; ~startPos ; 1 );          ~len = ~endPos - ~startPos        ];        middle ( ~txt ; ~startPos ; ~len )      )    )  ))</pre></div><div class='resultView'><p class='resultViewTitle'>è¨ˆç®—çµæœ:</p><pre class='result'></pre></div><div class='codeView'><p class='codeViewTitle'>è¨ˆç®—å¼:</p><pre class='code'>/*å–å¾—ç¬¬ 5 ç­†è¨˜éŒ„çš„ column 1 å’Œ column 4*/let (   [    ~cS = "ğŸ¦€" ;    ~rS = "ğŸ³" ;    ~str = executeSql ("      Select name, nameEng, birthday, addrCity || addrStr      From contact      Where addrCity = 'å˜‰ç¾©ç¸£'      Fetch First 20 Rows Only      "; ~cS; ~rS ) ;    ~sn = 5  ];  // cf_strByDiv ( _text; _div; _ifDivCase; _nth )  let ( ~row = cf_strByDiv ( ~str; ~rS; 0 ; ~sn );    cf_strByDiv ( ~row; ~cS; 0 ; 1 ) & "  " & cf_strByDiv ( ~row; ~cS; 0 ; 4 )  ))</pre></div><div class='resultView'><p class='resultViewTitle'>è¨ˆç®—çµæœ:</p><pre class='result'>æ½˜è¦‹  å˜‰ç¾©ç¸£æ±çŸ³é„‰æºªå­ä¸‹229è™Ÿ9æ¨“</pre></div><div class='codeView'><p class='codeViewTitle'>è¨ˆç®—å¼:</p><pre class='code'>/*  purpose:    å–è™•ä»¥ _div ä½œåˆ†éš”çš„ç¬¬ nth å€‹å­—ä¸²  format:    cf_strByDiv ( _text; _div; _ifDivCase; _nth; _ifNoDivReturn )  parameters:    _text: ç”¨ä¾†å–å€¼çš„æ–‡å­—    _div: åˆ†éš”å­—å…ƒæˆ–å­—ä¸²    _ifDivCase: _div æ˜¯å¦å€åˆ†å¤§å°å¯«    _nth: ç¬¬å¹¾å€‹    _ifNoDivReturn: true: å¦‚æœæœªç™¼ç¾ _div æ˜¯è¿”å›å®Œæ•´å­—ä¸²æˆ–, false: è¿”å›""  dependencies:    no  returns:    æ–‡å­— æˆ–è€… ""    å¦‚æœæ²’æœ‰åˆ†éš”å­—å…ƒ, å‰‡ return empty  recursive:    no  notes:    å¾ cf_valueByDelimeter ä¿®è¨‚è€Œä¾†  version current: v2  by jeff liao  initial: 20220212  history:    v2 20220618: å¦‚æœæœªç™¼ç¾ _div æ˜¯è¿”å›å®Œæ•´å­—ä¸²æˆ–, ""    */case (  _text = "" ; "" ;  _div = "" ; "" ;  filter ( _nth ; "0123456789") = _nth and not _nth &gt; 0 ; "" ;  let (    [      ~cS = "Â«" & char(41166) & "Â»" ;      ~ifC = if ( _ifDivCase = true ; 1 ; 0 );      ~txt = if ( ~ifC ; substitute ( _text ; _div ; ~cS ); _text );      ~div = if ( ~ifC ; ~cs ; _div );      ~lenDiv = length ( ~div );      ~ifLeadDiv = if ( left ( ~txt ; ~lenDiv ) = ~div ; 1 ; 0 );      ~ifTailDiv = if ( right ( ~txt ; ~lenDiv ) = ~div ; 1 ; 0 );      ~max = patternCount ( ~txt ; ~div ) + 1 ;      ~max = if ( ~ifLeadDiv ; ~max - 1 ; ~max );      ~max = if ( ~ifTailDiv ; ~max - 1 ; ~max )    ];    case (       patternCount ( ~txt ; ~div ) = 0 ;         if ( _ifNoDivReturn = 1 ; _text ; "" ) ;       _nth &gt; ~max ; "" ;      let (         [          ~txt = if ( ~ifLeadDiv ; ~txt ; ~div & ~txt );          ~txt = if ( ~ifTailDiv ; ~txt ; ~txt & ~div );          ~startPos = position ( ~txt ; ~div ; 1 ; _nth ) + ~lenDiv ;          ~endPos = position ( ~txt ; ~div ; ~startPos ; 1 );          ~len = ~endPos - ~startPos        ];        middle ( ~txt ; ~startPos ; ~len )      )    )  ))</pre></div><div class='resultView'><p class='resultViewTitle'>è¨ˆç®—çµæœ:</p><pre class='result'></pre></div>    <footer><p>update: 2022/06/26 18:02:32 by: Jeff</p><a class='repo' href='https://github.com/JSLiao/FileMaker-executeSql' target='_blank'>repository</a></footer>    <script></script>  </body></html>