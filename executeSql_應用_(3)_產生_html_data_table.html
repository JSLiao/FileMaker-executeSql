<!DOCTYPE html><html lang='en'>  <head>    <meta charset='UTF-8' />    <meta aceVersion='v1.4.14' frameVersion='v1' />    <meta http-equiv='X-UA-Compatible' content='IE=edge' />    <meta name='viewport' content='width=device-width, initial-scale=1.0' />    <title>executeSql 應用 (3) 產生 html data table</title>    <style>:root {  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  font-size: 16px;  background-color: #111;  margin: 0;  padding: 0;  color: #eee;  hyphens: auto;--background_th: #333;}#main-subject {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  /* display:inline-block; */  position: fixed;  left: 6px;  top: 6px;  padding: 6px 3px;  align-content: flex-start;  text-decoration: none;  width: 97%;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 3px;}/* btn toEdit, tsToTc */#btn-toEdit, #btn-tsToTc {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 16px;  cursor:pointer;  align-content: flex-start;}/* btn toEdit */#btn-toEdit {  right: 6px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 32px;  position: fixed;}/* btn tsToTc */#btn-tsToTc {  right: 44px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 64px;  position: fixed;}#main-subject:hover,#btn-toEdit:hover,#btn-tsToTc:hover {  background-color: rgba(45, 45, 45, 0.9);  color: #c0edfe;}#main-subject:active,#btn-toEdit:active,#btn-tsToTc:active {  background-color: rgb(255, 145, 45);  color: #c0edfe;}.subNote {  right:20px;  text-align: right;  font-size: 0.9rem;  color: lightGray;}content {  color: lightgray;}p {  color: #ddd;  font-size: 1rem;  height: auto;  padding: 0rem;  margin-block-start: 0.5rem;  margin-block-end: 0.5rem;}hr {  color: #666;  height: 0.5px;}a {  border: none;  color: #ff5;  height: 100%;  text-decoration: none;}a:hover {  color: #fa3;}a:hover:after {  left: auto;  right: 0;  width: 100%;}a:active {  top: 2px;}/* table 样式 */table {  border-top: 1px solid #ccc;  border-left: 1px solid #ccc;}table td,table th {  border-bottom: 1px solid #ccc;  border-right: 1px solid #ccc;  padding: 3px 5px;}table th { background-color: var(--background_th) !important;  border-bottom: 2px solid #ccc;  text-align: center;}/* blockquote 样式 */blockquote {  display: block;  border-left: 5px solid #d0e5f2;  padding: 3px 5px;  margin: 6px 0;  line-height: 1.4;  font-size: 100%;  background-color: #f1f1f1;}/* code 样式 */code {  display: inline-block;  *display: inline;  *zoom: 1;  color: lightgray;  background-color: #fff3;  border-radius: 1px;  padding: 1px 3px;  margin: 0 1px;  font-size: 0.9rem;  font-family: monaco 'robot mono' mono !important;}pre code {  display: block;}/* ul ol 样式 */ul,ol {  margin-left: 8px;  padding-left:4px;  padding-right: 0;}li{  margin-left:0;  padding-left:0px;}ul li{  list-style-type: disc;}ol lit{  list-style-type: decimal;}.sectionTitle {  font-size: 1.2rem;}.preCodecontianer {  background-color: #fff1;}.cssDefault {  font-size: 0.9rem;  color: gray;  margin-left: 1rem;}footer {  text-align: right;  padding: 1px 12px;  margin:1px;  background-color: #8882;  color: lightgray;  bottom:8px;  right:24px;  position:fixed;  z-index: 1;}h1{  font-size:24px;}h2{  font-size:22px;}h3{  font-size:20px;}h4{  font-size:18px;}h5{  font-size:16px;}font[size='1']{  font-size:12px;  padding: 0.1em;  margin: 0.1em;}font[size='2']{  font-size:14px;  padding: 0.1em;  margin: 0.1em;}font[size='3']{  font-size:16px;  padding: 0.1em;  margin: 0.1em;}font[size='4']{  font-size:18px;  padding: 0.1em;  margin: 0.1em;}font[size='5']{  font-size:20px;  padding: 0.1em;  margin: 0.1em;}font[size='6']{  font-size:22px;  padding: 0.1em;  margin: 0.1em;}font[size='7']{  font-size:24px;  padding: 0.2em;}blockquote, blockquote p{  background:#0003 !important;}blockquote, blockquote p{  background:transparent !important;}/* width */::-webkit-scrollbar {width: 12px;}/* Track */::-webkit-scrollbar-track {background: #333;}/* Handle */::-webkit-scrollbar-thumb {background: #345;}/* Handle on hover */::-webkit-scrollbar-thumb:hover {background: #357;}</style>    <style>:root {  margin: 0;  padding: 0;  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  --background: #111;  --color: #ddd;  --font-size: 16px;  --background_th: #555;  --color-a: #ff5;  --color-a-hover: #fa3;  --background-blockquote: #00e9;  --font-size-code: 14px;  --background-code: #fff3;  background-color: var(--background);  color: var(--color);  font-size: var(--font-size);}.notesView{  background-color: #0308;  margin:0;  padding:8px 2px 8px 16px;}.codeView{  background-color: #0038;  margin:0;  padding:8px 2px 8px 16px;}.resultView{  background-color: #3008;  margin:0;  padding:8px 2px 8px 16px;}.code, .result{  font-family: monaco, monospace;  font-size:13px;  color:var(--color);}</style>  </head>  <body>    <!--完整檢視才顯示, begin-->    <div class='notesView'>      <p id='main-subject'>executeSql 應用 (3) 產生 html data table</p>      <br><br><div class='content'><p>/*<br/>  purpose: <br/>    &nbsp;&nbsp;&nbsp;&nbsp;輸出 data table 的 html<br/>  dependencies: <br/>    &nbsp;&nbsp;&nbsp;&nbsp;be_filemakerSql, 需安裝 BaseElement Plugin<br/>    &nbsp;&nbsp;&nbsp;&nbsp;libs.fmp12 存放 css, javascript 的 lib<br/>    &nbsp;&nbsp;&nbsp;&nbsp;cf_strByDiv ( _text; _div; _ifDivCase; _nth; _ifNoDivReturn )<br/>  returns: <br/>    &nbsp;&nbsp;&nbsp;&nbsp;html<br/>  recursive: <br/>    &nbsp;&nbsp;&nbsp;&nbsp;no<br/>  notes: <br/>    &nbsp;&nbsp;&nbsp;&nbsp;libs.fmp12 檔案需打開<br/>    &nbsp;&nbsp;&nbsp;&nbsp;jstable 程式資料庫來源: <a href="https://www.cssscript.com/interactive-data-table/" target="_blank">https://www.cssscript.com/interactive-data-table/</a></p><p>&nbsp;current version: v1<br/>  by jeff liao<br/>  initial: 20220625<br/>  history: <br/>*/<br/></p></div>    </div>    <div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>Let (   [     ~rs = Char(41649);    ~cols = list("jsTableFrame_html"; "jsTable_css"; "jsTable_js"; "jsTable_initialJS");    ~cols = "'" & Substitute ( ~cols ; ¶ ; "','") & "'" ;    ~libs = BE_FileMakerSQL("      Select libs.content      From libs      Where libs.name In(" & ~cols & ")      ";"" ;~rs ; "libs.fmp12");    ~frame = cf_strByDiv ( ~libs; ~rs; 1; 1; 1);    ~css = cf_strByDiv ( ~libs; ~rs; 1; 2; 1 );    ~js = cf_strByDiv ( ~libs; ~rs; 1; 3; 1 );    ~initialJs = cf_strByDiv ( ~libs; ~rs; 1; 4; 1 );    ~tableOpen = "&lt;table id='JSTable'&gt;";    ~tableClose = "&lt;/table&gt;";    ~th = "&lt;thead&gt;&lt;tr&gt;&lt;th&gt;姓名&lt;/th&gt;&lt;th&gt;公司&lt;/th&gt;&lt;th&gt;住址&lt;/th&gt;&lt;th&gt;電話&lt;/th&gt;&lt;th&gt;手機&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;";    ~colSep = "&lt;/td&gt;&lt;td&gt;" ;    ~rowSwp = "&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;" ;    ~lead = "&lt;tr&gt;&lt;td&gt;" ;    ~trail = "&lt;/td&gt;&lt;/tr&gt;";    // 以下是計算    ~tableContent = ExecuteSQL("      Select contact.name ||'('|| contact.nameEng ||')', company.name,         contact.addrCity || contact.addrStr , contact.telAreaCode ||'-'|| contact.telNo , contact.telMobile      From contact      Join company on company.id = contact.idf      Where contact.addrCity = '新北市'      Fetch First 50 Rows Only      "; ~colSep; ~rowSwp );    ~tableContent = Substitute ( ~tableContent ; "()" ; "" ); // 刪除無英文名字    ~tableContent = ~tableOpen & ~th & ~lead & ~tableContent & ~trail & ~tableClose  ];  Substitute( ~frame ;   [ "&lt;!--place ~css here--&gt;" ; "&lt;style&gt;" & ~css & "&lt;/style&gt;"];  [ "&lt;!--place ~tableContent here--&gt;" ; ~tableContent ];  [ "&lt;!--place ~js here--&gt;"; "&lt;script&gt;" & ~js & "&lt;/script&gt;"];   [ "&lt;!--place ~initialJs here--&gt;"; "&lt;script&gt;" & ~initialJs & "&lt;/script&gt;"]))</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'><!DOCTYPE html><html lang='en'><head><meta charset='UTF-8'><meta http-equiv='X-UA-Compatible' content='IE=edge'><meta name='viewport' content='width=device-width, initial-scale=1.0'><meta platform = 'FileMaker web viewer'><title>executeSql to html content</title><style>/*! * JSTable */.dt-container{position:relative;display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch;-ms-overflow-style:-ms-autohiding-scrollbar;overflow-y:hidden}.dt-container .dt-message{text-align:center}.dt-container .dt-loading{position:absolute;top:50%;left:50%;width:100%;margin-left:-50%;margin-top:-20px;height:40px;text-align:center;background-color:white;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background:-webkit-gradient(linear, left top, right top, color-stop(0, rgba(255,255,255,0)), color-stop(25%, rgba(255,255,255,0.9)), color-stop(75%, rgba(255,255,255,0.9)), to(rgba(255,255,255,0)));background:linear-gradient(to right, rgba(255,255,255,0) 0, rgba(255,255,255,0.9) 25%, rgba(255,255,255,0.9) 75%, rgba(255,255,255,0) 100%)}.dt-top,.dt-bottom{padding:8px 10px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.dt-top .dt-selector,.dt-bottom .dt-selector{padding:6px}.dt-top .dt-info,.dt-bottom .dt-info{margin:7px 0}.dt-input{padding:6px 12px}.dt-pagination ul{margin:0;padding-left:0}.dt-pagination ul li{list-style:none;float:left}.dt-pagination a,.dt-pagination span{border:1px solid transparent;float:left;margin-left:2px;padding:6px 12px;position:relative;text-decoration:none;color:inherit}.dt-pagination a:hover{background-color:#d9d9d9}.dt-pagination .active a,.dt-pagination .active a:focus,.dt-pagination .active a:hover{background-color:#d9d9d9;cursor:default}.dt-pagination .dt-ellipsis span{cursor:not-allowed}.dt-pagination .disabled a,.dt-pagination .disabled a:focus,.dt-pagination .disabled a:hover{cursor:not-allowed;opacity:0.4}.dt-pagination .pager a{font-weight:bold}.dt-table{max-width:100%;width:100%;border-spacing:0}.dt-table>tbody>tr>td,.dt-table>tbody>tr>th,.dt-table>tfoot>tr>td,.dt-table>tfoot>tr>th,.dt-table>thead>tr>td,.dt-table>thead>tr>th{vertical-align:top;padding:8px 10px;white-space:nowrap}.dt-table>thead>tr>th,.dt-table>thead>tr>td{vertical-align:bottom;text-align:left;border-bottom:1px solid #d9d9d9}.dt-table>tfoot>tr>th,.dt-table>tfoot>tr>td{vertical-align:bottom;text-align:left;border-top:1px solid #d9d9d9}.dt-table th{vertical-align:bottom;text-align:left}.dt-table th.dt-sorter{position:relative;cursor:pointer;padding-right:20px}.dt-table th.dt-sorter::before,.dt-table th.dt-sorter::after{content:"";height:0;width:0;position:absolute;right:7px;border-left:4px solid transparent;border-right:4px solid transparent;opacity:0.2}.dt-table th.dt-sorter::before{border-top:4px solid #000;top:18px}.dt-table th.dt-sorter::after{border-bottom:4px solid #000;border-top:4px solid transparent;bottom:22px}.dt-table th.dt-sorter.asc::after,.dt-table th.dt-sorter.desc::before{opacity:0.6}.hidden{display:none !important;opacity:0 !important}</style></head><body><table id='JSTable'><thead><tr><th>姓名</th><th>公司</th><th>住址</th><th>電話</th><th>手機</th></tr></thead><tr><td>邵不(Cornelius)</td><td>琴日漢物流股份有限公司</td><td>新北市坪林區楣子寮123號2樓</td><td>02-7793-5283</td><td>0973-668-860</td></tr><tr><td>歐陽容</td><td>龍染口食品工業股份有限公司一廠</td><td>新北市貢寮區龍門街150號10樓</td><td>02-3202-6136</td><td>0974-804-423</td></tr><tr><td>許孟林(Julia)</td><td>岳棠生物科技有限公司</td><td>新北市中和區台新街231號9樓</td><td>02-5591-2481</td><td>0952-266-606</td></tr><tr><td>曾驤(Marina)</td><td>薪床永商業股份有限公司</td><td>新北市泰山區應化街登山道76號8樓</td><td>02-5505-2899</td><td>0969-170-024</td></tr><tr><td>羅馨深(Elvis)</td><td>羅箱極貿易股份有限公司</td><td>新北市新店區花園六路68號9樓</td><td>02-6608-6829</td><td>0934-102-204</td></tr><tr><td>許陳機(Odelia)</td><td>良退食品股份有限公司</td><td>新北市石門區草埔尾224號4樓</td><td>02-3779-5122</td><td>0967-867-727</td></tr><tr><td>曹惶(Arno)</td><td>琴日漢物流股份有限公司</td><td>新北市八里區龍形三街225號6樓</td><td>02-6677-0275</td><td>0981-805-567</td></tr><tr><td>董羽曰(Prima)</td><td>結竹封食品有限公司</td><td>新北市淡水區番子田71號1樓</td><td>02-2127-1394</td><td>0994-291-125</td></tr><tr><td>巫辭(Andy)</td><td>夕盡科技股份有限公司三廠</td><td>新北市新莊區復興路２段89號10樓</td><td>02-2389-7776</td><td>0970-137-704</td></tr><tr><td>陸曰益(Fay)</td><td>守池事業有限公司</td><td>新北市板橋區僑中二街255號7樓</td><td>02-8529-6162</td><td>0908-322-290</td></tr><tr><td>蕭新勉(Philipppa)</td><td>而敕木業有限公司</td><td>新北市汐止區新興路35號5樓</td><td>02-7731-1140</td><td>0966-651-177</td></tr><tr><td>謝碑於(Bradley)</td><td>潛咸攝化學科技有限公司</td><td>新北市鶯歌區尖山路高厝巷214號10樓</td><td>02-2485-1917</td><td>0962-447-724</td></tr><tr><td>黎松取(Burke)</td><td>琴日漢物流股份有限公司</td><td>新北市新店區禾豐五路57號2樓</td><td>02-6620-2331</td><td>0930-174-450</td></tr><tr><td>丁日(Xenia)</td><td>索色阿國際興業股份有限公司</td><td>新北市中和區勝利路253號6樓</td><td>02-3174-0865</td><td>0940-519-993</td></tr><tr><td>丁登晚(Clare)</td><td>起古忠國際興業股份有限公司</td><td>新北市深坑區深南路145號4樓</td><td>02-2029-3225</td><td>0960-439-999</td></tr><tr><td>丁絳無(May)</td><td>且聚奏本企業社</td><td>新北市三重區仁忠街194號5樓</td><td>02-7798-8619</td><td>0934-930-086</td></tr><tr><td>丁規飛(Douglas)</td><td>體牒調煩貿易股份有限公司</td><td>新北市新莊區後港二路33號11樓</td><td>02-7776-0581</td><td>0930-379-938</td></tr><tr><td>丁岳咸(Elva)</td><td>西熟國際實業股份有限公司台灣分公司</td><td>新北市新店區梅崗一路92號7樓</td><td>02-5528-4034</td><td>0988-911-159</td></tr><tr><td>丁孔處(Mavis)</td><td>悚紡巾食品工業股份有限公司一廠</td><td>新北市林口區富貴路109號10樓</td><td>02-6607-0638</td><td>0961-808-844</td></tr><tr><td>丁甚(Herbert)</td><td>規音女啟國際實業股份有限公司</td><td>新北市新店區寶慶街237號5樓</td><td>02-7798-3833</td><td>0931-760-044</td></tr><tr><td>丁贊貽(Berg)</td><td>矜難靡扇農產有限公司</td><td>新北市樹林區東和街93號10樓</td><td>02-5569-1010</td><td>0948-358-869</td></tr><tr><td>丁殊(Breenda)</td><td>靡比農產有限公司</td><td>新北市新莊區大安路16號4樓</td><td>02-3514-4360</td><td>0994-728-840</td></tr><tr><td>丁辭夫(Tobias)</td><td>宜空兄生化科技股份有限公司</td><td>新北市深坑區松柏街230號4樓</td><td>02-2945-3029</td><td>0951-210-041</td></tr><tr><td>丁邑(Doris)</td><td>藏寂辭宿材料有限公司</td><td>新北市萬里區漁澳164號9樓</td><td>02-3491-3481</td><td>0949-112-298</td></tr><tr><td>丁射聲(Isabel)</td><td>覆卿廉材料科技股份有限公司</td><td>新北市貢寮區和美街217號5樓</td><td>02-6647-6617</td><td>0976-565-526</td></tr><tr><td>方終(Eric)</td><td>凋勞傍筵股份有限公司</td><td>新北市永和區永安街237號8樓</td><td>02-3340-9127</td><td>0900-050-087</td></tr><tr><td>方刻瑟(Martha)</td><td>歸宣及貿易股份有限公司</td><td>新北市雙溪區過溪67號2樓</td><td>02-6606-0490</td><td>0912-481-173</td></tr><tr><td>方射(Florence)</td><td>河量園生技科技有限公司</td><td>新北市蘆洲區永康街64號3樓</td><td>02-6600-7908</td><td>0952-135-596</td></tr><tr><td>王殿羅(Ellen)</td><td>霄此威科技股份有限公司二廠</td><td>新北市三芝區光明街61號10樓</td><td>02-6686-3450</td><td>0973-988-869</td></tr><tr><td>王卑投(Helen)</td><td>伯惻科技有限公司</td><td>新北市雙溪區過溪175號4樓</td><td>02-7797-9429</td><td>0923-680-033</td></tr><tr><td>尤佐操(Candice)</td><td>隱功布實業股份有限公司</td><td>新北市萬里區新墾丁路232號10樓</td><td>02-3739-5041</td><td>0962-922-258</td></tr><tr><td>王深轉(Dinah)</td><td>並金股份有限公司</td><td>新北市林口區南勢七街185號2樓</td><td>02-5571-9649</td><td>0923-254-494</td></tr><tr><td>方辭魚(Jill)</td><td>隸當食品股份有限公司</td><td>新北市金山區半嶺213號9樓</td><td>02-5599-7016</td><td>0940-182-245</td></tr><tr><td>王務飯(Margaret)</td><td>修德股份有限公司</td><td>新北市新店區直潭八街176號7樓</td><td>02-7760-4802</td><td>0987-877-710</td></tr><tr><td>王草孤(Tiffany)</td><td>獨禽傷端事業有限公司</td><td>新北市三峽區大勇路36號8樓</td><td>02-7723-6776</td><td>0926-500-077</td></tr><tr><td>王少(Blanche)</td><td>城箱國際實業股份有限公司台灣分公司</td><td>新北市深坑區翠谷街235號8樓</td><td>02-6614-6869</td><td>0914-221-106</td></tr><tr><td>王詳寸(Edith)</td><td>鱗面化學科技股份有限公司</td><td>新北市金山區中正路93號2樓</td><td>02-6657-5706</td><td>0966-136-694</td></tr><tr><td>尤極(Osborn)</td><td>并耽國際興業股份有限公司</td><td>新北市泰山區公園路217號10樓</td><td>02-2298-2928</td><td>0901-825-514</td></tr><tr><td>王食勒(Gail)</td><td>雲生冥科技股份有限公司</td><td>新北市林口區頭湖122號3樓</td><td>02-2594-0535</td><td>0925-488-877</td></tr><tr><td>尤指(Wilbur)</td><td>庶牧辱興食品有限公司</td><td>新北市八里區觀海大道183號9樓</td><td>02-6658-1087</td><td>0964-558-842</td></tr><tr><td>方府(Kelly)</td><td>令敕貿易股份有限公司</td><td>新北市烏來區屯鹿196號4樓</td><td>02-7745-7449</td><td>0916-426-641</td></tr><tr><td>王棠(Audrey)</td><td>轉飽益企業社</td><td>新北市三芝區茂興店34號2樓</td><td>02-2663-3980</td><td>0956-557-748</td></tr><tr><td>方官幾(Mary)</td><td>弗豈服裝行</td><td>新北市鶯歌區晨曦街一棟58號1樓</td><td>02-2472-7341</td><td>0956-842-259</td></tr><tr><td>王鞠(Kirk)</td><td>號物戶再有限公司</td><td>新北市坪林區嶺腳坑139號9樓</td><td>02-5547-8505</td><td>0930-587-786</td></tr><tr><td>王虞東(Sandy)</td><td>誅起工業股份有限公司二廠</td><td>新北市雙溪區東榮街219號7樓</td><td>02-8449-8267</td><td>0930-309-938</td></tr><tr><td>方心分(Giles)</td><td>周於有限公司</td><td>新北市平溪區雙菁路145號11樓</td><td>02-6616-9141</td><td>0951-381-151</td></tr><tr><td>方木(Joyce)</td><td>靡琴生食品有限公司</td><td>新北市三芝區海景五街222號10樓</td><td>02-8145-6774</td><td>0909-139-922</td></tr><tr><td>王翠(Elsie)</td><td>邇土企業股份有限公司</td><td>新北市三芝區梀板頭59號7樓</td><td>02-3190-6488</td><td>0961-546-668</td></tr><tr><td>王故物(Ursula)</td><td>實逐工業股份有限公司</td><td>新北市坪林區鶯子瀨172號12樓</td><td>02-3694-8756</td><td>0911-858-810</td></tr><tr><td>方俶福(Pete)</td><td>是庶科技股份有限公司三廠</td><td>新北市蘆洲區光華路34號2樓</td><td>02-3041-9115</td><td>0968-929-908</td></tr></table><script>/*! * JSTable v1.5.1 */const JSTableDefaultConfig={perPage:5,perPageSelect:[5,10,15,20,25],sortable:!0,searchable:!0,nextPrev:!0,firstLast:!1,prevText:"&lsaquo;",nextText:"&rsaquo;",firstText:"&laquo;",lastText:"&raquo;",ellipsisText:"&hellip;",truncatePager:!0,pagerDelta:2,classes:{top:"dt-top",info:"dt-info",input:"dt-input",table:"dt-table",bottom:"dt-bottom",search:"dt-search",sorter:"dt-sorter",wrapper:"dt-wrapper",dropdown:"dt-dropdown",ellipsis:"dt-ellipsis",selector:"dt-selector",container:"dt-container",pagination:"dt-pagination",loading:"dt-loading",message:"dt-message"},labels:{placeholder:"Search...",perPage:"{select} entries per page",noRows:"No entries found",info:"Showing {start} to {end} of {rows} entries",loading:"Loading...",infoFiltered:"Showing {start} to {end} of {rows} entries (filtered from {rowsTotal} entries)"},layout:{top:"{select}{search}",bottom:"{info}{pager}"},serverSide:!1,deferLoading:null,ajax:null,ajaxParams:{},queryParams:{page:"page",search:"search"},addQueryParams:!0,rowAttributesCreator:null};class JSTable{constructor(e,t={}){let s=e;"string"==typeof e&&(s=document.querySelector(e)),null!==s&&(this.config=this._merge(JSTableDefaultConfig,t),this.table=new JSTableElement(s),this.currentPage=1,this.columnRenderers=[],this.columnsNotSearchable=[],this.searchQuery=null,this.sortColumn=null,this.sortDirection="asc",this.isSearching=!1,this.filteredDataCount=null,this.pager=new JSTablePager(this),this._build(),this._buildColumns(),this.update(!this.config.serverSide),this._bindEvents(),this._emit("init"),this._parseQueryParams())}_build(){let e=this.config;this.wrapper=document.createElement("div"),this.wrapper.className=e.classes.wrapper;var t=["<div class='",e.classes.top,"'>",e.layout.top,"</div>","<div class='",e.classes.container,"'>","<div class='",e.classes.loading," hidden'>",e.labels.loading,"</div>","</div>","<div class='",e.classes.bottom,"'>",e.layout.bottom,"</div>"].join("");if(t=t.replace("{info}","<div class='"+e.classes.info+"'></div>"),e.perPageSelect){var s=["<div class='",e.classes.dropdown,"'>","<label>",e.labels.perPage,"</label>","</div>"].join(""),a=document.createElement("select");a.className=e.classes.selector,e.perPageSelect.forEach((function(t){var s=t===e.perPage,r=new Option(t,t,s,s);a.add(r)})),s=s.replace("{select}",a.outerHTML),t=t.replace(/\{select\}/g,s)}else t=t.replace(/\{select\}/g,"");if(e.searchable){var r=["<div class='",e.classes.search,"'>","<input class='",e.classes.input,"' placeholder='",e.labels.placeholder,"' type='text'>","</div>"].join("");t=t.replace(/\{search\}/g,r)}else t=t.replace(/\{search\}/g,"");this.table.element.classList.add(e.classes.table),t=t.replace("{pager}","<div class='"+e.classes.pagination+"'></div>"),this.wrapper.innerHTML=t,this.table.element.parentNode.replaceChild(this.wrapper,this.table.element),this.wrapper.querySelector("."+e.classes.container).appendChild(this.table.element),this._updatePagination(),this._updateInfo()}async update(e=!0){var t=this;this.currentPage>this.pager.getPages()&&(this.currentPage=this.pager.getPages());let s=t.wrapper.querySelector(" ."+t.config.classes.loading);if(s.classList.remove("hidden"),this.table.header.getCells().forEach((function(e,s){let a=t.table.head.rows[0].cells[s];a.innerHTML=e.getInnerHTML(),e.classes.length>0&&(a.className=e.classes.join(" "));for(let t in e.attributes)a.setAttribute(t,e.attributes[t]);a.setAttribute("data-sortable",e.isSortable)})),e)return this.getPageData(this.currentPage).then((function(e){t.table.element.classList.remove("hidden"),t.table.body.innerHTML="",e.forEach((function(e){t.table.body.appendChild(e.getFormatted(t.columnRenderers,t.config.rowAttributesCreator))})),s.classList.add("hidden")})).then((function(){t.getDataCount()<=0&&(t.wrapper.classList.remove("search-results"),t.setMessage(t.config.labels.noRows)),t._emit("update")})).then((function(){t._updatePagination(),t._updateInfo()}));t.table.element.classList.remove("hidden"),t.table.body.innerHTML="",this.getDataCount()<=0&&(t.wrapper.classList.remove("search-results"),t.setMessage(t.config.labels.noRows)),this._getData().forEach((function(e){t.table.body.appendChild(e.getFormatted(t.columnRenderers,t.config.rowAttributesCreator))})),s.classList.add("hidden")}_updatePagination(){let e=this.wrapper.querySelector(" ."+this.config.classes.pagination);e.innerHTML="",e.appendChild(this.pager.render(this.currentPage))}_updateInfo(){let e=this.wrapper.querySelector(" ."+this.config.classes.info),t=this.isSearching?this.config.labels.infoFiltered:this.config.labels.info;if(e&&t.length){var s=t.replace("{start}",this.getDataCount()>0?this._getPageStartIndex()+1:0).replace("{end}",this._getPageEndIndex()+1).replace("{page}",this.currentPage).replace("{pages}",this.pager.getPages()).replace("{rows}",this.getDataCount()).replace("{rowsTotal}",this.getDataCountTotal());e.innerHTML=s}}_getPageStartIndex(){return(this.currentPage-1)*this.config.perPage}_getPageEndIndex(){let e=this.currentPage*this.config.perPage-1;return e>this.getDataCount()-1?this.getDataCount()-1:e}_getData(){return this._emit("getData",this.table.dataRows),this.table.dataRows.filter((function(e){return e.visible}))}_fetchData(){var e=this;let t={searchQuery:this.searchQuery,sortColumn:this.sortColumn,sortDirection:this.sortDirection,start:this._getPageStartIndex(),length:this.config.perPage,datatable:1};t=Object.assign({},this.config.ajaxParams,t);let s=this.config.ajax+"?"+this._queryParams(t);return fetch(s,{method:"GET",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){return e._emit("fetchData",t),e.filteredDataCount=t.recordsFiltered,t.data})).then((function(e){let t=[];return e.forEach((function(e){t.push(JSTableRow.createFromData(e))})),t})).catch((function(e){console.error(e)}))}_queryParams(e){return Object.keys(e).map((t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t]))).join("&")}getDataCount(){return this.isSearching?this.getDataCountFiltered():this.getDataCountTotal()}getDataCountFiltered(){return this.config.serverSide?this.filteredDataCount:this._getData().length}getDataCountTotal(){return this.config.serverSide?this.config.deferLoading:this.table.dataRows.length}getPageData(){if(this.config.serverSide)return this._fetchData();let e=this._getPageStartIndex();var t=this._getPageEndIndex();return Promise.resolve(this._getData()).then((function(s){return s.filter((function(s,a){return a>=e&&a<=t}))}))}async search(e){var t=this;return this.searchQuery=e.toLowerCase(),this.currentPage=1,this.isSearching=!0,this.searchQuery.length?(this.config.serverSide||this.table.dataRows.forEach((function(e){e.visible=!1,t.searchQuery.split(" ").reduce((function(s,a){var r;let i=e.getCells();return i=i.filter((function(e,s){if(t.columnsNotSearchable.indexOf(s)<0)return!0})),r=i.some((function(e,t){if(e.getTextContent().toLowerCase().indexOf(a)>=0)return!0})),s&&r}),!0)&&(e.visible=!0)})),this.wrapper.classList.add("search-results"),this.update().then((function(){t._emit("search",e)}))):(this.table.dataRows.forEach((function(e){e.visible=!0})),this.isSearching=!1,t.wrapper.classList.remove("search-results"),t.update(),!1)}sort(e,t,s=!1){var a=this;if(this.sortColumn=e||0,this.sortDirection=t,this.sortColumn<0||this.sortColumn>this.table.getColumnCount()-1)return!1;var r=this.table.header.getCell(this.sortColumn),i=this.table.dataRows;this.table.header.getCells().forEach((function(e){e.removeClass("asc"),e.removeClass("desc")})),r.addClass(this.sortDirection),this.config.serverSide||(i=i.sort((function(e,t){var s=e.getCellTextContent(a.sortColumn).toLowerCase(),r=t.getCellTextContent(a.sortColumn).toLowerCase();return s=s.replace(/(\$|\,|\s|%)/g,""),r=r.replace(/(\$|\,|\s|%)/g,""),s=isNaN(s)||""===s?s:parseFloat(s),r=isNaN(r)||""===r?r:parseFloat(r),""===s&&""!==r||isNaN(s)&&!isNaN(r)?"asc"===a.sortDirection?1:-1:""!==s&&""===r||!isNaN(s)&&isNaN(r)?"asc"===a.sortDirection?-1:1:"asc"===a.sortDirection?s===r?0:s>r?1:-1:s===r?0:s<r?1:-1})),this.table.dataRows=i),this.config.serverSide&&s||this.update(),this._emit("sort",this.sortColumn,this.sortDirection)}async paginate(e){var t=this;return this.currentPage=e,this.update().then((function(){t._emit("paginate",t.currentPage,e)}))}_bindEvents(){var e=this;this.wrapper.addEventListener("click",(function(t){var s=t.target;if(s.hasAttribute("data-page")){t.preventDefault();let a=parseInt(s.getAttribute("data-page"),10);if(e.paginate(a),e.config.addQueryParams){const t=new URL(window.location.href);t.searchParams.set(e.config.queryParams.page,a),window.history.replaceState(null,null,t)}}if("TH"===s.nodeName&&s.hasAttribute("data-sortable")){if("false"===s.getAttribute("data-sortable"))return!1;t.preventDefault(),e.sort(s.cellIndex,s.classList.contains("asc")?"desc":"asc")}})),this.config.perPageSelect&&this.wrapper.addEventListener("change",(function(t){var s=t.target;if("SELECT"===s.nodeName&&s.classList.contains(e.config.classes.selector)){t.preventDefault();let a=parseInt(s.value,10);e._emit("perPageChange",e.config.perPage,a),e.config.perPage=a,e.update()}})),this.config.searchable&&this.wrapper.addEventListener("keyup",(function(t){if("INPUT"===t.target.nodeName&&t.target.classList.contains(e.config.classes.input)&&(t.preventDefault(),e.search(t.target.value),e.config.addQueryParams)){const s=new URL(window.location.href);s.searchParams.set(e.config.queryParams.search,t.target.value),window.history.replaceState(null,null,s)}}))}on(e,t){this.events=this.events||{},this.events[e]=this.events[e]||[],this.events[e].push(t)}off(e,t){this.events=this.events||{},e in this.events!=!1&&this.events[e].splice(this.events[e].indexOf(t),1)}_emit(e){if(this.events=this.events||{},e in this.events!=!1)for(var t=0;t<this.events[e].length;t++)this.events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}setMessage(e){var t=this.table.getColumnCount(),s=document.createElement("tr");s.innerHTML='<td class="'+this.config.classes.message+'" colspan="'+t+'">'+e+"</td>",this.table.body.innerHTML="",this.table.body.appendChild(s)}_buildColumns(){var e=this;let t=null,s=null;this.config.columns&&this.config.columns.forEach((function(a){isNaN(a.select)||(a.select=[a.select]),a.select.forEach((function(r){var i=e.table.header.getCell(r);if(void 0!==i){if(a.hasOwnProperty("render")&&"function"==typeof a.render&&(e.columnRenderers[r]=a.render),a.hasOwnProperty("sortable")){let r=!1;i.hasSortable?r=i.isSortable:(r=a.sortable,i.setSortable(r)),r&&(i.addClass(e.config.classes.sorter),a.hasOwnProperty("sort")&&1===a.select.length&&(t=a.select[0],s=a.sort))}a.hasOwnProperty("searchable")&&(i.addAttribute("data-searchable",a.searchable),!1===a.searchable&&e.columnsNotSearchable.push(r))}}))})),this.table.header.getCells().forEach((function(a,r){null===a.isSortable&&a.setSortable(e.config.sortable),a.isSortable&&(a.addClass(e.config.classes.sorter),a.hasSort&&(t=r,s=a.sortDirection))})),null!==t&&e.sort(t,s,!0)}_merge(e,t){var s=this;return Object.keys(e).forEach((function(a){!t.hasOwnProperty(a)||"object"!=typeof t[a]||t[a]instanceof Array?t.hasOwnProperty(a)||(t[a]=e[a]):s._merge(e[a],t[a])})),t}async _parseQueryParams(){const e=new URLSearchParams(window.location.search);let t=e.get(this.config.queryParams.search);if(t){this.wrapper.querySelectorAll("."+this.config.classes.input).forEach((function(e){e.value=t})),await this.search(t)}let s=e.get(this.config.queryParams.page);s&&await this.paginate(parseInt(s))}}class JSTableElement{constructor(e){this.element=e,this.body=this.element.tBodies[0],this.head=this.element.tHead,this.rows=Array.from(this.element.rows).map((function(e,t){return new JSTableRow(e,e.parentNode.nodeName,t)})),this.dataRows=this._getBodyRows(),this.header=this._getHeaderRow()}_getBodyRows(){return this.rows.filter((function(e){return!e.isHeader&&!e.isFooter}))}_getHeaderRow(){return this.rows.find((function(e){return e.isHeader}))}getColumnCount(){return this.header.getColumnCount()}getFooterRow(){return this.rows.find((function(e){return e.isFooter}))}}class JSTableRow{constructor(e,t="",s=null){this.cells=Array.from(e.cells).map((function(e){return new JSTableCell(e)})),this.d=this.cells.length,this.isHeader="THEAD"===t,this.isFooter="TFOOT"===t,this.visible=!0,this.rowID=s;var a=this;this.attributes={},[...e.attributes].forEach((function(e){a.attributes[e.name]=e.value}))}getCells(){return Array.from(this.cells)}getColumnCount(){return this.cells.length}getCell(e){return this.cells[e]}getCellTextContent(e){return this.getCell(e).getTextContent()}static createFromData(e){let t=document.createElement("tr");if(e.hasOwnProperty("data")){if(e.hasOwnProperty("attributes"))for(const s in e.attributes)t.setAttribute(s,e.attributes[s]);e=e.data}return e.forEach((function(e){let s=document.createElement("td");if(s.innerHTML=e&&e.hasOwnProperty("data")?e.data:e,e&&e.hasOwnProperty("attributes"))for(const t in e.attributes)s.setAttribute(t,e.attributes[t]);t.appendChild(s)})),new JSTableRow(t)}getFormatted(e,t=null){let s=document.createElement("tr");var a=this;for(let e in this.attributes)s.setAttribute(e,this.attributes[e]);let r=t?t.call(this,this.getCells()):{};for(const e in r)s.setAttribute(e,r[e]);return this.getCells().forEach((function(t,r){var i=document.createElement("td");i.innerHTML=t.getInnerHTML(),e.hasOwnProperty(r)&&(i.innerHTML=e[r].call(a,t.getElement(),r)),t.classes.length>0&&(i.className=t.classes.join(" "));for(let e in t.attributes)i.setAttribute(e,t.attributes[e]);s.appendChild(i)})),s}setCellClass(e,t){this.cells[e].addClass(t)}}class JSTableCell{constructor(e){this.textContent=e.textContent,this.innerHTML=e.innerHTML,this.className="",this.element=e,this.hasSortable=e.hasAttribute("data-sortable"),this.isSortable=this.hasSortable?"true"===e.getAttribute("data-sortable"):null,this.hasSort=e.hasAttribute("data-sort"),this.sortDirection=e.getAttribute("data-sort"),this.classes=[];var t=this;this.attributes={},[...e.attributes].forEach((function(e){t.attributes[e.name]=e.value}))}getElement(){return this.element}getTextContent(){return this.textContent}getInnerHTML(){return this.innerHTML}setClass(e){this.className=e}setSortable(e){this.isSortable=e}addClass(e){this.classes.push(e)}removeClass(e){this.classes.indexOf(e)>=0&&this.classes.splice(this.classes.indexOf(e),1)}addAttribute(e,t){this.attributes[e]=t}}class JSTablePager{constructor(e){this.instance=e}getPages(){let e=Math.ceil(this.instance.getDataCount()/this.instance.config.perPage);return 0===e?1:e}render(){var e=this.instance.config;let t=this.getPages(),s=document.createElement("ul");if(t>1){let a=1===this.instance.currentPage?1:this.instance.currentPage-1,r=this.instance.currentPage===t?t:this.instance.currentPage+1;e.firstLast&&s.appendChild(this.createItem("pager",1,e.firstText)),e.nextPrev&&s.appendChild(this.createItem("pager",a,e.prevText)),this.truncate().forEach((function(e){s.appendChild(e)})),e.nextPrev&&s.appendChild(this.createItem("pager",r,e.nextText)),e.firstLast&&s.appendChild(this.createItem("pager",t,e.lastText))}return s}createItem(e,t,s,a){let r=document.createElement("li");return r.className=e,r.innerHTML=a?"<span>"+s+"</span>":'<a href="#" data-page="'+t+'">'+s+"</a>",r}isValidPage(e){return e>0&&e<=this.getPages()}truncate(){var e,t=this,s=t.instance.config,a=2*s.pagerDelta,r=t.instance.currentPage,i=r-s.pagerDelta,n=r+s.pagerDelta,l=this.getPages(),o=[],c=[];if(this.instance.config.truncatePager){r<4-s.pagerDelta+a?n=3+a:r>this.getPages()-(3-s.pagerDelta+a)&&(i=this.getPages()-(2+a));for(var h=1;h<=l;h++)(1===h||h===l||h>=i&&h<=n)&&o.push(h);o.forEach((function(a){e&&(a-e==2?c.push(t.createItem("",e+1,e+1)):a-e!=1&&c.push(t.createItem(s.classes.ellipsis,0,s.ellipsisText,!0))),c.push(t.createItem(a==r?"active":"",a,a)),e=a}))}else for(let e=1;e<=this.getPages();e++)c.push(this.createItem(e===r?"active":"",e,e));return c}}window.JSTable=JSTable;</script><script>new JSTable("#JSTable", {  perPage: 10,  perPageSelect: [10, 15, 20, 25, 30],  nextPrev: true,  firstLast: false,  prevText: "&lsaquo;",  nextText: "&rsaquo;",  firstText: "&laquo;",  lastText: "&raquo;",  ellipsisText: "&hellip;",  truncatePager: true,  pagerDelta: 2,  searchable: true,  sortable: true,  // css class  top: "dt-top",  info: "dt-info",  input: "dt-input",  table: "dt-table",  bottom: "dt-bottom",  search: "dt-search",  sorter: "dt-sorter",  wrapper: "dt-wrapper",  dropdown: "dt-dropdown",  ellipsis: "dt-ellipsis",  selector: "dt-selector",  container: "dt-container",  pagination: "dt-pagination",  loading: "dt-loading",  message: "dt-message"});</script></body></html></pre></div>    <footer><p>update: 2022/06/29 20:51 by: Jeff</p><a class='repo' href='https://github.com/JSLiao/FileMaker-executeSql' target='_blank'>repository</a></footer>    <script></script>  </body></html>