<!DOCTYPE html><html lang='en'>  <head>    <meta charset='UTF-8' />    <meta aceVersion='v1.4.14' frameVersion='v1' />    <meta http-equiv='X-UA-Compatible' content='IE=edge' />    <meta name='viewport' content='width=device-width, initial-scale=1.0' />    <title>FileMaker system tables and meta field</title>    <style>:root {  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  font-size: 16px;  background-color: #111;  margin: 0;  padding: 0;  color: #eee;  hyphens: auto;--background_th: #333;}#main-subject {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  /* display:inline-block; */  position: fixed;  left: 6px;  top: 6px;  padding: 6px 3px;  align-content: flex-start;  text-decoration: none;  width: 97%;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 3px;}/* btn toEdit, tsToTc */#btn-toEdit, #btn-tsToTc {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 16px;  cursor:pointer;  align-content: flex-start;}/* btn toEdit */#btn-toEdit {  right: 6px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 32px;  position: fixed;}/* btn tsToTc */#btn-tsToTc {  right: 44px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 64px;  position: fixed;}#main-subject:hover,#btn-toEdit:hover,#btn-tsToTc:hover {  background-color: rgba(45, 45, 45, 0.9);  color: #c0edfe;}#main-subject:active,#btn-toEdit:active,#btn-tsToTc:active {  background-color: rgb(255, 145, 45);  color: #c0edfe;}.subNote {  right:20px;  text-align: right;  font-size: 0.9rem;  color: lightGray;}content {  color: lightgray;}p {  color: #ddd;  font-size: 1rem;  height: auto;  padding: 0rem;  margin-block-start: 0.5rem;  margin-block-end: 0.5rem;}hr {  color: #666;  height: 0.5px;}a {  border: none;  color: #ff5;  height: 100%;  text-decoration: none;}a:hover {  color: #fa3;}a:hover:after {  left: auto;  right: 0;  width: 100%;}a:active {  top: 2px;}/* table 样式 */table {  border-top: 1px solid #ccc;  border-left: 1px solid #ccc;}table td,table th {  border-bottom: 1px solid #ccc;  border-right: 1px solid #ccc;  padding: 3px 5px;}table th { background-color: var(--background_th) !important;  border-bottom: 2px solid #ccc;  text-align: center;}/* blockquote 样式 */blockquote {  display: block;  border-left: 5px solid #d0e5f2;  padding: 3px 5px;  margin: 6px 0;  line-height: 1.4;  font-size: 100%;  background-color: #f1f1f1;}/* code 样式 */code {  display: inline-block;  *display: inline;  *zoom: 1;  color: lightgray;  background-color: #fff3;  border-radius: 1px;  padding: 1px 3px;  margin: 0 1px;  font-size: 0.9rem;  font-family: monaco 'robot mono' mono !important;}pre code {  display: block;}/* ul ol 样式 */ul,ol {  margin-left: 8px;  padding-left:4px;  padding-right: 0;}li{  margin-left:0;  padding-left:0px;}ul li{  list-style-type: disc;}ol lit{  list-style-type: decimal;}.sectionTitle {  font-size: 1.2rem;}.preCodecontianer {  background-color: #fff1;}.cssDefault {  font-size: 0.9rem;  color: gray;  margin-left: 1rem;}footer {  text-align: right;  padding: 1px 12px;  margin:1px;  background-color: #8882;  color: lightgray;  bottom:8px;  right:24px;  position:fixed;  z-index: 1;}h1{  font-size:24px;}h2{  font-size:22px;}h3{  font-size:20px;}h4{  font-size:18px;}h5{  font-size:16px;}font[size='1']{  font-size:12px;  padding: 0.1em;  margin: 0.1em;}font[size='2']{  font-size:14px;  padding: 0.1em;  margin: 0.1em;}font[size='3']{  font-size:16px;  padding: 0.1em;  margin: 0.1em;}font[size='4']{  font-size:18px;  padding: 0.1em;  margin: 0.1em;}font[size='5']{  font-size:20px;  padding: 0.1em;  margin: 0.1em;}font[size='6']{  font-size:22px;  padding: 0.1em;  margin: 0.1em;}font[size='7']{  font-size:24px;  padding: 0.2em;}blockquote, blockquote p{  background:#0003 !important;}blockquote, blockquote p{  background:transparent !important;}/* width */::-webkit-scrollbar {width: 12px;}/* Track */::-webkit-scrollbar-track {background: #333;}/* Handle */::-webkit-scrollbar-thumb {background: #345;}/* Handle on hover */::-webkit-scrollbar-thumb:hover {background: #357;}</style>    <style>:root {  margin: 0;  padding: 0;  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  --background: #111;  --color: #ddd;  --font-size: 16px;  --background_th: #555;  --color-a: #ff5;  --color-a-hover: #fa3;  --background-blockquote: #00e9;  --font-size-code: 14px;  --background-code: #fff3;  background-color: var(--background);  color: var(--color);  font-size: var(--font-size);}.notesView{  background-color: #0308;  margin:0;  padding:8px 2px 8px 16px;}.codeView{  background-color: #0038;  margin:0;  padding:8px 2px 8px 16px;}.resultView{  background-color: #3008;  margin:0;  padding:8px 2px 8px 16px;}.code, .result{  font-family: monaco, monospace;  font-size:13px;  color:var(--color);}</style>  </head>  <body>    <!--完整檢視才顯示, begin-->    <div class='notesView'>      <p id='main-subject'>FileMaker system tables and meta field</p>      <br><br><div class='content'><p>每個 FileMaker 檔案都有 3 個 sql table</p><p style="padding-left:2em;">FileMaker_Tables</p><p style="padding-left:2em;">FileMaker_Fields</p><p style="padding-left:2em;">FileMaker_BaseTableFields ( v 19.4.1 新增 )</p><hr/><h3><font color="#f9963b" id="8fscr">FileMaker_Tables</font></h3><ul><li><font size="3">TableName - The name of the table occurrence.</font></li><li><font size="3">TableId - The unique ID for the table occurrence.</font></li><li><font size="3">BaseTableName - The name of the base table from which the table occurrence was created.</font></li><li><font size="3">BaseFileName - The FileMaker Pro filename for the database file that contains the base table.</font></li><li><font size="3">ModCount - The total number of times changes to this table’s definition have been committed.</font></li></ul><p>如果 table relations &nbsp;中 TO 的 baseTable 被刪除, 雖然TableName可以取得值, 但是BaseFileName 和&nbsp;BaseFileName 都會是空值, 可以用 Is Null 檢查</p><p>FileMaker_Tables 會取得 external data source 的 table 的資料<br/></p><hr/><h3><font color="#f9963b" id="wa0gc">FileMaker_Fields</font></h3><ul><li><font size="3">TableName - The name of the table that contains the field.</font></li><li><font size="3">FieldName - The name of the field.</font></li><li><font size="3">FieldType - The SQL data type of the field.</font></li><li><span style="color: var(--color); background-color: var(--background);"><font size="3">&nbsp;FieldId - The unique ID for the field.</font></span></li><li><font size="3"><span style="color: var(--color); background-color: var(--background);">FieldClass - One of three values: Summary, for summary fields; Calculated, for calculated&nbsp;</span><span style="color: var(--color); background-color: var(--background);">results; or Normal.&nbsp;</span></font></li><li><span style="color: var(--color); background-color: var(--background);"><font size="3">FieldReps - The number of repetitions of the field.</font></span></li><li><span style="color: var(--color); background-color: var(--background);"><font size="3">ModCount - The total number of times changes to this table’s definition have been committed.</font></span></li></ul><p>如果 table relations &nbsp;中 TO 的 baseTable 被刪除, 不會取得這個 table 的資料<br/></p><p>FileMaker_Fields 會取得 external data source 的 table 的資料<br/></p><hr/><h3><font color="#f9963b" id="ylurm">FileMaker_BaseTableFields</font></h3><ul><li><font size="3">BaseTableName - The name of the base table that contains the field.</font></li><li><font size="3">FieldName - The name of the field.</font></li><li><font size="3">FieldType - The SQL data type of the field.</font></li><li><font size="3">FieldId - The unique ID for the field.</font></li><li><font size="3">FieldClass - One of three values: Summary, for summary fields; Calculated, for calculated results; or Normal.</font></li><li><font size="3">FieldReps - The number of repetitions of the field.</font></li><li><font size="3">ModCount - The total number of times changes to this base table’s definition have been committed.</font></li></ul><p>如果 table relations &nbsp;中 TO 的 baseTable 被刪除, 不會取得這個 table 的資料<br/></p><p>FileMaker_BaseTableFields 不會取得 external data source 的 table 的資料</p><hr/><p>每個 table 都有 2 個 sql column<br/></p><p>rowId :&nbsp;相當於 get (recordId)</p><p>rowModId: 相當於 get( recordModificationCount)</p></div>    </div>    <div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>executeSql("  Select *  From FileMaker_BaseTableFields  Where baseTableName = ?   "; "," & char(9); "" ; get(layoutTableName))</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'></pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*如果 table relations  中 TO 的 baseTable 被刪除, 雖然TableName可以取得值, 但是BaseFileName 和 BaseFileName 都會是空值用 Is Null 檢查, 是否有這樣的 tableName 存在*/ExecuteSQL("  Select tableName   FROM filemaker_tables  Where baseTableName Is Null  " ; "  "; "" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>notice</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*FileMaker_BaseTableFields ( v 19.4.1 新增 )取得的內容, 因檔案而異*/"baseTableName,fieldName,fieldType,fieldClass,fieldReps,modCount¶" & executeSql("  Select *  From filemaker_baseTableFields  "; ""; "")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'></pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*利用 FileMaker_Tables 和 FileMaker_Fields 取得幾乎和 FileMaker_BaseTableFields 相同的內容這個計算式比 FileMaker_BaseTableFields 多取得了 external data source 的資料如果你的 FileMaker 19.4.1 之前可以用這個計算式取得 baseTable 的相關資料取得的內容, 因檔案而異*/let (    ~sqlResult = ExecuteSQL("      Select filemaker_fields.tableName, filemaker_fields.fieldName, filemaker_fields.fieldType,         filemaker_fields.fieldClass, filemaker_fields.fieldReps, filemaker_fields.modCount      From filemaker_fields      Join filemaker_tables on filemaker_tables.baseTableName = filemaker_fields.tableName      Where filemaker_fields.tableName in ( Select filemaker_tables.baseTableName From filemaker_tables )      "; ""; "");  "baseTableName,fieldName,fieldType,fieldClass,fieldReps,modCount¶" & UniqueValues ( ~sqlResult ))</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'></pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*這個 sample 可以看到 Select * 的效果即使是在 where 子句已經限定了 baseTable也因為 select * 的存在而失效*/let (    ~sqlResult = ExecuteSQL("      Select *      From filemaker_fields      Join filemaker_tables on filemaker_tables.baseTableName = filemaker_fields.tableName      Where filemaker_fields.tableName in ( Select filemaker_tables.baseTableName From filemaker_tables )      "; ""; "");  "baseTableName,fieldName,fieldType,fieldClass,fieldReps,modCount¶" & UniqueValues ( ~sqlResult ))</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'></pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*找出外部檔案引入的 TO name*/Let (  [    // 找出非內部的 baseTableName    ~baseTableNameExt = ExecuteSQL("      Select Distinct filemaker_tables.baseTableName      From filemaker_tables      Where filemaker_tables.baseTableName Not In         (Select filemaker_baseTableFields.baseTableName from filemaker_baseTableFields)      "; "" ; "")  ];  // 找出非內部的 To Name  if ( ~baseTableNameExt = "" ;     "" ;    // 產生 In 所需要的內容    let ( ~baseTableNameExt = "'" & Substitute ( ~baseTableNameExt ; "¶" ; "','" ) & "'" ;    ExecuteSQL("      Select Distinct filemaker_tables.tableName      From filemaker_tables      Where filemaker_tables.tableName In ( " & ~baseTableNameExt & ")      "; ""; ""))  ))</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'></pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*取得 active field 的基本資訊使用 join 子句, , 引數*/Let (  [    ~tableName = Get(ActiveFieldTableName);    ~fieldName = Get(ActiveFieldName)  ];  ExecuteSQL("    Select filemaker_tables.baseTableName, filemaker_fields.tableName, filemaker_fields.fieldName,       filemaker_fields.fieldType, filemaker_fields.fieldClass, filemaker_fields.fieldReps, filemaker_fields.modCount    From filemaker_fields    Join filemaker_tables on filemaker_tables.tableName = filemaker_fields.tableName    Where filemaker_fields.tableName = ? And filemaker_fields.fieldName = ?    "; ¶; "" ; ~tableName ; ~fieldName ))</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'></pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*取得 active field 的基本資訊另一種寫法: 使用子查詢, 引數*/Let (  [    ~tableName = Get(ActiveFieldTableName);    ~fieldName = Get(ActiveFieldName)  ];  ExecuteSQL("    Select ( Select filemaker_tables.baseTableName From filemaker_tables Where filemaker_tables.tableName = ? ),       filemaker_fields.tableName, filemaker_fields.fieldName, filemaker_fields.fieldType,       filemaker_fields.fieldClass, filemaker_fields.fieldReps, filemaker_fields.modCount    From filemaker_fields    Where filemaker_fields.tableName = ? And filemaker_fields.fieldName = ?    "; ¶; "" ; ~tableName ; ~tableName ; ~fieldName ))</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'></pre></div>    <footer><p>update: 2022/06/24 03:13:48 by: Jeff</p><a class='repo' href='https://github.com/JSLiao/FileMaker-executeSql' target='_blank'>repository</a></footer>    <script></script>  </body></html>