<!DOCTYPE html><html lang='en'>  <head>    <meta charset='UTF-8' />    <meta aceVersion='v1.4.14' frameVersion='v1' />    <meta http-equiv='X-UA-Compatible' content='IE=edge' />    <meta name='viewport' content='width=device-width, initial-scale=1.0' />    <title>sub-query 子查詢</title>    <style>:root {  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  font-size: 16px;  background-color: #111;  margin: 0;  padding: 0;  color: #eee;  hyphens: auto;--background_th: #333;}#main-subject {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  /* display:inline-block; */  position: fixed;  left: 6px;  top: 6px;  padding: 6px 3px;  align-content: flex-start;  text-decoration: none;  width: 97%;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 3px;}/* btn toEdit, tsToTc */#btn-toEdit, #btn-tsToTc {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 16px;  cursor:pointer;  align-content: flex-start;}/* btn toEdit */#btn-toEdit {  right: 6px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 32px;  position: fixed;}/* btn tsToTc */#btn-tsToTc {  right: 44px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 64px;  position: fixed;}#main-subject:hover,#btn-toEdit:hover,#btn-tsToTc:hover {  background-color: rgba(45, 45, 45, 0.9);  color: #c0edfe;}#main-subject:active,#btn-toEdit:active,#btn-tsToTc:active {  background-color: rgb(255, 145, 45);  color: #c0edfe;}.subNote {  right:20px;  text-align: right;  font-size: 0.9rem;  color: lightGray;}content {  color: lightgray;}p {  color: #ddd;  font-size: 1rem;  height: auto;  padding: 0rem;  margin-block-start: 0.5rem;  margin-block-end: 0.5rem;}hr {  color: #666;  height: 0.5px;}a {  border: none;  color: #ff5;  height: 100%;  text-decoration: none;}a:hover {  color: #fa3;}a:hover:after {  left: auto;  right: 0;  width: 100%;}a:active {  top: 2px;}/* table 样式 */table {  border-top: 1px solid #ccc;  border-left: 1px solid #ccc;}table td,table th {  border-bottom: 1px solid #ccc;  border-right: 1px solid #ccc;  padding: 3px 5px;}table th { background-color: var(--background_th) !important;  border-bottom: 2px solid #ccc;  text-align: center;}/* blockquote 样式 */blockquote {  display: block;  border-left: 5px solid #d0e5f2;  padding: 3px 5px;  margin: 6px 0;  line-height: 1.4;  font-size: 100%;  background-color: #f1f1f1;}/* code 样式 */code {  display: inline-block;  *display: inline;  *zoom: 1;  color: lightgray;  background-color: #fff3;  border-radius: 1px;  padding: 1px 3px;  margin: 0 1px;  font-size: 0.9rem;  font-family: monaco 'robot mono' mono !important;}pre code {  display: block;}/* ul ol 样式 */ul,ol {  margin-left: 8px;  padding-left:4px;  padding-right: 0;}li{  margin-left:0;  padding-left:0px;}ul li{  list-style-type: disc;}ol lit{  list-style-type: decimal;}.sectionTitle {  font-size: 1.2rem;}.preCodecontianer {  background-color: #fff1;}.cssDefault {  font-size: 0.9rem;  color: gray;  margin-left: 1rem;}footer {  text-align: right;  padding: 1px 12px;  margin:1px;  background-color: #8882;  color: lightgray;  bottom:8px;  right:24px;  position:fixed;  z-index: 1;}h1{  font-size:24px;}h2{  font-size:22px;}h3{  font-size:20px;}h4{  font-size:18px;}h5{  font-size:16px;}font[size='1']{  font-size:12px;  padding: 0.1em;  margin: 0.1em;}font[size='2']{  font-size:14px;  padding: 0.1em;  margin: 0.1em;}font[size='3']{  font-size:16px;  padding: 0.1em;  margin: 0.1em;}font[size='4']{  font-size:18px;  padding: 0.1em;  margin: 0.1em;}font[size='5']{  font-size:20px;  padding: 0.1em;  margin: 0.1em;}font[size='6']{  font-size:22px;  padding: 0.1em;  margin: 0.1em;}font[size='7']{  font-size:24px;  padding: 0.2em;}blockquote, blockquote p{  background:#0003 !important;}blockquote, blockquote p{  background:transparent !important;}/* width */::-webkit-scrollbar {width: 12px;}/* Track */::-webkit-scrollbar-track {background: #333;}/* Handle */::-webkit-scrollbar-thumb {background: #345;}/* Handle on hover */::-webkit-scrollbar-thumb:hover {background: #357;}</style>    <style>:root {  margin: 0;  padding: 0;  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  --background: #111;  --color: #ddd;  --font-size: 16px;  --background_th: #555;  --color-a: #ff5;  --color-a-hover: #fa3;  --background-blockquote: #00e9;  --font-size-code: 14px;  --background-code: #fff3;  background-color: var(--background);  color: var(--color);  font-size: var(--font-size);}.notesView{  background-color: #0308;  margin:0;  padding:8px 2px 8px 16px;}.codeView{  background-color: #0038;  margin:0;  padding:8px 2px 8px 16px;}.resultView{  background-color: #3008;  margin:0;  padding:8px 2px 8px 16px;}.code, .result{  font-family: monaco, monospace;  font-size:13px;  color:var(--color);}</style>  </head>  <body>    <!--完整檢視才顯示, begin-->    <div class='notesView'>      <p id='main-subject'>sub-query 子查詢</p>      <br><br><div class='content'><p>每一個子查詢都是完整的Select敘述，必須用小括弧包起來，最少包含 Select 和 From 這兩個子句。<br/>如果SQL查詢指令內有子查詢，首先處理的是子查詢條件，然後再依子查詢取得的條件值來處理主查詢，然後就去得最後的查詢結果。</p><ol><li><font color="#eeece0">子查詢要放在括號()中。</font></li><li><font color="#eeece0">子查詢和主要 table ( left table ) 可以是完全沒有關係。</font></li><li><font color="#eeece0"><span style="caret-color: rgb(238, 236, 224);">可以有多個</span></font>子查詢</li><li>子查詢可以同時在 select&nbsp;&nbsp;clause 和 where &nbsp;clause 中出現</li><li><font color="#eeece0">子查詢 Select 只取得單一欄位的值，可以當作 Where 子句中的比較運算。</font></li><li><font color="#eeece0">子查詢可以當作 In 邏輯運算子的符合條件。</font></li><li><font color="#eeece0">防範錯誤邏輯的子查詢取得錯誤的計算結果</font>。</li></ol><p>在 Where 使用子查詢主要目的: 取得其他資料表紀錄的欄位值來建立 Where 句的條件運算式。</p><p><br/></p><p><br/></p></div>    </div>    <div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*sub-query 以放在 select 子句*/  ExecuteSQL("  Select ( Select employee.name from employee Where employee.id = sell.salesRep ), sum( sellItem.item_qty * sellItem.item_unitPrice)  From sell  Join sellItem on sell.id = sellItem.idf  group by sell.salesRep  Fetch First 10 Rows Only  "; ""; "" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>陸非建,50745馬照貽,22395蕭軻車,49815施既,23145阮禍,62160曹玄比,64275陳力增,54600袁嘯,62040董素感,52800</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*子查詢也可以放在 Where 子句中*/executeSql("  Select id, total, ( Select Avg(total) From sell )  From sell   Where total &gt; ( Select Avg(total) from sell ) Fetch First 10 Rows Only"; ""; "" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>001F6742-DC92-4156-870D-DC33B7B31CE5,1065,883.95010BEA0C-0138-4D5E-916F-B1B4C30168AD,1200,883.9501974791-1610-4B6F-A70C-D9558B7CFBE3,900,883.95023F713F-4D89-4B20-9778-86F0ACA43F90,1140,883.95045A9E71-A0B2-44CA-BF31-A54B96A25087,1140,883.9506D05363-B981-4652-B918-AFB0F0FB41A2,1455,883.9508A44C66-A9C9-4ECF-9FDA-E259BF4630F3,1845,883.9508D9B939-3118-425D-9F38-543D3CF4E62C,930,883.950AC91448-F4F6-4290-96B6-929828601408,900,883.950B3A56B0-C29F-421A-8271-9D1D08AC82E9,1350,883.95</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*sell::total = Sum ( sell«id»sellItem::item_subtotal )Select 子句和 Where 子句同時存在子查詢*/executeSql("  Select id, total, ( Select Avg(total) from sell )  From sell   Where total &gt; ( Select Avg(total) from sell )   Fetch First 10 Rows Only"; ""; "" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>001F6742-DC92-4156-870D-DC33B7B31CE5,1065,883.95010BEA0C-0138-4D5E-916F-B1B4C30168AD,1200,883.9501974791-1610-4B6F-A70C-D9558B7CFBE3,900,883.95023F713F-4D89-4B20-9778-86F0ACA43F90,1140,883.95045A9E71-A0B2-44CA-BF31-A54B96A25087,1140,883.9506D05363-B981-4652-B918-AFB0F0FB41A2,1455,883.9508A44C66-A9C9-4ECF-9FDA-E259BF4630F3,1845,883.9508D9B939-3118-425D-9F38-543D3CF4E62C,930,883.950AC91448-F4F6-4290-96B6-929828601408,900,883.950B3A56B0-C29F-421A-8271-9D1D08AC82E9,1350,883.95</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/* 只取得單一個業務的整個的業績 分別列出單據號碼的金額Group By clause 和 Order By 的 column 是對應的可以獲得正確的數據*/ExecuteSQL("  Select sellItem.idf, sum(sellItem.item_qty * sellItem.item_unitPrice)   From sellItem  Where sellItem.idf In ( Select sell.id From sell Where sell.salesRep = ?)  Group By sellItem.idf   Order By sellItem.idf   Fetch First 10 Rows Only  "; "",  "" ; "F1D30DC9-FF1E-4759-A3C8-919557AE3603" // 袁嘯)</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>0D13763D-4FCA-410B-B7A9-6F6B1BEF0B39,7200E4DA8E5-981B-4A48-B144-A2603041C0E4,13351120D2F7-F3C9-45CA-A982-ED665D21C2D9,60017768DDD-8AA0-4D20-B305-32AF3C7F1422,2551807E68A-EE34-443A-BEA4-49F04236CF34,7201EA2D8C2-4933-4E1C-B0A3-BB9A7A06FE2C,87024184517-1B0A-47D0-AD6C-73D6D3B47131,660248BEB1E-ADD4-422E-83EA-8DE887C50D89,115524EF8E7E-763A-4833-9E85-9F4D82CE979E,102025E8553A-1A8D-40C2-A725-06DFB49C89A5,1290</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/* 只取得單一個業務的整個的業績只取得一個數字*/ExecuteSQL ( "  Select sum(sellItem.item_qty * sellItem.item_unitPrice)   From sellItem  Where sellItem.idf in ( Select sell.id From sell Where sell.salesRep = ?)  "; "",  "" ; "F1D30DC9-FF1E-4759-A3C8-919557AE3603" // 袁嘯)</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>62040</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*找出銷售的金額大於單據平均金額的單據*/executeSql("  Select ( Select employee.name from employee Where employee.id = sell.salesRep ), sell.id, sell.total   From sell   Where sell.total &gt; ( Select Avg(sell.total) from sell )   Fetch First 10 Rows Only  "; ""; "" )/*以下是錯誤的計算式executeSql ( "Select   ( Select name from employee Where employee.id = sell.salesRep ), id, total  from sell Where id in   ( Select id From sell Where sell.total &gt; avg(sell.total)) Fetch First 10 Rows Only  "; ""; "" )*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>施既,001F6742-DC92-4156-870D-DC33B7B31CE5,1065蕭軻車,010BEA0C-0138-4D5E-916F-B1B4C30168AD,1200阮禍,01974791-1610-4B6F-A70C-D9558B7CFBE3,900施既,023F713F-4D89-4B20-9778-86F0ACA43F90,1140陳力增,045A9E71-A0B2-44CA-BF31-A54B96A25087,1140曹玄比,06D05363-B981-4652-B918-AFB0F0FB41A2,1455陳力增,08A44C66-A9C9-4ECF-9FDA-E259BF4630F3,1845蕭軻車,08D9B939-3118-425D-9F38-543D3CF4E62C,930曹玄比,0AC91448-F4F6-4290-96B6-929828601408,900蕭軻車,0B3A56B0-C29F-421A-8271-9D1D08AC82E9,1350</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*select 子句可以有多個 sub-query*/  executeSql(  "Select ( Select employee.name from employee Where employee.id = sell.salesRep ), id,     ( Select sum(sellItem.item_qty * sellItem.item_unitPrice) From SellItem Where sellItem.idf = sell.id )  From sell   Where total &gt; ( Select Avg(sell.total) from sell )   Fetch First 10 Rows Only  "; ""; "" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>施既,001F6742-DC92-4156-870D-DC33B7B31CE5,1065蕭軻車,010BEA0C-0138-4D5E-916F-B1B4C30168AD,1200阮禍,01974791-1610-4B6F-A70C-D9558B7CFBE3,900施既,023F713F-4D89-4B20-9778-86F0ACA43F90,1140陳力增,045A9E71-A0B2-44CA-BF31-A54B96A25087,1140曹玄比,06D05363-B981-4652-B918-AFB0F0FB41A2,1455陳力增,08A44C66-A9C9-4ECF-9FDA-E259BF4630F3,1845蕭軻車,08D9B939-3118-425D-9F38-543D3CF4E62C,930曹玄比,0AC91448-F4F6-4290-96B6-929828601408,900蕭軻車,0B3A56B0-C29F-421A-8271-9D1D08AC82E9,1350</pre></div>    <footer><p>update: 2022/06/20 14:56:24 by: Jeff</p><a class='repo' href='https://github.com/JSLiao/FileMaker-executeSql' target='_blank'>repository</a></footer>    <script></script>  </body></html>