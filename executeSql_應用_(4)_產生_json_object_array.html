<!DOCTYPE html><html lang='en'>  <head>    <meta charset='UTF-8' />    <meta aceVersion='v1.4.14' frameVersion='v1' />    <meta http-equiv='X-UA-Compatible' content='IE=edge' />    <meta name='viewport' content='width=device-width, initial-scale=1.0' />    <title>executeSql 應用 (4) 產生 json object array</title>    <style>:root {  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  font-size: 16px;  background-color: #111;  margin: 0;  padding: 0;  color: #eee;  hyphens: auto;--background_th: #333;}#main-subject {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  /* display:inline-block; */  position: fixed;  left: 6px;  top: 6px;  padding: 6px 3px;  align-content: flex-start;  text-decoration: none;  width: 97%;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 3px;}/* btn toEdit, tsToTc */#btn-toEdit, #btn-tsToTc {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 16px;  cursor:pointer;  align-content: flex-start;}/* btn toEdit */#btn-toEdit {  right: 6px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 32px;  position: fixed;}/* btn tsToTc */#btn-tsToTc {  right: 44px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 64px;  position: fixed;}#main-subject:hover,#btn-toEdit:hover,#btn-tsToTc:hover {  background-color: rgba(45, 45, 45, 0.9);  color: #c0edfe;}#main-subject:active,#btn-toEdit:active,#btn-tsToTc:active {  background-color: rgb(255, 145, 45);  color: #c0edfe;}.subNote {  right:20px;  text-align: right;  font-size: 0.9rem;  color: lightGray;}content {  color: lightgray;}p {  color: #ddd;  font-size: 1rem;  height: auto;  padding: 0rem;  margin-block-start: 0.5rem;  margin-block-end: 0.5rem;}hr {  color: #666;  height: 0.5px;}a {  border: none;  color: #ff5;  height: 100%;  text-decoration: none;}a:hover {  color: #fa3;}a:hover:after {  left: auto;  right: 0;  width: 100%;}a:active {  top: 2px;}/* table 样式 */table {  border-top: 1px solid #ccc;  border-left: 1px solid #ccc;}table td,table th {  border-bottom: 1px solid #ccc;  border-right: 1px solid #ccc;  padding: 3px 5px;}table th { background-color: var(--background_th) !important;  border-bottom: 2px solid #ccc;  text-align: center;}/* blockquote 样式 */blockquote {  display: block;  border-left: 5px solid #d0e5f2;  padding: 3px 5px;  margin: 6px 0;  line-height: 1.4;  font-size: 100%;  background-color: #f1f1f1;}/* code 样式 */code {  display: inline-block;  *display: inline;  *zoom: 1;  color: lightgray;  background-color: #fff3;  border-radius: 1px;  padding: 1px 3px;  margin: 0 1px;  font-size: 0.9rem;  font-family: monaco 'robot mono' mono !important;}pre code {  display: block;}/* ul ol 样式 */ul,ol {  margin-left: 8px;  padding-left:4px;  padding-right: 0;}li{  margin-left:0;  padding-left:0px;}ul li{  list-style-type: disc;}ol lit{  list-style-type: decimal;}.sectionTitle {  font-size: 1.2rem;}.preCodecontianer {  background-color: #fff1;}.cssDefault {  font-size: 0.9rem;  color: gray;  margin-left: 1rem;}footer {  text-align: right;  padding: 1px 12px;  margin:1px;  background-color: #8882;  color: lightgray;  bottom:8px;  right:24px;  position:fixed;  z-index: 1;}h1{  font-size:24px;}h2{  font-size:22px;}h3{  font-size:20px;}h4{  font-size:18px;}h5{  font-size:16px;}font[size='1']{  font-size:12px;  padding: 0.1em;  margin: 0.1em;}font[size='2']{  font-size:14px;  padding: 0.1em;  margin: 0.1em;}font[size='3']{  font-size:16px;  padding: 0.1em;  margin: 0.1em;}font[size='4']{  font-size:18px;  padding: 0.1em;  margin: 0.1em;}font[size='5']{  font-size:20px;  padding: 0.1em;  margin: 0.1em;}font[size='6']{  font-size:22px;  padding: 0.1em;  margin: 0.1em;}font[size='7']{  font-size:24px;  padding: 0.2em;}blockquote, blockquote p{  background:#0003 !important;}blockquote, blockquote p{  background:transparent !important;}/* width */::-webkit-scrollbar {width: 12px;}/* Track */::-webkit-scrollbar-track {background: #333;}/* Handle */::-webkit-scrollbar-thumb {background: #345;}/* Handle on hover */::-webkit-scrollbar-thumb:hover {background: #357;}</style>    <style>:root {  margin: 0;  padding: 0;  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  --background: #111;  --color: #ddd;  --font-size: 16px;  --background_th: #555;  --color-a: #ff5;  --color-a-hover: #fa3;  --background-blockquote: #00e9;  --font-size-code: 14px;  --background-code: #fff3;  background-color: var(--background);  color: var(--color);  font-size: var(--font-size);}.notesView{  background-color: #0308;  margin:0;  padding:8px 2px 8px 16px;}.codeView{  background-color: #0038;  margin:0;  padding:8px 2px 8px 16px;}.resultView{  background-color: #3008;  margin:0;  padding:8px 2px 8px 16px;}.code, .result{  font-family: monaco, monospace;  font-size:13px;  color:var(--color);}</style>  </head>  <body>    <!--完整檢視才顯示, begin-->    <div class='notesView'>      <p id='main-subject'>executeSql 應用 (4) 產生 json object array</p>      <br><br><div class='content'><p>/*</p><p>  purpose:</p><p>    用字串處理的方式把 executeSql 結果轉換成每一筆記錄的欄位是 jsonObject, 再組成&nbsp;<span style="color: var(--color); background-color: var(--background);">Array</span></p><p>  dependencies:</p><p>    cf_strByDiv ( _text; _div; _ifDivCase; _nth; _ifNoDivReturn )</p><p>  returns:</p><p>    json Array</p><p>    樣式如:</p><p>    [</p><p>{"fieldName1":"value1”,</p><p>"fieldName2":"value2”,</p><p>"fieldName3":"value3”,</p><p>"fieldName4":"value4”},</p><p>{</p><p>    {"fieldName1":"value1”,</p><p>"fieldName2":"value2”,</p><p>"fieldName3":"value3”,</p><p>"fieldName4":"value4"}]</p><p>*/</p></div>    </div>    <div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>While (   [    ///* sample data    _colSep = Char ( 41162 );     _rowSep = Char ( 41166 );     _colNames = List( getFieldName(contact::name);getFieldName(contact::nameEng);getFieldName(contact::addrCity);getFieldName(contact::telMobile));    _colNames = substitute( _colNames ; ["::"; "."];[ "¶";","]);    _tableName = getValue ( substitute (getFieldName(contact::name);"::";¶);1);    _sqlResult = ExecuteSQL("      SELECT " & _colNames &       " FROM " & _tableName &      " Fetch First 30 Rows Only"      ; _colSep ; _rowSep );    //*/    ~end = PatternCount ( _sqlResult ; _rowSep) + 1 ;    ~i = 1 ;    ~json = ""  ];  ~i &lt;= ~end ;  [    ~row = cf_strByDiv ( _sqlResult; _rowSep; 1; ~i; 1 );    ~rowJson =       While (        [          ~end = PatternCount ( ~row ; _colSep ) + 1 ;          ~i = 1 ;          ~perRow = ""        ];        ~i &lt;= ~end ;        [          ~name = GetValue ( _colNames ; ~i );          ~name = if ( patternCount(~name ; ".") &gt; 0 ; cf_strByDiv ( ~name; "."; 1; 2; 1 ) ; ~name);          ~value = cf_strByDiv ( ~row; _colSep; 1; ~i; 1 );          ~perRow = ~perRow & Quote ( ~name ) & ":" & Quote ( ~value ) & "," ;          ~i = ~i + 1        ];        "{" & Left ( ~perRow ; Length ( ~perRow) - 1 ) & "}"      );    ~json = ~json & ~rowJson & "," ;    ~i = ~i + 1  ];  //jsonFormatElements ("[" & Left ( ~json ; Length ( ~json)- 1 ) & "]" )  "[" & Left ( ~json ; Length ( ~json)- 1 ) & "]")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>[{"name,contact":"傅弱糠","":"Louis","":"台東縣","":"0919-647-721"},{"name,contact":"馬立無","":"Nicole","":"台中市","":"0927-604-462"},{"name,contact":"孫辰孤","":"Bing","":"澎湖縣","":"0979-220-064"},{"name,contact":"江寐","":"Bennett","":"宜蘭縣","":"0905-715-539"},{"name,contact":"高乃","":"Xanthe","":"苗栗縣","":"0978-480-007"},{"name,contact":"高翔分","":"Harriet","":"苗栗縣","":"0975-504-489"},{"name,contact":"范製","":"Clarence","":"嘉義市","":"0928-571-160"},{"name,contact":"黃天","":"Ellen","":"彰化縣","":"0949-306-688"},{"name,contact":"游僚並","":"Truda","":"屏東縣","":"0901-949-911"},{"name,contact":"游侈勸","":"Zenobia","":"澎湖縣","":"0931-734-439"},{"name,contact":"連陪","":"Quintina","":"雲林縣","":"0911-952-282"},{"name,contact":"楊郡基","":"Antoine","":"台南市","":"0961-667-746"},{"name,contact":"傅荒具","":"Eartha","":"台東縣","":"0994-864-489"},{"name,contact":"鍾男稼","":"Boyd","":"苗栗縣","":"0900-867-740"},{"name,contact":"張恥密","":"Lynn","":"新竹市","":"0994-610-024"},{"name,contact":"李邈忘","":"Elijah","":"新竹市","":"0963-113-399"},{"name,contact":"劉盟永","":"Bartholomew","":"桃園市","":"0963-574-447"},{"name,contact":"邵不","":"Cornelius","":"新北市","":"0973-668-860"},{"name,contact":"龔殊","":"Veronica","":"台南市","":"0923-081-130"},{"name,contact":"趙顛集","":"","":"台東縣","":"0968-615-574"},{"name,contact":"歐陽容","":"","":"新北市","":"0974-804-423"},{"name,contact":"宋非沙","":"Amanda","":"澎湖縣","":"0937-059-986"},{"name,contact":"湯殊","":"York","":"台東縣","":"0961-598-870"},{"name,contact":"廖吊","":"Angelo","":"台北市","":"0913-660-069"},{"name,contact":"吳滅曰","":"Tyrone","":"彰化縣","":"0942-927-753"},{"name,contact":"鄭雲周","":"Scott","":"嘉義市","":"0980-273-390"},{"name,contact":"林四畫","":"Archibald","":"嘉義市","":"0971-942-252"},{"name,contact":"歐困趙","":"Juliet","":"苗栗縣","":"0993-535-568"},{"name,contact":"高使隱","":"Regan","":"宜蘭縣","":"0942-115-587"},{"name,contact":"趙孝","":"Elizabeth","":"雲林縣","":"0975-583-319"}]</pre></div>    <footer><p>update: 2022/07/01 21:45:43 by: Jeff</p><a class='repo' href='https://github.com/JSLiao/FileMaker-executeSql' target='_blank'>repository</a></footer>    <script></script>  </body></html>