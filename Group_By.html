<!DOCTYPE html><html lang='en'>  <head>    <meta charset='UTF-8' />    <meta aceVersion='v1.4.14' frameVersion='v1' />    <meta http-equiv='X-UA-Compatible' content='IE=edge' />    <meta name='viewport' content='width=device-width, initial-scale=1.0' />    <title>Group By</title>    <style>:root {  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  font-size: 16px;  background-color: #111;  margin: 0;  padding: 0;  color: #eee;  hyphens: auto;--background_th: #333;}#main-subject {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  /* display:inline-block; */  position: fixed;  left: 6px;  top: 6px;  padding: 6px 3px;  align-content: flex-start;  text-decoration: none;  width: 97%;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 3px;}/* btn toEdit, tsToTc */#btn-toEdit, #btn-tsToTc {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 16px;  cursor:pointer;  align-content: flex-start;}/* btn toEdit */#btn-toEdit {  right: 6px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 32px;  position: fixed;}/* btn tsToTc */#btn-tsToTc {  right: 44px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 64px;  position: fixed;}#main-subject:hover,#btn-toEdit:hover,#btn-tsToTc:hover {  background-color: rgba(45, 45, 45, 0.9);  color: #c0edfe;}#main-subject:active,#btn-toEdit:active,#btn-tsToTc:active {  background-color: rgb(255, 145, 45);  color: #c0edfe;}.subNote {  right:20px;  text-align: right;  font-size: 0.9rem;  color: lightGray;}content {  color: lightgray;}p {  color: #ddd;  font-size: 1rem;  height: auto;  padding: 0rem;  margin-block-start: 0.5rem;  margin-block-end: 0.5rem;}hr {  color: #666;  height: 0.5px;}a {  border: none;  color: #ff5;  height: 100%;  text-decoration: none;}a:hover {  color: #fa3;}a:hover:after {  left: auto;  right: 0;  width: 100%;}a:active {  top: 2px;}/* table 样式 */table {  border-top: 1px solid #ccc;  border-left: 1px solid #ccc;}table td,table th {  border-bottom: 1px solid #ccc;  border-right: 1px solid #ccc;  padding: 3px 5px;}table th { background-color: var(--background_th) !important;  border-bottom: 2px solid #ccc;  text-align: center;}/* blockquote 样式 */blockquote {  display: block;  border-left: 5px solid #d0e5f2;  padding: 3px 5px;  margin: 6px 0;  line-height: 1.4;  font-size: 100%;  background-color: #f1f1f1;}/* code 样式 */code {  display: inline-block;  *display: inline;  *zoom: 1;  color: lightgray;  background-color: #fff3;  border-radius: 1px;  padding: 1px 3px;  margin: 0 1px;  font-size: 0.9rem;  font-family: monaco 'robot mono' mono !important;}pre code {  display: block;}/* ul ol 样式 */ul,ol {  margin-left: 8px;  padding-left:4px;  padding-right: 0;}li{  margin-left:0;  padding-left:0px;}ul li{  list-style-type: disc;}ol lit{  list-style-type: decimal;}.sectionTitle {  font-size: 1.2rem;}.preCodecontianer {  background-color: #fff1;}.cssDefault {  font-size: 0.9rem;  color: gray;  margin-left: 1rem;}footer {  text-align: right;  padding: 1px 12px;  margin:1px;  background-color: #8882;  color: lightgray;  bottom:8px;  right:24px;  position:fixed;  z-index: 1;}h1{  font-size:24px;}h2{  font-size:22px;}h3{  font-size:20px;}h4{  font-size:18px;}h5{  font-size:16px;}font[size='1']{  font-size:12px;  padding: 0.1em;  margin: 0.1em;}font[size='2']{  font-size:14px;  padding: 0.1em;  margin: 0.1em;}font[size='3']{  font-size:16px;  padding: 0.1em;  margin: 0.1em;}font[size='4']{  font-size:18px;  padding: 0.1em;  margin: 0.1em;}font[size='5']{  font-size:20px;  padding: 0.1em;  margin: 0.1em;}font[size='6']{  font-size:22px;  padding: 0.1em;  margin: 0.1em;}font[size='7']{  font-size:24px;  padding: 0.2em;}blockquote, blockquote p{  background:#0003 !important;}blockquote, blockquote p{  background:transparent !important;}/* width */::-webkit-scrollbar {width: 12px;}/* Track */::-webkit-scrollbar-track {background: #333;}/* Handle */::-webkit-scrollbar-thumb {background: #345;}/* Handle on hover */::-webkit-scrollbar-thumb:hover {background: #357;}</style>    <style>:root {  margin: 0;  padding: 0;  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  --background: #111;  --color: #ddd;  --font-size: 16px;  --background_th: #555;  --color-a: #ff5;  --color-a-hover: #fa3;  --background-blockquote: #00e9;  --font-size-code: 14px;  --background-code: #fff3;  background-color: var(--background);  color: var(--color);  font-size: var(--font-size);}.notesView{  background-color: #0308;  margin:0;  padding:8px 2px 8px 16px;}.codeView{  background-color: #0038;  margin:0;  padding:8px 2px 8px 16px;}.resultView{  background-color: #3008;  margin:0;  padding:8px 2px 8px 16px;}.code, .result{  font-family: monaco, monospace;  font-size:13px;  color:var(--color);}</style>  </head>  <body>    <!--完整檢視才顯示, begin-->    <div class='notesView'>      <p id='main-subject'>Group By</p>      <br><br><div class='content'><p>Group By 經常 Min，Max，Avg，Sum&nbsp;或count&nbsp;等聚合函式結合使用，以計算為每個分組的資訊</p><p>在 Select 子句中如果有聚合函式, 則在Select &nbsp;子句中不在聚合函數的 columnName 必須在&nbsp;<span style="color: var(--color); background-color: var(--background); font-size: var(--font-size);">Group By</span><span style="color: var(--color); background-color: var(--background); font-size: var(--font-size);">&nbsp;</span><span style="color: var(--color); background-color: var(--background);">子句加以指定</span></p><p>Group By 子句中的 columnName 不一定要在 Select 子句中</p><p>產生整合的資料:</p><p>Where 子句在 Group By 之前使用 ; 換言之, Where&nbsp;<span style="color: var(--color); background-color: var(--background); font-size: var(--font-size);">子句</span>對應於<span style="color: var(--color); background-color: var(--background); font-size: var(--font-size);">&nbsp;Select</span></p><p>Having 子句在 Group By 之後使用 ; 換言之, Having 子句對應於 Group By<br/></p><p>Group By 子句產生分組列。 如果分組列包含Null值，則所有 Null 值都匯總到一個分組中，因為 Group By 子句認為Null值相等。</p><p>如果有 Group By 子句, 結果會自動以 Group By 子句的 column 升冪排列, 如果要改變排列順序可以用 Order By 子句</p><p>Group By 如果沒有使用 Aggregate function 則和用 Distinct 類似;&nbsp;</p><p>Group By 是依據 Group By 子句中的 columnName 排序的,&nbsp;<span style="color: var(--color); background-color: var(--background);">而 Distinct 則是看 Select 中 columnName 的順序</span></p><p>如果有 Order By 子句, 則依 Order By 的順序</p><p>Group By 子句不可以和 Fetch First 或 Offset 子句一起使用<br/></p><hr/><p><span style="color: var(--color); background-color: var(--background);">經驗上</span><br/></p><p>如果 executeSql 包含 Group By 和 聚合函數, 可使用 let 或 while 函數把 group &nbsp;和聚合函數拆解成簡單的個別運算, 再組合成計算結果, 加以<span style="color: var(--color); background-color: var(--background);">評估何者會取得較好的計算效率</span></p></div>    </div>    <div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/* 計算新北市英文名字的統計, 先排女男, 再排名字在 Select 子句中如果有聚合函式, 則在Select  子句中不在聚合函數的 columnName 必須在 Group By 子句加以指定Group By 子句中的 columnName 不一定要在 Select 子句中*/executeSql("  SELECT nameEng,COUNT (name)   FROM contact   WHERE addrCity = ?   GROUP BY gender,nameEng   Fetch First 10 Row Only  " ; "  "; "" ; "新北市")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>Ada  2Adela  1Adelaide  3Agatha  1Alexia  1Alma  2Althea  2Alva  3Amanda  1Amelia  1</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/* 各縣市人口數的統計*/executeSql("  Select addrCity, Count (id)  FROM contact   Group BY addrCity  " ; "  "; "" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>南投縣  1422台中市  1433台北市  1401台南市  1443台東縣  1434嘉義市  1349嘉義縣  1464基隆市  1439宜蘭縣  1366屏東縣  1357彰化縣  1377新北市  1385新竹市  1375新竹縣  1457桃園市  1361澎湖縣  1449花蓮縣  1382苗栗縣  1434連江縣  1406金門縣  1449雲林縣  1452高雄市  665</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*列出每張銷售單的銷售金額*/executeSql("Select  'sell #: ', idf, ' sum: ', Sum(item_qty * item_unitPrice) From sellItem Group By idf Fetch First 10 Rows Only" ; "" ; "")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>sell #: ,001F6742-DC92-4156-870D-DC33B7B31CE5, sum: ,1065sell #: ,0086FB00-1928-43EB-B36C-82235452D169, sum: ,585sell #: ,010BEA0C-0138-4D5E-916F-B1B4C30168AD, sum: ,1200sell #: ,01974791-1610-4B6F-A70C-D9558B7CFBE3, sum: ,900sell #: ,023F713F-4D89-4B20-9778-86F0ACA43F90, sum: ,1140sell #: ,02BB6B13-55B1-426F-84C1-6A1C7A3CC5FD, sum: ,795sell #: ,02C1414A-93F8-4F45-8ADF-7525D934E077, sum: ,315sell #: ,04038AC1-B12B-4940-80DA-F7592868306F, sum: ,585sell #: ,045A9E71-A0B2-44CA-BF31-A54B96A25087, sum: ,1140sell #: ,0466C63B-CA20-4704-BBB8-C64259ABF769, sum: ,495</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*Group By 不可以使用引數 “?”*/executeSql("Select  'sell #: ', idf, ' sum: ', Sum(item_qty * item_unitPrice) From sellItem Group By ?" ; "" ; "" ; "idf")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>?</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/* 列出每日的銷售業績2.178 sec使用 Join 子句*/ExecuteSQL("Select sell.dateSell, sum(sellItem.item_qty * sellItem.item_unitPrice)From sellItemJoin sell on sell.id = sellItem.idfGroup By sell.dateSell";"";"")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>2022-01-02,20702022-01-03,63152022-01-04,45152022-01-05,46802022-01-06,19802022-01-07,20552022-01-08,48602022-01-09,13802022-01-10,59252022-01-11,52352022-01-12,26552022-01-13,22652022-01-14,56402022-01-15,36752022-01-16,53402022-01-17,48602022-01-18,70202022-01-19,54752022-01-20,63002022-01-21,81152022-01-22,47102022-01-23,17552022-01-24,61352022-01-25,33452022-01-26,39152022-01-27,96152022-01-28,13352022-01-29,84152022-01-30,38852022-01-31,9902022-02-01,27152022-02-02,79352022-02-03,39602022-02-04,85802022-02-05,42002022-02-06,92402022-02-07,35102022-02-08,51602022-02-09,49052022-02-10,41102022-02-11,59852022-02-12,34352022-02-13,74402022-02-14,64052022-02-15,83552022-02-16,45002022-02-17,60302022-02-18,120752022-02-19,45602022-02-20,30752022-02-21,43802022-02-22,103202022-02-23,46802022-02-24,88052022-02-25,39752022-02-26,51452022-02-27,27752022-02-28,65552022-03-01,48752022-03-02,40802022-03-03,75152022-03-04,9902022-03-05,27602022-03-06,65852022-03-07,11402022-03-08,55652022-03-09,65702022-03-10,30602022-03-11,28652022-03-12,64802022-03-13,28502022-03-14,33452022-03-15,9752022-03-16,69452022-03-17,33902022-03-18,71102022-03-19,70652022-03-20,13502022-03-21,46502022-03-22,23852022-03-23,70052022-03-24,75152022-03-25,84452022-03-26,53552022-03-27,98102022-03-28,54302022-03-29,22652022-03-30,6330</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/* 列出每日的銷售業績, 另一種寫法2.175 sec使用 Where 子句*/ExecuteSQL("Select sell.dateSell, sum(sellItem.item_qty * sellItem.item_unitPrice)From sellItem, sellWhere sell.id = sellItem.idfGroup By sell.dateSell";"";"")/*以下寫法會發生錯誤可以用 debug 的技巧, 找出錯誤在哪裡ExecuteSQL("Select sell.dateSell, sum(sellItem.item_qty * sellItem.item_unitPrice)From sellItemWhere sell.id = sellItem.idfGroup By sell.dateSell";"";"")*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>2022-01-02,20702022-01-03,63152022-01-04,45152022-01-05,46802022-01-06,19802022-01-07,20552022-01-08,48602022-01-09,13802022-01-10,59252022-01-11,52352022-01-12,26552022-01-13,22652022-01-14,56402022-01-15,36752022-01-16,53402022-01-17,48602022-01-18,70202022-01-19,54752022-01-20,63002022-01-21,81152022-01-22,47102022-01-23,17552022-01-24,61352022-01-25,33452022-01-26,39152022-01-27,96152022-01-28,13352022-01-29,84152022-01-30,38852022-01-31,9902022-02-01,27152022-02-02,79352022-02-03,39602022-02-04,85802022-02-05,42002022-02-06,92402022-02-07,35102022-02-08,51602022-02-09,49052022-02-10,41102022-02-11,59852022-02-12,34352022-02-13,74402022-02-14,64052022-02-15,83552022-02-16,45002022-02-17,60302022-02-18,120752022-02-19,45602022-02-20,30752022-02-21,43802022-02-22,103202022-02-23,46802022-02-24,88052022-02-25,39752022-02-26,51452022-02-27,27752022-02-28,65552022-03-01,48752022-03-02,40802022-03-03,75152022-03-04,9902022-03-05,27602022-03-06,65852022-03-07,11402022-03-08,55652022-03-09,65702022-03-10,30602022-03-11,28652022-03-12,64802022-03-13,28502022-03-14,33452022-03-15,9752022-03-16,69452022-03-17,33902022-03-18,71102022-03-19,70652022-03-20,13502022-03-21,46502022-03-22,23852022-03-23,70052022-03-24,75152022-03-25,84452022-03-26,53552022-03-27,98102022-03-28,54302022-03-29,22652022-03-30,6330</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/* 列出每日的銷售業績0.132 sec如果 executeSql 包含 Group By 和 聚合函數, 可使用 let 或 while 函數把 group  和聚合函數拆解成簡單的個別運算, 再組合成計算結果, 加以評估何者會取得較好的計算效率*/while (  [    ~dateList = executeSql("Select Distinct sell.dateSell From Sell Order By sell.dateSell"; ""; "");    ~end = valueCount ( ~dateList );    ~i = 1 ;    ~result = ""   ];  ~i &lt;= ~end ;  [    ~date = getValue ( ~dateList ; ~i );    ~idfList = executeSql ("Select id From Sell Where dateSell = ?"; "" ; "" ; ~date);    ~idfList = "('" & substitute  (~idfList ; ¶ ; "','" ) & "')";    ~sellPerDay = executeSql ( "Select sum(sellItem.item_qty * sellItem.item_unitPrice) From SellItem Where idf in" & ~idfList ; ""; "" );    ~result = list ( ~result ; ~date & "," & ~sellPerDay);    ~i = ~i + 1  ];  ~result)</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>2022-01-02,20702022-01-03,63152022-01-04,45152022-01-05,46802022-01-06,19802022-01-07,20552022-01-08,48602022-01-09,13802022-01-10,59252022-01-11,52352022-01-12,26552022-01-13,22652022-01-14,56402022-01-15,36752022-01-16,53402022-01-17,48602022-01-18,70202022-01-19,54752022-01-20,63002022-01-21,81152022-01-22,47102022-01-23,17552022-01-24,61352022-01-25,33452022-01-26,39152022-01-27,96152022-01-28,13352022-01-29,84152022-01-30,38852022-01-31,9902022-02-01,27152022-02-02,79352022-02-03,39602022-02-04,85802022-02-05,42002022-02-06,92402022-02-07,35102022-02-08,51602022-02-09,49052022-02-10,41102022-02-11,59852022-02-12,34352022-02-13,74402022-02-14,64052022-02-15,83552022-02-16,45002022-02-17,60302022-02-18,120752022-02-19,45602022-02-20,30752022-02-21,43802022-02-22,103202022-02-23,46802022-02-24,88052022-02-25,39752022-02-26,51452022-02-27,27752022-02-28,65552022-03-01,48752022-03-02,40802022-03-03,75152022-03-04,9902022-03-05,27602022-03-06,65852022-03-07,11402022-03-08,55652022-03-09,65702022-03-10,30602022-03-11,28652022-03-12,64802022-03-13,28502022-03-14,33452022-03-15,9752022-03-16,69452022-03-17,33902022-03-18,71102022-03-19,70652022-03-20,13502022-03-21,46502022-03-22,23852022-03-23,70052022-03-24,75152022-03-25,84452022-03-26,53552022-03-27,98102022-03-28,54302022-03-29,22652022-03-30,6330</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*計算每個商品的業績, 並依照業績排序(由高到低)使用 Alias 縮短計算式, 更語意化*/ExecuteSQL("Select product.name, sum(sellItem.item_qty * sellItem.item_unitPrice) As revenueFrom sellItemJoin product On product.id = sellItem.item_idGroup By product.nameOrder By revenue Desc";"";"")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>魚片粥,10650帶子腸粉,9240芝麻卷,8100壽包,7695柱侯金錢肚,7560番薯糖水,7470楊枝甘露,7440小蛋撻,7320牛肉燒賣,7035蘿蔔糕,7035炒河粉,7020鹹甜粿,6960鹼水粽,6960芋頭糕,6960黑米腸粉,6840鴨腳扎,6825鮮蝦腸粉,6720雲吞,6615蓮蓉水晶包,6510叉燒酥,6480淮山雞扎,6480千層糕 椰汁千層糕,6360豆沙水晶包,6195甜薄撐,6195椰黃包,6120艇仔粥,6120山竹牛肉,6120蓮蓉包,5985潮州粉粿,5985姜蔥牛百葉,5880幹蒸燒賣,5880鮮蝦粉粿,5850紅豆沙,5805豆沙包,5775豬肝粥,5670鮑汁鳳爪,5475鮮肉包,5460羅漢齋腸,5400春捲,5355白粥,5355奶皇包,5145麻香拌海蜇,5040菠蘿包,5040小籠包,5040椰蓉包,5025皮蛋瘦肉粥,4950銀絲捲,4950珍珠雞,4875牛肉腸粉,4830糯米卷,4830魚肉燒賣,4770蝦餃,4725廣東炒麵,4680齋菜粉粿,4590花捲,4575韭菜雞蛋餃,4560甜豆腐花,4500鹹水角,4500胡椒豬肚,4305豬肚燒賣,4305雞仔餅,4200叉燒腸粉,4200豉汁蒸排骨,4140豉汁蒸鳳爪,4050馬蹄糕,3975及第粥,3750馬豆糕,3600叉燒包,3420灌湯餃,3360糯米雞,3300馬拉糕,3300黃沙豬潤燒賣,3240梅子蒸排骨,3075蒜茸蒸魷魚,3060鵪鶉蛋燒賣,3060鹹肉粽,3060蘿蔔絲酥餅,2940芒果布甸,2940芝麻糊,2835雞絲粉卷,2565菜肉包,2565腐皮卷,2520年糕,2340生煎包,2250油炸小饅頭,2070蒜蓉炒鮮魷,2025</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/* 列出每日的銷售業績2.178 sec使用 Join 子句只列出 2022年 3月的業績*/ExecuteSQL("Select sell.dateSell, sum(sellItem.item_qty * sellItem.item_unitPrice)From sellItemJoin sell on sell.id = sellItem.idfGroup By sell.dateSellHaving Year(sell.dateSell) = 2022 And Month (sell.dateSell) = 3";"";"")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>2022-03-01,48752022-03-02,40802022-03-03,75152022-03-04,9902022-03-05,27602022-03-06,65852022-03-07,11402022-03-08,55652022-03-09,65702022-03-10,30602022-03-11,28652022-03-12,64802022-03-13,28502022-03-14,33452022-03-15,9752022-03-16,69452022-03-17,33902022-03-18,71102022-03-19,70652022-03-20,13502022-03-21,46502022-03-22,23852022-03-23,70052022-03-24,75152022-03-25,84452022-03-26,53552022-03-27,98102022-03-28,54302022-03-29,22652022-03-30,6330</pre></div>    <footer><p>update: 2022/06/22 18:55:03 by: Jeff</p><a class='repo' href='https://github.com/JSLiao/FileMaker-executeSql' target='_blank'>repository</a></footer>    <script></script>  </body></html>