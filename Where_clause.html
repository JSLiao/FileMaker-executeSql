<!DOCTYPE html><html lang='en'>  <head>    <meta charset='UTF-8' />    <meta aceVersion='v1.4.14' frameVersion='v1' />    <meta http-equiv='X-UA-Compatible' content='IE=edge' />    <meta name='viewport' content='width=device-width, initial-scale=1.0' />    <title>Where clause</title>    <style>:root {  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  font-size: 16px;  background-color: #111;  margin: 0;  padding: 0;  color: #eee;  hyphens: auto;--background_th: #333;}#main-subject {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  /* display:inline-block; */  position: fixed;  left: 6px;  top: 6px;  padding: 6px 3px;  align-content: flex-start;  text-decoration: none;  width: 97%;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 3px;}/* btn toEdit, tsToTc */#btn-toEdit, #btn-tsToTc {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 16px;  cursor:pointer;  align-content: flex-start;}/* btn toEdit */#btn-toEdit {  right: 6px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 32px;  position: fixed;}/* btn tsToTc */#btn-tsToTc {  right: 44px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 64px;  position: fixed;}#main-subject:hover,#btn-toEdit:hover,#btn-tsToTc:hover {  background-color: rgba(45, 45, 45, 0.9);  color: #c0edfe;}#main-subject:active,#btn-toEdit:active,#btn-tsToTc:active {  background-color: rgb(255, 145, 45);  color: #c0edfe;}.subNote {  right:20px;  text-align: right;  font-size: 0.9rem;  color: lightGray;}content {  color: lightgray;}p {  color: #ddd;  font-size: 1rem;  height: auto;  padding: 0rem;  margin-block-start: 0.5rem;  margin-block-end: 0.5rem;}hr {  color: #666;  height: 0.5px;}a {  border: none;  color: #ff5;  height: 100%;  text-decoration: none;}a:hover {  color: #fa3;}a:hover:after {  left: auto;  right: 0;  width: 100%;}a:active {  top: 2px;}/* table 样式 */table {  border-top: 1px solid #ccc;  border-left: 1px solid #ccc;}table td,table th {  border-bottom: 1px solid #ccc;  border-right: 1px solid #ccc;  padding: 3px 5px;}table th { background-color: var(--background_th) !important;  border-bottom: 2px solid #ccc;  text-align: center;}/* blockquote 样式 */blockquote {  display: block;  border-left: 5px solid #d0e5f2;  padding: 3px 5px;  margin: 6px 0;  line-height: 1.4;  font-size: 100%;  background-color: #f1f1f1;}/* code 样式 */code {  display: inline-block;  *display: inline;  *zoom: 1;  color: lightgray;  background-color: #fff3;  border-radius: 1px;  padding: 1px 3px;  margin: 0 1px;  font-size: 0.9rem;  font-family: monaco 'robot mono' mono !important;}pre code {  display: block;}/* ul ol 样式 */ul,ol {  margin-left: 8px;  padding-left:4px;  padding-right: 0;}li{  margin-left:0;  padding-left:0px;}ul li{  list-style-type: disc;}ol lit{  list-style-type: decimal;}.sectionTitle {  font-size: 1.2rem;}.preCodecontianer {  background-color: #fff1;}.cssDefault {  font-size: 0.9rem;  color: gray;  margin-left: 1rem;}footer {  text-align: right;  padding: 1px 12px;  margin:1px;  background-color: #8882;  color: lightgray;  bottom:8px;  right:24px;  position:fixed;  z-index: 1;}h1{  font-size:24px;}h2{  font-size:22px;}h3{  font-size:20px;}h4{  font-size:18px;}h5{  font-size:16px;}font[size='1']{  font-size:12px;  padding: 0.1em;  margin: 0.1em;}font[size='2']{  font-size:14px;  padding: 0.1em;  margin: 0.1em;}font[size='3']{  font-size:16px;  padding: 0.1em;  margin: 0.1em;}font[size='4']{  font-size:18px;  padding: 0.1em;  margin: 0.1em;}font[size='5']{  font-size:20px;  padding: 0.1em;  margin: 0.1em;}font[size='6']{  font-size:22px;  padding: 0.1em;  margin: 0.1em;}font[size='7']{  font-size:24px;  padding: 0.2em;}blockquote, blockquote p{  background:#0003 !important;}blockquote, blockquote p{  background:transparent !important;}/* width */::-webkit-scrollbar {width: 12px;}/* Track */::-webkit-scrollbar-track {background: #333;}/* Handle */::-webkit-scrollbar-thumb {background: #345;}/* Handle on hover */::-webkit-scrollbar-thumb:hover {background: #357;}</style>    <style>:root {  margin: 0;  padding: 0;  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  --background: #111;  --color: #ddd;  --font-size: 16px;  --background_th: #555;  --color-a: #ff5;  --color-a-hover: #fa3;  --background-blockquote: #00e9;  --font-size-code: 14px;  --background-code: #fff3;  background-color: var(--background);  color: var(--color);  font-size: var(--font-size);}.notesView{  background-color: #0308;  margin:0;  padding:8px 2px 8px 16px;}.codeView{  background-color: #0038;  margin:0;  padding:8px 2px 8px 16px;}.resultView{  background-color: #3008;  margin:0;  padding:8px 2px 8px 16px;}.code, .result{  font-family: monaco, monospace;  font-size:13px;  color:var(--color);}</style>  </head>  <body>    <!--完整檢視才顯示, begin-->    <div class='notesView'>      <p id='main-subject'>Where clause</p>      <br><br><div class='content'><p>Select 查詢語句使用 Where 關鍵字搭配運算子來取出 "符合條件" 的紀錄值。<br/></p><p>語法 ( cS: column separator, rS: row separator)</p><pre><code>executeSql("</code><code>Select fieldName1, fieldName2…</code><code>From tableName
Where fieldName operator value</code><code>" ; cS ; rS )</code></pre><p>使用引數</p><code><font face="Monaco">executeSql(</font></code><font face="Monaco"><span style="font-size: 14px;">“</span></font><div><code><font face="Monaco">Select fieldName1, fieldName2…&nbsp;</font></code></div><div><code><font face="Monaco">From tableName&nbsp;</font></code></div><div><code><font face="Monaco">Where fieldName operator ?</font></code></div><div><code><font face="Monaco">" ; cS ; rS ; argument )</font></code><p><font color="#f9963b">不可以使用 FileMaker 的特殊符號如: ≤, ≥, ≠<br/></font></p><p><font color="#f9963b">value 和 argument 的值區分大小寫</font></p><p><font color="#f9963b">"?" 和 argument 存在順序的對應關係, 額外的 argument 會被忽略</font></p><p><font color="#f9963b">operator:</font></p><p><font color="#f9963b">&nbsp; &gt; :&nbsp;<span style="background-color: var(--background); font-size: var(--font-size);">大於</span></font></p><p><font color="#f9963b">&nbsp; &lt; :&nbsp;<span style="background-color: var(--background); font-size: var(--font-size);">小於</span></font></p><p><font color="#f9963b">&nbsp; = :&nbsp;<span style="background-color: var(--background); font-size: var(--font-size);">等於</span></font></p><p><font color="#f9963b"><span style="background-color: var(--background); font-size: var(--font-size);">&nbsp; &nbsp;</span><span style="background-color: var(--background);">&gt;= : 大於或等於</span></font></p><p><font color="#f9963b"><span style="background-color: var(--background); font-size: var(--font-size);">&nbsp; &nbsp;</span><span style="background-color: var(--background);">&lt;= : 小於或等於</span></font></p><p><font color="#f9963b"><span style="background-color: var(--background); font-size: var(--font-size);">&nbsp; &nbsp;</span><span style="background-color: var(--background);">&lt;&gt; : 不等於</span></font></p><p><font color="#f9963b">&nbsp; &nbsp;!= : 不等於</font></p><p><font color="#f9963b">&nbsp; &nbsp;% : 任意長度的任意字元(包括零長度)</font></p><p><span style="color: rgb(249, 150, 59); background-color: var(--background);">&nbsp; &nbsp;_ : 下底線, 表示一個任意字元</span></p><p><span style="color: rgb(249, 150, 59); background-color: var(--background);">&nbsp; Is : 表示相等於</span></p><p><font color="#f9963b">&nbsp; Like : 符合字串樣式</font></p><p><font color="#f9963b">&nbsp; Null : Is Null 也可以寫成 = Null ;&nbsp;</font><span style="background-color: var(--background); font-size: var(--font-size);"><font color="#f9963b">Is Not Null 也可以寫成 &lt;&gt; Null 或 != Nul</font></span><span style="background-color: var(--background); font-size: var(--font-size);"><font color="#f9963b">l</font></span></p><p><font color="#f9963b">&nbsp; In : 於清單內</font></p><p><font color="#f9963b">&nbsp; Exist</font></p><p><font color="#f9963b">&nbsp; All</font></p><p><font color="#f9963b">&nbsp; Any</font></p><p><font color="#f9963b">&nbsp;&nbsp;</font><span style="color: var(--color); background-color: var(--background); font-size: var(--font-size);">= Any 相當於 In 的敘述</span></p><p><font color="#f9963b">&nbsp; Not : 非</font></p><p><font color="#f9963b">&nbsp;&nbsp;</font><span style="color: var(--color); background-color: var(--background);">Not Like 是 Like 的相反運算,&nbsp;</span><span style="color: var(--color); background-color: var(--background);">Not In&nbsp;是 In 的相反運算,&nbsp;</span><span style="color: var(--color); background-color: var(--background);">Not Between 是 Between 的相反運算</span></p><p>&nbsp; <font color="#f9963b">And :</font></p><p><font color="#f9963b">&nbsp; Or :</font></p><h4>&nbsp; Where 多個條件式: 可以使用&nbsp;<code>And</code>&nbsp;或&nbsp;<code>Or</code>&nbsp;運算子同時下達多個條件</h4><p><font color="#f9963b">argument 可使用常數, 變數,欄位,或 運算式</font></p><p><font color="#f9963b">字串常數如果放在敘述中要用單引號括起來</font></p><p><font color="#f9963b"><span style="caret-color: rgb(249, 150, 59);">如果要檢查欄位是否有資料或者是空的, 使用 Is Null 或者 Is Not Null, 不要用引數</span></font></p><hr/><h4><p>And 和 Or</p><p><code>expression_1 AND expression_2</code><br/></p><p><code>expression_1 OR expression_2</code><br/></p><p>且, 或 的運算</p><p>可以用括號來調整優先順序</p></h4><div><hr/><p><span style="color: rgb(77, 128, 191); background-color: var(--background);">Null, Not Null</span></p></div><p><font size="2"><code>NULL</code>在SQL中很特殊。&nbsp;<code>NULL</code>表示資料未知的值，可以簡單理解為表示：<em>不適用</em>&nbsp;或<em>不存在</em>的值。 換句話說，<code>NULL</code>表示資料庫中缺少資料。</font></p><p><font size="2">例如，如果員工沒有任何電話號碼，可以將其儲存為空字串。 但是，如果在插入員工記錄時不知道他的電話號碼，我們將使用未知電話號碼的<code>NULL</code>值。</font></p><h4><font size="2"><code>NULL</code><span style="color: var(--color); background-color: var(--background);">值是特殊的，因為任何與</span><code>NULL</code><span style="color: var(--color); background-color: var(--background);">值的比較都不會導致</span><code>true</code><span style="color: var(--color); background-color: var(--background);">或</span><code>false</code><span style="color: var(--color); background-color: var(--background);">，但在第三個邏輯結果中：</span><em style="color: var(--color);">未知</em><span style="color: var(--color); background-color: var(--background);">。</span></font></h4><h4><span style="color: var(--color); background-color: var(--background);">Sql 的 Null 不等於 FileMaker 的 ””, &nbsp;</span><br/></h4><p>如果要用 executeSql 檢查欄位內是否有資料, 用 Is Null 和 Is Not Null</p><p>如果用 argument 很有可能會出錯</p><p><code>expression IS [Not] NULL</code></p><p>例如&nbsp;</p><p>FileMaker 取空字串的長度會取得 0<br/></p><p>executeSql 取空字串的長度, 是取不到資料 ;&nbsp;</p><hr/><p><span style="background-color: var(--background);"><font color="#4d80bf">Between, Not Between</font></span></p><p><span style="color: var(--color); background-color: var(--background);">是依某範圍內連續的值作為條件來搜尋資料表中的特定資料。</span><br/></p><p>作為查詢範圍條件的欄位型態可為數值、日期或字串，其中字串是依照字母排列順序來界定範圍。</p><p>Between 範圍包括 lowValue 和 highValue<br/></p><p>Not Between 範圍不包括 lowValue 和 highValue<br/></p><p>語法<br/></p><pre><code>expression [Not] BETWEEN lowValue AND highValue</code></pre><hr/><p><font color="#4d80bf">In, Not In&nbsp;</font></p><p>可以用來限定符合某些欄位值為列表中的資料<br/></p><p>field: 在 sql 被稱為 column</p><p>record:&nbsp;在 sql 常被稱為 row</p><p>在實際使用中也常被混用</p><p>語法<br/></p><p><code>expression [Not] IN (value1,value2,…)</code><br/></p><pre><code>expression [Not] IN (sub- query)</code></pre><div><hr/><p><font face="monospace" color="#4d80bf"><span style="font-size: 14px; background-color: rgba(255, 255, 255, 0.2);">Any</span></font></p><p>運算子是一個邏輯運算子，它將值與子查詢返回的一組值進行比較。&nbsp;<code>ANY</code>運算子必須以比較運算子：<code>&gt;</code>，<code>&gt;=</code>，<code>&lt;</code>，<code>&lt;=</code>，<code>=</code>，<code>&lt;&gt;</code>開頭，後跟子查詢。<br/></p><p><code>columnName operator ANY ( sub-query )</code><br/></p><p>如果子查詢不返回任何行，則條件的計算結果為<code>false</code>。&nbsp;</p><p>假設子查詢不返回零行，下面說明<code>ANY</code>運算子與比較運算子一起使用時的含義：<br/></p><table><thead><tr><th>條件</th><th>表示含義</th></tr></thead><tbody><tr><td><code>x = ANY (…)</code></td><td>欄位的值與子查詢結果中任一個值匹配，評估為<code>true</code>。</td></tr><tr><td><code>x != ANY (…)</code></td><td>欄位值不與子查詢結果中任一個值匹配以評估為<code>true</code>。</td></tr><tr><td><code>x &gt; ANY (…)</code></td><td>欄位的值大於子查詢結果中的最小值。</td></tr><tr><td><code>x &lt; ANY (…)</code></td><td>欄位的值小於子查詢結果中的最大值。</td></tr><tr><td><code>x &gt;= ANY (…)</code></td><td>欄位的值大於或等於子查詢結果中的最小值。</td></tr><tr><td><code>x &lt;= ANY (…)</code></td><td>欄位的值小於或等於子查詢結果合中的最大值。</td></tr></tbody></table><hr/><p><font color="#4d80bf">All</font></p><p>邏輯運算子，它將單個值與子查詢返回的單列值集進行比較。<br/></p><pre><code>column_name comparison_operator ALL (subquery)</code></pre>運算子是一個邏輯運算子，它將值與子查詢返回的一組值進行比較。&nbsp;<code>ANY</code>運算子必須以比較運算子：<code>&gt;</code>，<code>&gt;=</code>，<code>&lt;</code>，<code>&lt;=</code>，<code>=</code>，<code>&lt;&gt;</code>開頭，後跟子查詢。<br/><p>如果子查詢不返回任何行，則條件的計算結果為<font face="monospace"><span style="font-size: 14px; background-color: rgba(255, 255, 255, 0.2);">true</span></font>。&nbsp;</p><p>假設子查詢不返回零行，下面說明<code>ALL</code>運算子與比較運算子一起使用時的含義：</p><table><thead><tr><th>條件</th><th>描述</th></tr></thead><tbody><tr><td><code>c &gt; ALL(…)</code></td><td>欄位的值必須大於要評估為<code>true</code>的集合中的最大值。</td></tr><tr><td><code>c &gt;= ALL(…)</code></td><td>欄位的值必須大於或等於要評估為<code>true</code>的集合中的最大值。</td></tr><tr><td><code>c &lt; ALL(…)</code></td><td>欄位的值必須小於要評估為<code>true</code>的集合中的最小值。</td></tr><tr><td><code>c &lt;= ALL(…)</code></td><td>欄位的值必須小於或等於要評估為<code>true</code>的集合中的最小值。</td></tr><tr><td><code>c &lt;&gt; ALL(…)</code></td><td>欄位的值不得等於要評估為<code>true</code>的集合中的任何值。</td></tr><tr><td><code>c = ALL(…)</code></td><td>欄位的值必須等於要評估為<code>true</code>的集合中的任何值。</td></tr></tbody></table><hr/><p><font color="#4d80bf">Exists, Not&nbsp;<span style="background-color: var(--background); font-size: var(--font-size);">Exists</span></font></p><p>檢查指定子查詢結果的存在<span style="color: var(--color); background-color: var(--background);"><br/></span></p><p>只檢查結果的 column 是不是存在, 不會去檢查取得的 column 的值是不是 Null</p><pre><code>[Not] EXISTS (sub-query)
</code></pre><div><hr/><p><font color="#4d80bf">Like</font></p><p>模式匹配<br/></p><p>%: &nbsp;任意長度的任意字元(包括零長度)</p></div><div>_: 下底線, 表示一個任意字元<br/></div><div>匹配萬用字元<code>%</code>或<code>_</code>，則必須使用反斜槓字元<code>\</code>來對其 escape。<br/></div><div><pre><code>expression [Not] LIKE pattern</code></pre></div>如 contact.name Like ‘%dam%'<br/><hr/><p>其他</p><p><span style="color: var(--color); background-color: var(--background);">如果可以直些寫成 where 的條件, 則為第一優先</span><br/></p><p>如果不行, 還可以利用 join, 子查詢 或者用 Let 函數寫成數個計算段落</p></div><p>用 Let 函數組合 sqlQuery 敘述的可能是因為<br/></p><p>模組化</p><p>custom function</p><p>sqlQuery 敘述太長, 太複雜<br/></p><p>達成 executeSql 不好處理或不能做的事</p><p>維護方便</p><hr/><p><br/></p></div></div>    </div>    <div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>executeSql("  SELECT name, nameEng, addrCity, birthday   FROM contact   WHERE nameEng = ? And addrCity = '台北市'  ";char(9) ; "" ; "Milo" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>陳牧足	Milo	台北市	1987-04-22</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*   contact::age 是一個 unstored calculated field*/executeSql ( "  Select name, nameEng, addrCity, birthday   From contact   Where addrCity = ? And age = ?  Offset 50 Rows   Fetch First 10 Rows Only  "; ""; ""; "新北市"; 37 )/*使用 With Tiies: 在找到的資料 row 數大於指定列數時, 把超過的部分也顯示出來executeSql ( "  Select name, nameEng, addrCity, birthday   From contact   Where addrCity = ? And age = ?  Offset 50 Rows   Fetch First 10 Rows With Ties  "; ""; ""; "新北市"; 37 )*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>錢愚難,Kelly,新北市,1985-08-14賴聖充,Gwendolyn,新北市,1985-11-13謝月父,Bevis,新北市,1985-11-24鍾盈,Reginald,新北市,1985-07-26薛雞耽,Hilda,新北市,1985-10-20顏庭譏,Wanda,新北市,1985-09-21藍府納,Caroline,新北市,1985-11-16</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/* 查詢住址在基隆市且nameEng 欄位沒有輸入資料的 contact*/ExecuteSQL("SELECT name,nameEng,addrCity FROM contact WHERE addrCity =? And nameEng is Null "; "" ; "" ; "基隆市" )/* 試試看, 以下計算式可不可以取得資料ExecuteSQL("SELECT name,nameEng,addrCity FROM contact WHERE addrCity =? And nameEng = ? "; "" ; "" ; "基隆市" ; "")*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>洪寐斬,,基隆市方舍殷,,基隆市</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*取得 custId 不是空字串的資料如果把 custId &gt; ? 改成 custId &lt;&gt; ?則會取不到資料資料*/executeSql ( "Select * From Sell Where custId &gt; ?" ; "" ; "" ; "" )/* 相當於executeSql ( "Select * From Sell Where custId  Is Not Null" ; "" ; "" ; "" )*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>001F6742-DC92-4156-870D-DC33B7B31CE5,2022-05-23 08:32:37,jsl,2022-05-28 13:19:00,jsl,,1,2022-02-04,AE3FCB2C-4D0A-4B5B-B353-55D9E589EB09,1065,D26238A6-FF34-4E11-B40B-C3FCA425AF8D0086FB00-1928-43EB-B36C-82235452D169,2022-05-23 08:32:37,jsl,2022-05-28 13:19:45,jsl,,2,2022-01-26,D7D86599-873D-4964-B258-7151AAF2DEF7,585,582081D5-6828-4358-8AEA-A94DB95C25EA</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*也可以利用 Let 函數把敘述的內容分解, 再加以組合完整的敘述這是為了模組化, 或者是要寫成 cf 常用的手法通常會敘述的固定字串前後都加上空格做為分隔符號, 這是為了避免不當的文字連接在一起*/let (  [    ~fName = "name" ;    ~tName = "company" ;    ~likeString = " Like '%科技股份%三廠'"  ];  executeSql("    Select " & ~fName &     " From " & ~tName &     " Where " & ~fName & ~likeString     ; "" ; "") )
/*
sample 2 找出名字長度為 4 
let (
  [
    ~fName = "name" ;
    ~tName = "company" ;
    ~likeString = " Like '____'"
  ];
   executeSql ( "Select " & ~fName & " From " & ~tName & " Where " & ~fName & ~likeString ; "" ; "") 
)
*/
/*
sample 3
let (
  [
    ~fName = "name" ;
    ~tName = "company" ;
    ~likeString = " Like '%t__'"
  ];
   executeSql ( "Select " & ~fName & " From " & ~tName & " Where " & ~fName & ~likeString ; "" ; "") 
)
*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>弟陪科技股份有限公司三廠夕盡科技股份有限公司三廠慕塞空科技股份有限公司三廠岩藏甘月科技股份有限公司三廠夙圓孟科技股份有限公司三廠策五沛科技股份有限公司三廠染吹科技股份有限公司三廠想切惡科技股份有限公司三廠辱甚輦科技股份有限公司三廠定鞠歷往科技股份有限公司三廠讀皆藏甘科技股份有限公司三廠鼓廊夏科技股份有限公司三廠學孔科技股份有限公司三廠解箋利飽科技股份有限公司三廠白巧科技股份有限公司三廠斬初語科技股份有限公司三廠說捕科技股份有限公司三廠老去踐科技股份有限公司三廠垣陰初運科技股份有限公司三廠想戚黜畏科技股份有限公司三廠顛得科技股份有限公司三廠簡中科技股份有限公司三廠步骸溪故科技股份有限公司三廠天慮拜科技股份有限公司三廠晝殿約科技股份有限公司三廠是庶科技股份有限公司三廠魄宇科技股份有限公司三廠浮雁科技股份有限公司三廠雨機科技股份有限公司三廠薄殆亦席科技股份有限公司三廠途斡科技股份有限公司三廠辰堅科技股份有限公司三廠暉甘寒禮科技股份有限公司三廠壁眠親科技股份有限公司三廠目盟科技股份有限公司三廠最勒科技股份有限公司三廠壹龍林科技股份有限公司三廠察膳任淑科技股份有限公司三廠緣抗科技股份有限公司三廠劍散命科技股份有限公司三廠翔讀祀科技股份有限公司三廠杯短驚寵科技股份有限公司三廠國谷科技股份有限公司三廠勞對會科技股份有限公司三廠首奄科技股份有限公司三廠求詠弦科技股份有限公司三廠犢映露科技股份有限公司三廠徘下科技股份有限公司三廠起營敦科技股份有限公司三廠文益科技股份有限公司三廠黎恐女科技股份有限公司三廠羔特精科技股份有限公司三廠覆困科技股份有限公司三廠用幾立科技股份有限公司三廠頓勉黃穡科技股份有限公司三廠安棠要科技股份有限公司三廠淑字恐環科技股份有限公司三廠異泰科技股份有限公司三廠寥五妍工科技股份有限公司三廠省隨深科技股份有限公司三廠煌滿雲科技股份有限公司三廠巧洪焉科技股份有限公司三廠</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*使用 Andcontact 住址在新北市, 台北市, 名字不是三個字, 名字的第一個字筆畫數大於 20 劃*/
executeSql("Select addrCity, name From contact Where stroke &gt;= 20 And addrCity Like '_北市' And name not Like '___'"; "" ; "")
/*
你可以試著用函數變數修改上面的計算式內容
*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>台北市,嚴自新北市,蘇鈞台北市,嚴清新北市,蘇裳新北市,鐘象新北市,鐘朗新北市,嚴淑台北市,鐘草新北市,嚴籍台北市,蘇攸新北市,蘇搖新北市,蘇可台北市,鐘顰新北市,蘇月新北市,蘇逼台北市,嚴最台北市,嚴仰新北市,鐘盤台北市,蘇藍新北市,蘇贊新北市,嚴遙新北市,嚴儀台北市,嚴組台北市,蘇嵇新北市,嚴搖新北市,鐘驅台北市,蘇起台北市,鐘貢台北市,鐘宮台北市,蘇欣新北市,嚴短新北市,嚴安新北市,蘇湯台北市,龔殊台北市,龔房台北市,龔抽台北市,龔吊台北市,龔命新北市,龔帝</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*
contact 住址在新北市, 年齡在 36 ~ 37 之間
三種寫法都可獲得正確的結果
age 是 unstored calculated field, 如資料很大, 盡量避免去查詢 unstored calculated field
executeSql ( "Select addrCity, name, age From contact Where addrCity = '新北市' And age between 36 And 37"; "" ; "" )
executeSql ( "Select addrCity, name, age From contact Where addrCity = ? And age between ? And ?"; "" ; "" ;"新北市" ; 36 ; 37)
executeSql ( "Select addrCity, name, age From contact Where age between ? And ? And addrCity = ?"; "" ; "" ; 36 ; 37;"新北市")
*/
/*
使用 argument 的好處: FileMaker 會做資料類型的轉換
這樣寫也可以獲得正確的結果
*/
executeSql ( "Select addrCity, name, age From contact Where addrCity = ? And age between ? And ?"; "" ; "" ;"新北市" ; "36" ; "37")
/*
age type 是數字, 以文字直接寫在 sqlQuery 的敘述內, 不會被做資料類型的轉換, 這種寫法會發生錯誤
executeSql ( "Select addrCity, name, age From contact Where addrCity = '新北市' And age between '36' And '37'"; "" ; "" )
*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>新北市,羅馨深,36新北市,曹惶,36新北市,丁規飛,36新北市,方刻瑟,37新北市,王深轉,37新北市,方心分,36新北市,田飫陛,36新北市,田體能,36新北市,白都招,36新北市,江背鶤,37新北市,江李盜,36新北市,巫射玩,36新北市,呂飄運,36新北市,汪祜連,36新北市,何拱疑,36新北市,李縣,36新北市,沈目牒,36新北市,李盡,37新北市,汪彩基,36新北市,余夙魏,37新北市,吳增孤,36新北市,李邑詠,37新北市,呂璧,37新北市,杜晉戚,36新北市,余戎祭,36新北市,呂邇,37新北市,杜交箋,36新北市,李孟躬,36新北市,巫效羽,36新北市,吳陰,36新北市,吳園願,37新北市,邵侍塞,36新北市,周有,36新北市,周誠,36新北市,周孤,36新北市,林羔烹,37新北市,邱矯親,37新北市,周昆性,36新北市,胡雞冥,37新北市,胡夏黎,37新北市,姜滅洪,36新北市,柯鶤慈,36新北市,胡躍星,36新北市,洪抽坐,37新北市,范象御,36新北市,侯適宙,37新北市,胡達比,37新北市,姚虢晉,36新北市,姜善公,37新北市,紀彩資,36新北市,紀難,37新北市,施霜獸,36新北市,柯楹丁,36新北市,侯即,36新北市,胡陛受,36新北市,施惠,36新北市,施毛鈞,36新北市,范庭農,36新北市,姜慶腸,37新北市,侯是,37新北市,翁爵相,36新北市,徐調,36新北市,馬琴吹,36新北市,袁兒,37新北市,涂製書,36新北市,徐煌詳,37新北市,翁難及,36新北市,唐國爵,36新北市,高軍方,36新北市,馬樂,36新北市,馬競階,37新北市,張素流,37新北市,連火楚,37新北市,張簡遣聞,37新北市,莊羌磻,36新北市,曹答鳴,36新北市,梁書孟,36新北市,康友弊,37新北市,梁寔軍,36新北市,許翠,37新北市,張涼氣,36新北市,莊嘉寶,36新北市,連膳宙,36新北市,康驚煌,37新北市,馮言,36新北市,曾犢,37新北市,黃命衣,36新北市,童盟,36新北市,彭歷鳴,36新北市,傅談感,36新北市,馮正,36新北市,傅口息,37新北市,傅凌,37新北市,湯席翦,36新北市,黃映,36新北市,彭上華,36新北市,黃切立,37新北市,程堂阿,36新北市,游納俊,36新北市,傅職淵,37新北市,傅漠,36新北市,湯鳥,36新北市,曾條,37新北市,溫必浴,37新北市,董陶,37新北市,楊遙,37新北市,鄒吹笙,37新北市,葉途故,37新北市,董驚誅,36新北市,董恬,36新北市,溫近王,37新北市,溫廣會,37新北市,詹率,36新北市,鄒釋,36新北市,鄒牆遠,36新北市,楊伏業,37新北市,楊假獸,36新北市,溫阿,36新北市,董土冥,36新北市,鄒金阿,37新北市,葉音明,37新北市,董情池,37新北市,鄒晦亭,36新北市,趙己亭,36新北市,趙方詠,36新北市,潘秉摩,36新北市,黎音游,36新北市,鄧條布,36新北市,潘願杷,37新北市,潘裳煒,37新北市,歐移將,36新北市,蔣真堅,37新北市,黎逍,36新北市,劉絳故,36新北市,歐吹遠,36新北市,潘說,37新北市,蔣岫夏,37新北市,黎沛垂,36新北市,賴乂矢,36新北市,賴門嵇,36新北市,蕭不,37新北市,錢愚難,37新北市,盧索即,36新北市,賴聖充,37新北市,謝月父,37新北市,鍾宜鞠,36新北市,韓寵平,36新北市,鍾盈,37新北市,薛雞耽,37新北市,藍垢,36新北市,顏龍誠,36新北市,藍陶章,36新北市,顏庭譏,37新北市,藍府納,37新北市,羅懸對,36新北市,羅霄,36新北市,鐘書口,36新北市,蘇寧承,36新北市,蘇好箋,36新北市,鐘杷競,36新北市,嚴稷處,36新北市,蘇贊,36新北市,龔囊戚,36新北市,龔經易,36</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*
花蓮縣 23 和 27 歲的 女性
*/
executeSql ("Select name, age, gender from contact Where addrCity = '花蓮縣' And gender = '女' And age in (23,27) Order By age" ; "" ; "" )
/* 
把 in clause 用 aguments 的寫法; 
對於大的比較列表寫成 arguments 不是很方便
executeSql ("Select name, age, gender from contact Where addrCity = '花蓮縣' And gender = ? And age in (?,?) Order By age" ; "" ; ""; "女" ;23 ; 27 )
*//* 如果可以直些寫成 where 的條件, 則為第一優先如果不行, 還可以利用 join, 子查詢 或者用 Let 函數寫成數個計算段落*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>張廣纓,23,女古渭房,23,女石白競,23,女田處滿,23,女古勉鶤,23,女白策田,23,女阮鬱,23,女何外搖,23,女沈衡語,23,女李效登,23,女余業斯,23,女阮背靈,23,女宋入鱗,23,女林困比,23,女卓斯,23,女周尺,23,女姜贊,23,女姜孔,23,女姜寫及,23,女涂裳弗,23,女馬辰愛,23,女唐射緣,23,女袁廊殷,23,女高啟,23,女陸首桓,23,女連驤儀,23,女康之,23,女張政糟,23,女陸方服,23,女湯色懼,23,女趙枇植,23,女趙重衣,23,女蔡白妙,23,女鄭川短,23,女蔡霸涼,23,女錢斬辭,23,女錢終榮,23,女謝農居,23,女戴惠,23,女謝達蚤,23,女藍爵渠,23,女蘇雲顙,23,女丁少頓,27,女尤等雅,27,女古少傾,27,女田仕,27,女李知,27,女巫深箋,27,女林璣金,27,女邵園祗,27,女周知渭,27,女金靈收,27,女施次體,27,女施唱語,27,女侯談,27,女姜陋有,27,女柯知實,27,女涂羔觀,27,女孫煩知,27,女孫傍溫,27,女徐去,27,女高闕稅,27,女徐紛敦,27,女張肥嵇,27,女康筍漢,27,女許攝,27,女張簡秋,27,女湯切官,27,女黃晚恥,27,女程增,27,女游業正,27,女程如具,27,女傅毛安,27,女溫身想,27,女鄧邙,27,女歐陽此長,27,女潘譽涼,27,女歐陽曲羔,27,女盧助霄,27,女賴弁皇,27,女盧存歸,27,女韓冠,27,女韓造頗,27,女韓疑,27,女藍驤,27,女顏肆,27,女藍直黃,27,女藍其,27,女</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*
如果 in 所需要的 List 可以從 FileMaker 快速的獲得直接把 list 置入, 通常比做子查詢快這是同一家公司的員工姓名
idf 都相同
*/
let (
  [
    ~idList = list (
      "6B7C4063-8FDB-43AB-B382-198B187FA669";
      "7CC7BA2C-D6CC-47C2-9EBA-4CAA3D81129C";
      "6307F6C6-2DB4-4EE8-B583-A6CF518F4996";
      "99F4EFBE-4A61-4F7E-9FF9-30206E19048D";
      "5BC77F51-A5CE-4F41-9038-D7472AE75A5A";
      "92A5CB8A-42AA-4D41-A799-B618F04F1C62";
      "129D512B-1E60-4D3E-9D82-379C9C23BF5E";
      "4C3E9BF9-4655-4F6D-84BC-1DFD2CB0EB72";
      "46E84684-9C2F-4E8C-9C1D-EECFD733ED48";
      "5825A4BB-9293-4D20-877A-6E41232D2B09";
      "B2293E43-6E51-4E2C-AC97-3DCF0C74027E");
    /*轉換成 executeSql in clause 的格式*/
    ~idList = "('" & substitute ( ~idList ; ¶ ; "','") & "')"
  ];
  executeSql ("Select name,idf from contact Where id in " & ~idList ; "" ; "")
)</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>古譏,397A8374-EBEE-4FC6-92E7-38A54FC59B83古鳥,397A8374-EBEE-4FC6-92E7-38A54FC59B83袁鱗,397A8374-EBEE-4FC6-92E7-38A54FC59B83張盜殆,397A8374-EBEE-4FC6-92E7-38A54FC59B83許景,397A8374-EBEE-4FC6-92E7-38A54FC59B83連夏樓,397A8374-EBEE-4FC6-92E7-38A54FC59B83葉夕鶤,397A8374-EBEE-4FC6-92E7-38A54FC59B83鍾圖歷,397A8374-EBEE-4FC6-92E7-38A54FC59B83鍾端菜,397A8374-EBEE-4FC6-92E7-38A54FC59B83藍府納,397A8374-EBEE-4FC6-92E7-38A54FC59B83龔故悲,397A8374-EBEE-4FC6-92E7-38A54FC59B83</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*列出今天的壽星*//* 以 sql 函數寫出 */executeSql ( "Select name, birthday From Contact Where Month(birthday) = Month(curDate) And Day(birthday) = Day(curDate)"; "" ; "" )/* 以下的計算式取得相同的結果let (  [    ~today = get(currentDate);    ~month = month ( ~today);    ~day = day ( ~today)  ];  executeSql ( "Select name, birthday From Contact Where Month(birthday) = ? And Day(birthday) = ?"; "" ; "" ; ~month ; ~day ))*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>潘存房,1994-05-31方刻瑟,1985-05-31尤讀驤,1988-05-31江敕旦,1999-05-31江兄,1992-05-31吳南,1991-05-31何貴輦,1986-05-31沈緣月,1986-05-31阮嗣骸,1993-05-31何殊,1986-05-31吳拜,1992-05-31宋能綿,1989-05-31宋史,1987-05-31沈等紫,1988-05-31李倫射,1999-05-31金象陋,1992-05-31林物,1986-05-31邱莊矩,1990-05-31林束傷,1986-05-31紀溪闕,1991-05-31柯見畏,1987-05-31紀亭霄,1989-05-31姜吊隸,1992-05-31侯竭,1994-05-31胡茂始,1994-05-31涂克,1998-05-31徐黃律,1989-05-31孫裳效,1993-05-31梁謹治,1999-05-31莊實馳,1994-05-31康陪飽,1994-05-31陸棠,1985-05-31陸時,1987-05-31連景隱,1991-05-31馮黜谷,1988-05-31曾轉冬,1994-05-31馮席守,1996-05-31童顛,1986-05-31馮芥羊,1992-05-31程宣,1989-05-31游年奄,1987-05-31黃宿嵇,1999-05-31程優詳,1991-05-31楊九明,1992-05-31溫廣會,1985-05-31楊省求,1991-05-31葉渠昆,1999-05-31楊習,1999-05-31趙約改,1988-05-31鄧知圖,1987-05-31歐陽帷姜,1996-05-31鄭明,1993-05-31盧常動,1994-05-31蕭實後,1994-05-31錢歲青,1993-05-31賴涼,1997-05-31鍾佐命,1990-05-31鍾靜孤,1992-05-31薛富,1992-05-31韓敦貽,1990-05-31藍才棠,1989-05-31藍并東,1986-05-31魏字,1999-05-31羅鳳上,1991-05-31龔地水,1990-05-31</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>executeSql("  SELECT name   FROM contact   WHERE stroke &gt;= ALL(SELECT stroke FROM contact WHERE stroke = 18 )  Fetch First 10 Rows Only  "; "" ;"" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>龔殊嚴自藍玄基嚴公紡魏曦墳嚴勞觴羅馨深藍存鐘傳寥龔過</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*使用 Any operator*/executeSql("  Select name, stroke   From contact  Where stroke = Any(Select stroke From contact Where stroke = 18 )  Fetch First 10 Row Only  "; "" ;"" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>藍玄基,18魏曦墳,18藍存,18魏勉,18魏事自,18魏極逼,18藍高想,18魏者聲,18魏永邇,18顏給佐,18</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*In 的使用*/executeSql("  Select company.name, contact.name   From contact, company  Where contact.idf = company.id And contact.idf In ( Select id From company Where stroke = 3 )  Fetch First 10 Rows Only  "; ""; "" )/*比較上面的計算式沒有在 Where 子句寫 self join 的敘述會得到不同的結果executeSql("  Select company.name, contact.name   From contact, company  Where contact.idf In ( Select id From company Where stroke = 3 )  Fetch First 10 Rows Only  "; ""; "" )*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>夕盡科技股份有限公司三廠,阮英夕盡科技股份有限公司三廠,袁永殷夕盡科技股份有限公司三廠,鄧驤夕盡科技股份有限公司三廠,白疑煒夕盡科技股份有限公司三廠,巫辭夕盡科技股份有限公司三廠,董移生口丸白材料科技有限公司,丁漢結工陪遐莽生物科技股份有限公司,丁沉法土顛國際股份有限公司,丁遵恐才膳下貿易股份有限公司,丁異槐</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*同時符合筆畫數大於或等於10 , 地址是在忠孝東路耗時: 3.676 秒*/executeSql("  Select name, stroke, addrStr  From contact  Where addrStr = Any(Select addrStr From contact Where stroke &gt;= 10 And addrStr Like '%忠孝東路%' )  Fetch First 10 Row Only  "; "" ;"" )/*獲得相同的結果耗時: 4.493 秒executeSql("  Select name, stroke, addrStr  From contact  Where addrStr In (Select addrStr From contact Where addrStr Like '%忠孝東路%' ) And    stroke In (Select stroke From contact Where stroke &gt;= 10 )  Fetch First 10 Row Only  "; "" ;"" )*//*獲得相同的結果耗時: 0.255 秒executeSql("  Select name, stroke, addrStr  From contact  Where addrStr Like '%忠孝東路%' And stroke &gt;= 10  Fetch First 10 Row Only  "; "" ;"" )*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>涂紡,10,南港區忠孝東路５段212號3樓徐步蚤,10,大安區忠孝東路３段114號6樓徐閏讓,10,中正區忠孝東路２段147號3樓袁曰,10,南港區忠孝東路７段89號3樓曹薄惟,11,大安區忠孝東路３段166號7樓陸絜秉,11,南港區忠孝東路６段60號7樓陸親始,11,大安區忠孝東路４段47號5樓鄭乎才,15,大安區忠孝東路４段37號4樓賴琴被,16,信義區忠孝東路５段247號5樓薛經,17,信義區忠孝東路４段64號2樓</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*列出所有業務的業績*/executeSql ( "Select sell.salesRep,sum(sellItem.item_qty * sellItem.item_unitPrice ) from sellItem  Join sell on sell.id = sellItem.idf  group by sell.salesRep"; "" ; "" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>18107B18-8F12-42A2-8B82-7F8AFAA3C3FD,50745203E130F-92BF-4F47-A9D0-7596F8DE4F35,22395225BB47E-D026-4EC3-89F5-B6DFA10805F1,49815AE3FCB2C-4D0A-4B5B-B353-55D9E589EB09,23145B7CBA72D-208A-4CA3-9AD5-D780A63DF590,62160D7D86599-873D-4964-B258-7151AAF2DEF7,64275DC22E31A-31D9-48EF-90B2-613C93D4C98F,54600F1D30DC9-FF1E-4759-A3C8-919557AE3603,62040F41156A0-5703-4801-B837-89149389BD1E,52800</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*這也是 inner Joininner join 的動作發生在 Where clause因為不是用 Join 語句, 在子查詢的 employee.id = sell.salesRep必須在主敘述的 Where clause 在寫一次, 如果未寫, 會發生邏輯性錯誤*/executeSql ( "  Select     (Select employee.name from employee where employee.id = sell.salesRep),    sell.salesRep,    sum(sellItem.item_qty * sellItem.item_unitPrice )  From sellItem, sell, employee  Where sell.id = sellItem.idf and employee.id = sell.salesRep  Group by sell.salesRep  "; "" ; "" )</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>陸非建,18107B18-8F12-42A2-8B82-7F8AFAA3C3FD,50745馬照貽,203E130F-92BF-4F47-A9D0-7596F8DE4F35,22395蕭軻車,225BB47E-D026-4EC3-89F5-B6DFA10805F1,49815施既,AE3FCB2C-4D0A-4B5B-B353-55D9E589EB09,23145阮禍,B7CBA72D-208A-4CA3-9AD5-D780A63DF590,62160曹玄比,D7D86599-873D-4964-B258-7151AAF2DEF7,64275陳力增,DC22E31A-31D9-48EF-90B2-613C93D4C98F,54600袁嘯,F1D30DC9-FF1E-4759-A3C8-919557AE3603,62040董素感,F41156A0-5703-4801-B837-89149389BD1E,52800</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*列出所有業務的業績利用子查詢 列出業務員姓名*/executeSql ( "  Select    (Select employee.name from employee where employee.id = sell.salesRep),   sell.salesRep,   sum(sellItem.item_qty * sellItem.item_unitPrice )   from sellItem  Join sell on sell.id = sellItem.idf  group by sell.salesRep  "; "" ; "" )/*不顯示業務編號executeSql ( "Select   (Select employee.name from employee where employee.id = sell.salesRep),  sum(sellItem.item_qty * sellItem.item_unitPrice ) from sellItem  Join sell on sell.id = sellItem.idf  group by sell.salesRep"; "" ; "" )*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>陸非建,18107B18-8F12-42A2-8B82-7F8AFAA3C3FD,50745馬照貽,203E130F-92BF-4F47-A9D0-7596F8DE4F35,22395蕭軻車,225BB47E-D026-4EC3-89F5-B6DFA10805F1,49815施既,AE3FCB2C-4D0A-4B5B-B353-55D9E589EB09,23145阮禍,B7CBA72D-208A-4CA3-9AD5-D780A63DF590,62160曹玄比,D7D86599-873D-4964-B258-7151AAF2DEF7,64275陳力增,DC22E31A-31D9-48EF-90B2-613C93D4C98F,54600袁嘯,F1D30DC9-FF1E-4759-A3C8-919557AE3603,62040董素感,F41156A0-5703-4801-B837-89149389BD1E,52800</pre></div>    <footer><p>update: 2022/06/05 03:55:46 by: Jeff</p><a class='repo' href='https://github.com/JSLiao/FileMaker-executeSql' target='_blank'>repository</a></footer>    <script></script>  </body></html>