<!DOCTYPE html><html lang='en'>  <head>    <meta charset='UTF-8' />    <meta aceVersion='v1.4.14' frameVersion='v1' />    <meta http-equiv='X-UA-Compatible' content='IE=edge' />    <meta name='viewport' content='width=device-width, initial-scale=1.0' />    <title>Join clause</title>    <style>:root {  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  font-size: 16px;  background-color: #111;  margin: 0;  padding: 0;  color: #eee;  hyphens: auto;--background_th: #333;}#main-subject {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  /* display:inline-block; */  position: fixed;  left: 6px;  top: 6px;  padding: 6px 3px;  align-content: flex-start;  text-decoration: none;  width: 97%;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 3px;}/* btn toEdit, tsToTc */#btn-toEdit, #btn-tsToTc {  font-size: 1.2rem;  background-color: rgba(45, 45, 45, 0.6);  color: white;  margin: 0;  box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.7);  box-sizing: border-box;  border-radius: 16px;  cursor:pointer;  align-content: flex-start;}/* btn toEdit */#btn-toEdit {  right: 6px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 32px;  position: fixed;}/* btn tsToTc */#btn-tsToTc {  right: 44px;  top: 6px;  padding: 6px 3px;  text-align: center; /* 文字居中 */  width: 64px;  position: fixed;}#main-subject:hover,#btn-toEdit:hover,#btn-tsToTc:hover {  background-color: rgba(45, 45, 45, 0.9);  color: #c0edfe;}#main-subject:active,#btn-toEdit:active,#btn-tsToTc:active {  background-color: rgb(255, 145, 45);  color: #c0edfe;}.subNote {  right:20px;  text-align: right;  font-size: 0.9rem;  color: lightGray;}content {  color: lightgray;}p {  color: #ddd;  font-size: 1rem;  height: auto;  padding: 0rem;  margin-block-start: 0.5rem;  margin-block-end: 0.5rem;}hr {  color: #666;  height: 0.5px;}a {  border: none;  color: #ff5;  height: 100%;  text-decoration: none;}a:hover {  color: #fa3;}a:hover:after {  left: auto;  right: 0;  width: 100%;}a:active {  top: 2px;}/* table 样式 */table {  border-top: 1px solid #ccc;  border-left: 1px solid #ccc;}table td,table th {  border-bottom: 1px solid #ccc;  border-right: 1px solid #ccc;  padding: 3px 5px;}table th { background-color: var(--background_th) !important;  border-bottom: 2px solid #ccc;  text-align: center;}/* blockquote 样式 */blockquote {  display: block;  border-left: 5px solid #d0e5f2;  padding: 3px 5px;  margin: 6px 0;  line-height: 1.4;  font-size: 100%;  background-color: #f1f1f1;}/* code 样式 */code {  display: inline-block;  *display: inline;  *zoom: 1;  color: lightgray;  background-color: #fff3;  border-radius: 1px;  padding: 1px 3px;  margin: 0 1px;  font-size: 0.9rem;  font-family: monaco 'robot mono' mono !important;}pre code {  display: block;}/* ul ol 样式 */ul,ol {  margin-left: 8px;  padding-left:4px;  padding-right: 0;}li{  margin-left:0;  padding-left:0px;}ul li{  list-style-type: disc;}ol lit{  list-style-type: decimal;}.sectionTitle {  font-size: 1.2rem;}.preCodecontianer {  background-color: #fff1;}.cssDefault {  font-size: 0.9rem;  color: gray;  margin-left: 1rem;}footer {  text-align: right;  padding: 1px 12px;  margin:1px;  background-color: #8882;  color: lightgray;  bottom:8px;  right:24px;  position:fixed;  z-index: 1;}h1{  font-size:24px;}h2{  font-size:22px;}h3{  font-size:20px;}h4{  font-size:18px;}h5{  font-size:16px;}font[size='1']{  font-size:12px;  padding: 0.1em;  margin: 0.1em;}font[size='2']{  font-size:14px;  padding: 0.1em;  margin: 0.1em;}font[size='3']{  font-size:16px;  padding: 0.1em;  margin: 0.1em;}font[size='4']{  font-size:18px;  padding: 0.1em;  margin: 0.1em;}font[size='5']{  font-size:20px;  padding: 0.1em;  margin: 0.1em;}font[size='6']{  font-size:22px;  padding: 0.1em;  margin: 0.1em;}font[size='7']{  font-size:24px;  padding: 0.2em;}blockquote, blockquote p{  background:#0003 !important;}blockquote, blockquote p{  background:transparent !important;}/* width */::-webkit-scrollbar {width: 12px;}/* Track */::-webkit-scrollbar-track {background: #333;}/* Handle */::-webkit-scrollbar-thumb {background: #345;}/* Handle on hover */::-webkit-scrollbar-thumb:hover {background: #357;}</style>    <style>:root {  margin: 0;  padding: 0;  font-family: 'times new roman', helvetica, 'songti TC', monaco, 'SF Pro';  --background: #111;  --color: #ddd;  --font-size: 16px;  --background_th: #555;  --color-a: #ff5;  --color-a-hover: #fa3;  --background-blockquote: #00e9;  --font-size-code: 14px;  --background-code: #fff3;  background-color: var(--background);  color: var(--color);  font-size: var(--font-size);}.notesView{  background-color: #0308;  margin:0;  padding:8px 2px 8px 16px;}.codeView{  background-color: #0038;  margin:0;  padding:8px 2px 8px 16px;}.resultView{  background-color: #3008;  margin:0;  padding:8px 2px 8px 16px;}.code, .result{  font-family: monaco, monospace;  font-size:13px;  color:var(--color);}</style>  </head>  <body>    <!--完整檢視才顯示, begin-->    <div class='notesView'>      <p id='main-subject'>Join clause</p>      <br><br><div class='content'><h4 id="ltdga"><span style="color: var(--color); background-color: var(--background);">executeSql 只支援 inner join 和 left join</span><br/></h4><div><p><font color="#8baa4a" face="Monaco" size="2">Select searchFields( anyfields on talbleLeft or talbeRight )&nbsp;</font></p><p><font color="#8baa4a" face="Monaco" size="2">From tableLeft</font></p><p><font color="#8baa4a" face="Monaco" size="2">[ Inner | Left ] Join tableRight&nbsp;</font></p><p><span style="font-size: 14px; color: rgb(139, 170, 74); font-family: Monaco; background-color: var(--background);">On tableLeft.keyField =&nbsp;tableRight.keyField</span></p></div><h3 id="yf6ws">Inner Join:</h3><p>Inner join &nbsp;(內部連接) 為內部合併查詢指令，可以取回2個資料表都共同存在合併欄位的記錄資料。也就是在「兩個資料表都有在 on 關鍵字所指定的欄位的值」這個條件下才取出想取的欄位。<br/></p><p>Inner join 也可以只寫 join</p><h3>Left Join:</h3><p>left Join (左外部合併查訊)是在合併兩個資料表中，取回左邊資料表的所有紀錄，就算在右邊資料表沒有存在合併欄位的值，顯示結果會以左邊資料表為主。</p><p><br/></p><hr/><p>參考資料</p><p><a target="_blank" href="https://ithelp.ithome.com.tw/articles/10215741">[iT鐵人賽Day16] SQL語法-表與表之間的關係</a></p><p><br/></p></div>    </div>    <div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*從 contact TABLE 列出公司在新北市的人名, 英文名, 地址及公司名稱公司名稱由 INNER JOIN 取得依據 company::name 排序*/ExecuteSql ( "  Select company.name, company.addrCity || company.addrStr, contact.name, contact.nameEng, contact.addrCity || contact.addrStr   FROM contact   Join company On company.id = contact.idf  WHERE contact.addrCity = ?   Order By company.name   Fetch First 10 Rows Only  "  ; ",  " ; "" ; "新北市")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>上盤默床貿易股份有限公司,  南投縣信義鄉中央金礦179號1樓,  姚騰,  Dana,  新北市三重區集美街207號2樓不虢木業有限公司,  南投縣名間鄉田寮巷57號1樓,  李右鱗,  Steven,  新北市三芝區迎旭街170號2樓不虢木業有限公司,  南投縣名間鄉田寮巷57號1樓,  張甲,  Ada,  新北市萬里區石角28號3樓且聚奏本企業社,  新竹市北區新港北路42號9樓,  丁絳無,  May,  新北市三重區仁忠街194號5樓且聚奏本企業社,  新竹市北區新港北路42號9樓,  許阜古,  Marshall,  新北市蘆洲區中央路30號8樓且聚奏本企業社,  新竹市北區新港北路42號9樓,  鄧如昆,  Jared,  新北市萬里區成功新屯54號4樓且貢商業有限公司,  新竹市東區太原路240號4樓,  姜木恬,  Solomon,  新北市三峽區紫新路91號12樓且貢商業有限公司,  新竹市東區太原路240號4樓,  蔣真堅,  Mag,  新北市瑞芳區輕便路238號1樓丙惟沛實業有限公司,  嘉義市西區車店街208號11樓,  黎國毛,  Theresa,  新北市萬里區忠六街152號8樓並金股份有限公司,  桃園市龍潭區齊粑崠182號11樓,  王深轉,  Dinah,  新北市林口區南勢七街185號2樓</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*從 contact TABLE 列出公司在新北市的人名, 英文名, 地址及公司名稱公司名稱由 INNER JOIN 取得依據 contact::nameEng 排序*/ExecuteSql ( "  Select company.name, company.addrCity || company.addrStr, contact.name, contact.nameEng, contact.addrCity || contact.addrStr   FROM contact   Join company On company.id = contact.idf  WHERE contact.addrCity = ?   Order By contact.nameEng   Fetch First 10 Rows Only  "; ",  " ; "" ; "新北市")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>龍染口食品工業股份有限公司一廠,  新北市金山區林口136號11樓,  歐陽容,  ,  新北市貢寮區龍門街150號10樓詳橫悅工業有限公司,  台東縣大武鄉政通三街249號3樓,  田伯骸,  Abbott,  新北市金山區跳石131號12樓曜聲國際實業股份有限公司,  基隆市安樂區武聖街219號11樓,  余摩帶,  Abbott,  新北市三芝區長安街32號6樓王右鈞辭食品廠,  連江縣南竿鄉馬祖村23號1樓,  何傳,  Abel,  新北市八里區楓林坑56號7樓誡枝勿股份有限公司,  苗栗縣造橋鄉陽明街116號1樓,  張賴,  Abel,  新北市淡水區淡金路192號9樓景溫任科技股份有限公司,  南投縣名間鄉水尾巷35號4樓,  藍蘭,  Abel,  新北市萬里區忠六街248號12樓官靈麗宅生技科技有限公司,  台東縣長濱鄉樟原26號2樓,  錢紈法,  Abner,  新北市深坑區深南路52號7樓不虢木業有限公司,  南投縣名間鄉田寮巷57號1樓,  張甲,  Ada,  新北市萬里區石角28號3樓榮老首食品股份有限公司,  花蓮縣光復鄉自強路93號11樓,  彭翳荒,  Ada,  新北市石碇區碇南路２段鹿窟巷194號8樓馳白牧科技股份有限公司二廠,  台東縣太麻里鄉麻利霧190號3樓,  杜妙寂,  Adair,  新北市土城區民族街225號11樓</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*只取前 10 筆*/ExecuteSql ( "  Select company.name, company.addrCity || company.addrStr, contact.name, contact.nameEng, contact.addrCity || contact.addrStr   FROM contact   Join company On company.id = contact.idf  WHERE contact.addrCity = ?   Fetch First 10 Rows Only  "; ",  " ; "" ; "新北市")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>琴日漢物流股份有限公司,  苗栗縣三灣鄉山塘背223號10樓,  邵不,  Cornelius,  新北市坪林區楣子寮123號2樓龍染口食品工業股份有限公司一廠,  新北市金山區林口136號11樓,  歐陽容,  ,  新北市貢寮區龍門街150號10樓岳棠生物科技有限公司,  高雄市茄萣區順漁路93號8樓,  許孟林,  Julia,  新北市中和區台新街231號9樓薪床永商業股份有限公司,  台中市梧棲區自立一街36號6樓,  曾驤,  Marina,  新北市泰山區應化街登山道76號8樓羅箱極貿易股份有限公司,  彰化縣大村鄉聖瑤西路１段77號6樓,  羅馨深,  Elvis,  新北市新店區花園六路68號9樓良退食品股份有限公司,  台北市大安區基隆路２段121號1樓,  許陳機,  Odelia,  新北市石門區草埔尾224號4樓琴日漢物流股份有限公司,  苗栗縣三灣鄉山塘背223號10樓,  曹惶,  Arno,  新北市八里區龍形三街225號6樓結竹封食品有限公司,  新竹市香山區五福路２段79號7樓,  董羽曰,  Prima,  新北市淡水區番子田71號1樓夕盡科技股份有限公司三廠,  新竹縣芎林鄉王爺坑136號4樓,  巫辭,  Andy,  新北市新莊區復興路２段89號10樓守池事業有限公司,  台東縣成功鎮長沙街46號5樓,  陸曰益,  Fay,  新北市板橋區僑中二街255號7樓</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*join 之後, 欄位可以應用到 where clause*/ExecuteSql (   "  Select company.name, company.addrCity || company.addrStr, contact.name, contact.nameEng, contact.addrCity || contact.addrStr FROM contact   Join company On company.id = contact.idf  WHERE contact.nameEng Like 'Zi%' Fetch First 10 Rows Only  "  ; ",  " ; "" ; "新北市")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>舊秦之工業股份有限公司一廠,  連江縣南竿鄉福沃村208號6樓,  金信聖,  Ziv,  新竹縣峨眉鄉大同街14號8樓羅箱極貿易股份有限公司,  彰化縣大村鄉聖瑤西路１段77號6樓,  錢惻秋,  Ziv,  雲林縣四湖鄉成功路35號7樓交具商業有限公司,  花蓮縣富里鄉永豐村復興12號8樓,  白矢善,  Ziv,  桃園市大園區忠孝三街22號8樓虛邙與化學科技股份有限公司,  台中市沙鹿區保成五街116號8樓,  杜雁宗,  Ziv,  桃園市大溪區南興路２段2號6樓奉笙壁農產有限公司,  新北市石碇區北宜路６段塗潭巷175號4樓,  何詩馳,  Ziv,  花蓮縣卓溪鄉中正119號12樓政寒離股份有限公司,  新北市平溪區乾坑31號11樓,  林冥傾,  Ziv,  新竹市東區金山寺路6號10樓空民化學科技股份有限公司,  嘉義市東區芳安路26號11樓,  胡安,  Ziv,  桃園市中壢區興福街215號2樓運遠科技股份有限公司二廠,  金門縣烏坵鄉大坵村163號5樓,  范涇基,  Ziv,  南投縣草屯鎮成功路１段慧音巷241號7樓虧宮餘科技股份有限公司二廠,  屏東縣春日鄉玉山路124號11樓,  姚猷,  Ziv,  嘉義縣阿里山鄉來吉214號1樓政良銀工業股份有限公司一廠,  彰化縣秀水鄉正興路57號1樓,  施遙贊,  Ziv,  雲林縣元長鄉北興路213號8樓</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*列出所有業務的業績join 連結 sell 和 sellItem利用子查詢 列出業務員姓名*/executeSql ( "  Select    (Select employee.name from employee where employee.id = sell.salesRep),   sell.salesRep,   sum(sellItem.item_qty * sellItem.item_unitPrice )   from sellItem  Join sell on sell.id = sellItem.idf  group by sell.salesRep  "; "" ; "" )/*不顯示業務編號executeSql ( "Select   (Select employee.name from employee where employee.id = sell.salesRep),  sum(sellItem.item_qty * sellItem.item_unitPrice ) from sellItem  Join sell on sell.id = sellItem.idf  group by sell.salesRep"; "" ; "" )*/</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>陸非建,18107B18-8F12-42A2-8B82-7F8AFAA3C3FD,50745馬照貽,203E130F-92BF-4F47-A9D0-7596F8DE4F35,22395蕭軻車,225BB47E-D026-4EC3-89F5-B6DFA10805F1,49815施既,AE3FCB2C-4D0A-4B5B-B353-55D9E589EB09,23145阮禍,B7CBA72D-208A-4CA3-9AD5-D780A63DF590,62160曹玄比,D7D86599-873D-4964-B258-7151AAF2DEF7,64275陳力增,DC22E31A-31D9-48EF-90B2-613C93D4C98F,54600袁嘯,F1D30DC9-FF1E-4759-A3C8-919557AE3603,62040董素感,F41156A0-5703-4801-B837-89149389BD1E,52800</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*Order By clause 必須放在 Fetch First clause 的前面,正確的語句順序, 取得值*/ExecuteSQL (   "  Select company.name, company.addrCity || company.addrStr, contact.name, contact.nameEng, contact.addrCity || contact.addrStr FROM contact   Join company On company.id = contact.idf  WHERE company.addrCity = ? And contact.nameEng Like 'Ad%' Order By contact.nameEng Fetch First 10 Rows Only  "  ; ",  " ; "" ; "新北市" ; "新北市")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>轉機事材料科技有限公司,  新北市三峽區中正路１段182號9樓,  鄒隸游,  Ada,  雲林縣四湖鄉泰山街160號11樓歌再食品廠,  新北市金山區南勢56號9樓,  彭再去,  Addison,  基隆市七堵區永富路174號2樓歌再食品廠,  新北市金山區南勢56號9樓,  嚴箋途,  Addison,  台北市文山區興隆路４段109號11樓抽莊國際實業股份有限公司台灣分公司,  新北市三峽區佳福路223號10樓,  龔朗,  Adela,  連江縣南竿鄉四維村60號2樓秦俠顛物流股份有限公司,  新北市平溪區薯榔寮30號2樓,  江睦,  Adela,  花蓮縣瑞穗鄉梧繞四街196號11樓羅宗俯生技科技有限公司,  新北市永和區仁愛路38號6樓,  游刻龍,  Adela,  新竹市東區新光路248號11樓洞戚皋工業股份有限公司,  新北市蘆洲區中興街171號4樓,  古薄斡,  Adelaide,  屏東縣新園鄉中興一巷95號5樓切徘納承食品廠,  新北市坪林區灣潭241號7樓,  吳典難,  Adelaide,  新北市坪林區灣潭105號6樓幾植科技股份有限公司,  新北市石碇區湳子218號11樓,  巫昆丁,  Adelaide,  基隆市七堵區工東街27號11樓樓尺毀玩食品行,  新北市貢寮區香蘭街156號10樓,  柯將,  Adelaide,  苗栗縣頭份市南田街21號5樓</pre></div><div class='codeView'><p class='codeViewTitle'>計算式:</p><pre class='code'>/*Order By clause 必須放在 Fetch First clause 的前面,錯誤的順序不能取得值*/ExecuteSQL (   "  Select company.name, company.addrCity || company.addrStr, contact.name, contact.nameEng, contact.addrCity || contact.addrStr FROM contact   Join company On company.id = contact.idf  WHERE company.addrCity = ? And contact.nameEng Like 'Ad%' Fetch First 10 Rows Only Order By contact.nameEng  "  ; ",  " ; "" ; "新北市" ; "新北市")</pre></div><div class='resultView'><p class='resultViewTitle'>計算結果:</p><pre class='result'>?</pre></div>    <footer><p>update: 2022/06/21 22:00:38 by: Jeff</p><a class='repo' href='https://github.com/JSLiao/FileMaker-executeSql' target='_blank'>repository</a></footer>    <script></script>  </body></html>